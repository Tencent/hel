/*! For license information please see 1263.2f814f79.js.LICENSE.txt */
(globalThis.webpackChunkhel_doc=globalThis.webpackChunkhel_doc||[]).push([[1263],{1263:(e,t,r)=>{"use strict";r.d(t,{preFetchLib:()=>yr});var n=r(3127),a=r.n(n),o=r(2917);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=/\s/,u=/[a-zA-Z0-9\-]/,l="<!DOCTYPE html>",p=["meta","link"],f={meta:"</meta>",link:"</link>"},d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.input="",this.len=0,this.cur=0}var t,r,n;return t=e,r=[{key:"eof",get:function(){return this.cur>=this.len}},{key:"peek",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.input[this.cur+e]}},{key:"sub",value:function(e,t){var r=t||this.cur;return this.input.substring(r,r+e)}},{key:"moveCur",value:function(e){this.cur+=e}},{key:"consumeChar",value:function(e){var t=this.peek();if(t!==e)throw new Error("Unexpected character: '".concat(t,"' should be '").concat(e,"'"));return this.cur++,t}},{key:"consumeSpace",value:function(){this.consumeWhile(c)}},{key:"consumeWhile",value:function(e){var t=[];do{var r=this.peek();if(!e.test(r))break;t.push(r),this.cur++}while(!this.eof);return t.join("")}},{key:"noop",value:function(){}},{key:"pureInput",value:function(e){var t=e.trim();return t.startsWith(l)&&(t=t.substring(15)),t=function e(t){var r=t.indexOf("\x3c!--"),n=t.indexOf("--\x3e");if(r>=0&&n>=0){var a=t.substring(0,r),o=t.substring(n+3);return e("".concat(a).concat(o))}return t}(t),t}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e||"";return this.input=this.pureInput(r),this.len=r.length,this.onTagOpen=t.onTagOpen||this.noop(),this.onTagClose=t.onTagClose||this.noop(),this.cur=0,this.parseNodes()}},{key:"parseNodes",value:function(){var e=[];do{var t=void 0;if("<"===this.peek()){if("/"===this.peek(1))break;t=this.parseElement()}else t=this.parseTextNode();" "!==t&&e.push(t)}while(!this.eof);return e}},{key:"parseTextNode",value:function(){return this.consumeWhile(/[^<]/).replace(/[\s\n]+/g," ")}},{key:"parseElement",value:function(){var e=this;this.consumeChar("<");var t=this.parseTag();this.onTagOpen(t),this.consumeSpace();var r=this.parseAttrs(),n=this.peek(),a=this.peek(-1),o=function(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.parseTag(),e.consumeSpace(),e.consumeChar(">"),a&&e.moveCur(a);var o={tag:t,attrs:r,children:n};return e.onTagClose(t,o),o};if("/>"==="".concat(a).concat(n))return o([]);if(p.includes(t)&&">"===n){var i=f[t],s=i.length;return o([],this.sub(s,this.cur+1)===i?s:0)}this.consumeChar(">");var c=this.parseNodes();return this.consumeChar("<"),this.consumeChar("/"),o(c)}},{key:"parseTag",value:function(){return this.consumeWhile(u)}},{key:"parseAttrs",value:function(){for(var e={};">"!==this.peek();){var t=this.parseTag();if(t){if("="===this.peek()){this.consumeChar("="),this.consumeChar('"');var r=this.consumeWhile(/[^"]/);this.consumeChar('"'),e[t]=r}else e[t]="";this.consumeSpace()}else this.consumeChar(this.peek())}return e}}],r&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function v(e,t){return(new d).parse(e,t)}var h="4.15.2";function m(e){var t=e.appGroupName,r=e.Comp,n=e.platform,a=e.lifecycle,i=e.appName,s=e.versionId;(0,o.appReady)(t,r,{lifecycle:a,platform:n,appName:i,versionId:s})}var g=function(){return g=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},g.apply(this,arguments)};function b(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}function y(e,t,r,n){return new(r||(r=Promise))(function(a,o){function i(e){try{c(n.next(e))}catch(t){o(t)}}function s(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,s)}c((n=n.apply(e,t||[])).next())})}function A(e,t){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(s){o=[6,s],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var _="HelAppCache",S="HelIndexedDB",L="HelMetaData",E={};function I(){var e=(0,o.getGlobalThis)();return"indexedDB"in e?e.indexedDB:(console.warn("The current browser is not support indexedDB!"),null)}var C=function(){function e(e){this.dbInfo={db:null,name:"",storeName:"",version:1},this.ready=null,this.initStorage(e)}return e.prototype.initStorage=function(e){var t=I();if(t){var r=null,n=null;this.ready=new Promise(function(e,t){r=e,n=t});var a=this.dbInfo;if(e){var i=e.name,s=e.storeName,c=e.version;Object.assign(a,o.commonUtil.purify({name:i,storeName:s,version:c}))}var u=E[a.name];u||(u={db:null,name:"",storeName:"",version:1},E[a.name]=u),a.db=u.db;var l=this.isUpgradeNeeded(a);if(a.db){if(!l)return void r(a);a.db.close()}var p=[a.name,void 0];l&&(p[1]=a.version);var f=t.open.apply(t,p);l&&(f.onupgradeneeded=function(e){u.db=f.result,a.db=f.result;try{a.db.createObjectStore(a.storeName)}catch(r){if("ConstraintError"!==r.name)throw r;var t=o.commonUtil.nbstr('\n              The database "'.concat(a.name,'"\n              has been upgraded from version ').concat(e.oldVersion," to version ").concat(e.newVersion,',\n              but the storage "').concat(a.storeName,'" already exists.'));console.warn(t)}}),f.onerror=function(){n(f.error)},f.onsuccess=function(){a.db=f.result,u.db=f.result,a.db.onversionchange=function(e){e.target.close()},r(a)}}},e.prototype.isUpgradeNeeded=function(e){if(!e.db)return!0;var t=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,n=e.version>e.db.version;if(r&&(console.warn('The database "'.concat(e.name,"\" can't be downgraded from version ").concat(e.db.version," to version ").concat(e.version)),e.version=e.db.version),n||t){if(t){var a=e.db.version+1;a>e.version&&(e.version=a)}return!0}return!1},e.prototype.getObjectStore=function(e,t){var r=e.name,n=e.db,a=e.storeName;if(!n)throw new Error("get ".concat(a," objectStore failed in ").concat(r," database"));return n.transaction(a,t||"readonly").objectStore(a)},e.prototype.attachHandler=function(e,t,r){e.onsuccess=function(){t(e.result||null)},e.onerror=function(){r(e.error)}},e.prototype.getItem=function(e){return y(this,void 0,void 0,function(){var t,r,n,a=this;return A(this,function(o){switch(o.label){case 0:return[4,this.getDbInfo()];case 1:return t=o.sent(),r=this.getObjectStore(t),n=r.get(e),[2,new Promise(function(e,t){a.attachHandler(n,e,t)})]}})})},e.prototype.setItem=function(e,t){return y(this,void 0,void 0,function(){var r,n,a,o=this;return A(this,function(i){switch(i.label){case 0:return[4,this.getDbInfo()];case 1:return r=i.sent(),n=this.getObjectStore(r,"readwrite"),a=n.put(t,e),[2,new Promise(function(e,t){o.attachHandler(a,e,t)})]}})})},e.prototype.removeItem=function(e){return y(this,void 0,void 0,function(){var t,r,n,a=this;return A(this,function(o){switch(o.label){case 0:return[4,this.getDbInfo()];case 1:return t=o.sent(),r=this.getObjectStore(t,"readwrite"),n=r.delete(e),[2,new Promise(function(e,t){a.attachHandler(n,e,t)})]}})})},e.prototype.getDbInfo=function(){return this.ready?this.ready:Promise.reject("forget init")},e}();function T(e){return!e.startsWith("//")&&(e.startsWith("/")||e.startsWith("./")||e.startsWith("../"))}function N(){if(!I())return null;try{var e=new C({name:S,storeName:L});return{setItem:function(t,r){return e.setItem(t,r)},getItem:function(t){return e.getItem(t)},removeItem:function(t){return e.removeItem(t)}}}catch(t){return console.error("new IndexedDBStorage error: ".concat(t.message)),null}}function w(){var e,t={getItem:function(){},setItem:function(){},removeItem:function(){}};try{return(null===(e=(0,o.getGlobalThis)())||void 0===e?void 0:e.localStorage)||t}catch(r){return t}}function P(e){return e||(0,o.getPlatform)()}function O(e,t){try{w().setItem(e,JSON.stringify(t))}catch(r){(0,o.log)("save localStorage failed: ".concat(r.message))}}function D(e,t){return"".concat(_,".").concat(P(t),".").concat(e)}function M(e,t){return y(this,void 0,Promise,function(){var r,n,a,i,s,c,u,l,p;return A(this,function(f){switch(f.label){case 0:n=(r=t||{}).platform,a=r.cacheKey,i=r.storageType,s=void 0===i?"indexedDB":i,c=a||D(e,n),f.label=1;case 1:return f.trys.push([1,4,,5]),"indexedDB"!==s?[3,3]:(u=N())?[4,u.getItem(c)]:[3,3];case 2:return[2,f.sent()];case 3:return l=w().getItem(c),[2,o.commonUtil.safeParse(l||"",null)];case 4:return p=f.sent(),console.error(p),[2,null];case 5:return[2]}})})}function x(e,t,r){var n=D(e,r);return(null==t?void 0:t({appName:e,innerKey:n}))||n}function V(e,t){return y(this,void 0,Promise,function(){var r,n,a,o,i;return A(this,function(s){switch(s.label){case 0:return r=t.getCacheKey,n=t.storageType,a=t.platform,o=x(e,r,a),[4,M(e,{platform:a,cacheKey:o,storageType:n})];case 1:return(i=s.sent())?[2,{appInfo:i.app,appVersion:i.version}]:[2,null]}})})}var k="getSubAppAndItsVersion",R="getSubAppAndItsFullVersion",j="batchGetSubAppAndItsVersion",F="batchGetSubAppAndItsFullVersion",U="getSubAppVersion",G="getSubAppFullVersion",B="get",H="Jsonp";var K=Object.freeze({__proto__:null,getUserName:function(e){var t=e.userLsKey,r=w().getItem(t)||"";if(r)return r;try{var n={};(0,o.getGlobalThis)().document.cookie.split(";").forEach(function(e){var t=e.split("="),r=t[0],a=t[1];n[r]=a}),r=n[t]||"",(0,o.log)("[[ getUserName ]] result:",r)}catch(a){(0,o.log)("[[ getUserName ]] err:",a)}return r}}),Y=o.commonUtil.isNull;function W(e,t,r){var n=(0,o.getPlatformConfig)(e),a=n.origin,i=n[t],s=a[t];return r||i||s}function J(e,t,r,n){var a=W(e,t,n);return a?a(r):(K[t]||function(){return null})(r)}function q(e,t,r,n){var a=r||[],i=a[0],s=a[1];if(!Y(i,n))return i;var c=(0,o.getPlatformConfig)(e),u=c[t];if(!Y(u,n))return u;var l=c.origin[t];return Y(l,n)?s:l}function X(e,t){var r,n=(0,o.getPlatformConfig)(e.platform),a=e.hook||{},i=n.origin,s=n.hook;return a[t]||s[t]||(null===(r=i.hook)||void 0===r?void 0:r[t])}function z(e,t){var r,n,a,i="";if(t&&(i=(null===(r=t.getApiPrefix)||void 0===r?void 0:r.call(t))||t.apiPrefix),i)return i;var s=(0,o.getPlatformConfig)(e);if(i=(null===(n=s.getApiPrefix)||void 0===n?void 0:n.call(s))||s.apiPrefix)return i;var c=s.origin;return i=(null===(a=c.getApiPrefix)||void 0===a?void 0:a.call(c))||c.apiPrefix}var Q={now:function(){return(new Date).getTime()},rand:function(){return Math.random().toString().substring(6)},removeElem:function(e){var t=e.parentNode;t&&11!==t.nodeType&&t.removeChild(e)},parseData:function(e){var t="";if("string"==typeof e)t=e;else if("object"==typeof e)for(var r in e)t+="".concat(t,"&").concat(r,"=").concat(encodeURIComponent(e[r]));return t=(t+="&_t=".concat(Q.now())).substring(1)},getJSON:function(e,t){return new Promise(function(r,n){var a="",i=e;i=i+(-1===i.indexOf("?")?"?":"&")+Q.parseData(t);var s=/callback=(\w+)/.exec(i);a=(null==s?void 0:s[1])?s[1]:"helJsonp_".concat(Q.now(),"_").concat(Q.rand()),i=i.includes("?")?"".concat(i,"&callback=").concat(a):"".concat(i,"?callback=").concat(a);var c=(0,o.getGlobalThis)(),u=c.document,l=u.createElement("script");l.type="text/javascript",l.src=i,l.id=a,l.onerror=n,l.addEventListener("error",n),c[a]=function(e){delete c[a];var t=u.getElementById(a);return t&&Q.removeElem(t),r(e)};var p=u.getElementsByTagName("head");(null==p?void 0:p[0])&&p[0].appendChild(l)})}},Z=Q.getJSON;function $(e,t){return y(this,void 0,Promise,function(){var r,n,a;return A(this,function(o){switch(o.label){case 0:return n=(r=t||{}).method,a=b(r,["method"]),[4,new ee(a).request(e,n)];case 1:return[2,o.sent()]}})})}var ee=function(){function e(e){this.req=null,this.resultPromise=Promise.resolve(null),this.init(e||{})}return e.prototype.init=function(e){var t="XMLHttpRequest"in(0,o.getGlobalThis)()?new XMLHttpRequest:null;if(!t)throw new Error("current browser is not support XMLHttpRequest!");this.req=t;var r=e.responseType,n=e.timeout,a=void 0===n?1e4:n,i=e.withCredentials,s=e.headers;t.responseType=r||"json",t.timeout=a,t.withCredentials=!!i,s&&Object.keys(s).forEach(function(e){t.setRequestHeader(e,s[e])});var c=null,u=null;this.resultPromise=new Promise(function(e,t){c=e,u=t});var l=function(e){var r=t.status,n=t.statusText,a=t.responseURL;u({msg:e,status:r,statusText:n,url:a})};t.onload=function(){return e=t.response,r=t.status,n=t.statusText,a=t.responseURL,void c({data:e,status:r,statusText:n,url:a});var e,r,n,a},t.onerror=function(e){return l(e)},t.onabort=function(e){return l(e)},t.ontimeout=function(e){return l(e)},t.onprogress=function(){}},e.prototype.request=function(e,t){return y(this,void 0,Promise,function(){return A(this,function(r){switch(r.label){case 0:if(!this.req)throw new Error("forget init");return this.req.open(t?t.toUpperCase():"GET",e),this.req.send(),[4,this.resultPromise];case 1:return[2,r.sent()]}})})},e}(),te=0;function re(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ne(e,t){var r="";return(0,o.allowLog)()&&(t&&(r="_".concat(te+=1)),console.time("".concat(e).concat(r))),r}function ae(e,t){(0,o.allowLog)()&&console.timeEnd("".concat(e).concat(t||""))}function oe(e,t){return y(this,void 0,void 0,function(){var r,n,a,i;return A(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,ce("".concat(t,"/").concat(e,"@latest/").concat("try_detect_latest_ver","_").concat(Date.now()))];case 1:return r=s.sent().url,n=r.split("@"),a=n[n.length-1],[2,a.split("/")[0]];case 2:return i=s.sent(),(0,o.log)("[[ getSemverLatestVer ]] returns ver(latest) due to error:",i.message),[2,"latest"];case 3:return[2]}})})}function ie(e,t){return y(this,void 0,void 0,function(){var r,n,a,i,s;return A(this,function(c){switch(c.label){case 0:return[4,(0,o.getGlobalThis)().fetch(e)];case 1:return r=c.sent(),n=r.status,a=r.url,[200,304].includes(n)?t?[4,r.json()]:[3,3]:[2,{url:a,reply:null,status:n}];case 2:return i=c.sent(),[2,{url:a,reply:i,status:n}];case 3:return[4,r.text()];case 4:return s=c.sent(),[2,{url:a,reply:s,status:n}]}})})}function se(e,t){return y(this,void 0,void 0,function(){var r,n,a,o,i;return A(this,function(s){switch(s.label){case 0:return[4,$(e,{method:"GET",responseType:t?"json":"text"})];case 1:return r=s.sent(),n=r.status,a=r.data,o=r.url,i=void 0===o?"":o,400===n?[2,{url:i,reply:null,status:n}]:[2,{url:i,reply:a,status:n}]}})})}function ce(e,t){return void 0===t&&(t=!0),y(this,void 0,void 0,function(){var r;return A(this,function(n){switch(n.label){case 0:return r=se,(0,o.getGlobalThis)().fetch&&(r=ie),[4,r(e,t)];case 1:return[2,n.sent()]}})})}function ue(e){var t=e.extraCssList,r=void 0===t?[]:t,n=e.custom;if(n){var a=n.extraCssList,i=void 0===a?[]:a,s=n.enable;if(void 0===s||s)return o.commonUtil.merge2List(r,i)}return r.slice()}var le=o.commonUtil.safeParse,pe=function(e,t){var r,n=e||{},a=n.data||n;return t.onlyVersion&&(a=r=n.version||n.data),r=r||a.version,!t.isFullVersion&&r&&Reflect.deleteProperty(r,"html_content"),r?{data:a,code:"0",msg:""}:{data:null,code:"404",msg:"no version found"}},fe=function(e,t,r){var n=e;return r&&(n+="&".concat(t,"=").concat(r)),n},de=function(e,t){var r=e;return t&&(r+=t),r},ve=function(e){var t=e.semverApi;return void 0===t&&(t=!e.customMetaUrl&&!e.customMetaJsonpUrl),t};function he(e,t){return y(this,void 0,Promise,function(){var r,n,a,o,i,s,c;return A(this,function(u){switch(u.label){case 0:r=null,n=t.semverApi,o=(a=void 0===n||n)?B:t.apiMode,ne(i="request ".concat(e)),u.label=1;case 1:return u.trys.push([1,6,,7]),o!==B?[3,3]:[4,ce(e)];case 2:return s=u.sent(),r=s.reply,[3,5];case 3:return[4,Z(e)];case 4:r=u.sent(),u.label=5;case 5:return ae(i),a?[2,pe(r,t)]:[2,r];case 6:return c=u.sent(),ae(i),[2,{data:null,code:"404",msg:c.message}];case 7:return[2]}})})}function me(e){var t=g({},e);return t.additional_scripts=le(t.additional_scripts,[]),t.additional_body_scripts=le(t.additional_body_scripts,[]),t}function ge(e){var t=g({},e);return t.src_map=le(t.src_map,{htmlIndexSrc:"",webDirPath:"",headAssetList:[],bodyAssetList:[],chunkJsSrcList:[],chunkCssSrcList:[],staticJsSrcList:[],staticCssSrcList:[],relativeJsSrcList:[],relativeCssSrcList:[],otherSrcList:[]}),t}function be(e,t,r,n){return void 0===n&&(n=!1),y(this,void 0,void 0,function(){var a;return A(this,function(o){switch(o.label){case 0:return(a=r)?[3,3]:n?(a="latest",[3,3]):[3,1];case 1:return[4,oe(t,e)];case 2:a=o.sent(),o.label=3;case 3:return[2,"".concat(e,"/").concat(t,"@").concat(a,"/hel_dist/hel-meta.json?_t=").concat(Date.now())]}})})}function ye(e,t){var r=t.versionId,n=t.projectId,a=t.branchId,i=t.apiMode,s=t.isFullVersion,c=void 0!==s&&s,u=t.versionIdList,l=void 0===u?[]:u,p=t.projectIdList,f=void 0===p?[]:p,d=t.branchIdList,v=void 0===d?[]:d,h=t.loadOptions,m=void 0===h?{}:h,g=P(t.platform),b=e,y=b,A=r,_=n,S=a,L=!1;Array.isArray(e)&&(b=e[0],y=e.join(","),A=l.join(","),_=f.join(","),S=v.join(","),L=!0);var E=function(e,t){return q(g,e,[m[e],t])},I=function(e,t){return J(g,e,t,m[e])},C=E("userLsKey",o.helConsts.DEFAULT_USER_LS_KEY),T=I("getUserName",{platform:g,appName:b,userLsKey:C}),N=I("shouldUseGray",{appName:b}),w=E("apiSuffix"),O="";"boolean"==typeof N&&(O=N?"1":"0");var D=i!==B,M="",x="",V=!1;if(L)x=c?F:j;else{var U=E("customMetaUrl",""),G=E("customMetaJsonpUrl","");U?M=A?"".concat(U,"/").concat(b,"@").concat(A,"?"):"".concat(U,"/").concat(b,"?"):D&&G&&(M=A?"".concat(G,"/").concat(b,"@").concat(A,"?"):"".concat(G,"/").concat(b,"?")),M?V=!0:x=c?R:k}if(!V){var K=E("apiPathOfApp",o.helConsts.DEFAULT_API_URL),Y=z(g,m),W=D?H:"",X="".concat(x).concat(W);M="".concat(Y).concat(K,"/").concat(X,"?name=").concat(y),M=fe(M,"version",A)}return M=fe(M,"userName",T),M=fe(M,"projId",_),M=fe(M,"branch",S),M=fe(M,"gray",O),(M=de(M,w)).endsWith("?")&&(M=M.substring(0,M.length-1)),{url:M,userName:T}}function Ae(e,t){return y(this,void 0,void 0,function(){var r,n,a;return A(this,function(o){switch(o.label){case 0:return r=t.versionId,n=t.platform,a=t.loadOptions,[4,be(z(n,a),e,r||"",null==a?void 0:a.skip404Sniff)];case 1:return[2,o.sent()]}})})}function _e(e,t){return y(this,void 0,void 0,function(){var r,n,a,o;return A(this,function(i){switch(i.label){case 0:return r=t.loadOptions,n="",a="",ve(void 0===r?{}:r)?[4,Ae(e,t)]:[3,2];case 1:return a=i.sent(),[3,3];case 2:o=ye(e,t),a=o.url,n=o.userName,i.label=3;case 3:return[2,{url:a,userName:n}]}})})}function Se(e,t){return y(this,void 0,void 0,function(){var r,n,a,i,s,c,u,l,p,f,d,v,h,m,g,b,y,_;return A(this,function(A){switch(A.label){case 0:return r=t.apiMode,n=t.appName,a=t.isFullVersion,i=void 0!==a&&a,s=t.semverApi,c=t.customMetaUrl,u=t.apiPrefix,l=void 0===u?"":u,p=t.getUrl,f=P(t.platform),d=l||q(f,"apiPrefix"),v=q(f,"apiSuffix"),h=q(f,"apiPathOfApp"),m=q(f,"apiPathOfAppVersion"),g="",!!c?(g="".concat(c,"/").concat(n).concat(e?"@".concat(e):""),[3,4]):[3,1];case 1:return s?[4,be(d,n,e)]:[3,3];case 2:return g=A.sent(),[3,4];case 3:b=r===B?"":H,y="".concat(i?G:U).concat(b),_=m||h||o.helConsts.DEFAULT_API_URL,g="".concat(d).concat(_,"/").concat(y,"?ver=").concat(e),g=fe(g,"name",n),g=de(g,v),A.label=4;case 4:return[2,g=(null==p?void 0:p(g))||g]}})})}function Le(e,t){var r=t;if(re(r,"app")&&re(r,"version")&&(r={code:0,data:{app:r.app,version:r.version}}),!r||0!==Number(r.code))throw new Error((null==r?void 0:r.msg)||"getSubAppAndItsVersion err`");var n=r.data||{},a=n.app,o=n.version;if(!a)throw new Error("no app for ".concat(e));if(!o)throw new Error("no version for ".concat(e));return{app:me(a),version:ge(o)}}function Ee(e,t){return y(this,void 0,void 0,function(){var r,n,a,i,s,c,u,l,p,f,d,v,h,m,g,b,_,S,L=this;return A(this,function(E){switch(E.label){case 0:return r=t.versionId,n=t.branchId,a=t.projectId,i=t.platform,s=t.apiMode,c=t.loadOptions,l="getSubAppAndItsVersionFn",f=p="getMeta",(d=W(i,p,(u=void 0===c?{}:c).getMeta))||(d=W(i,l,u.getSubAppAndItsVersionFn),f=l),[4,_e(e,t)];case 1:return v=E.sent(),h=v.url,m=v.userName,g=function(t,r){return y(L,void 0,void 0,function(){var n,a,o;return A(this,function(i){switch(i.label){case 0:return n=t||h,a=ve(u),[4,he(n,{apiMode:r||s,semverApi:a})];case 1:return o=i.sent(),[2,Le(e,o)]}})})},d?(b=J(i,"shouldUseGray",{appName:e},u.shouldUseGray),_={platform:i,appName:e,userName:m,versionId:r,branchId:n,projectId:a,url:h,needGrayVer:b,innerRequest:g},(0,o.log)("[[ ".concat(f," ]] fnParams:"),_),[4,Promise.resolve(d(_))]):[3,3];case 2:return S=E.sent(),[2,Le(e,S)];case 3:return[4,g()];case 4:return[2,E.sent()]}})})}function Ie(e,t){return y(this,void 0,void 0,function(){var r,n,a,o,i,s,c,u,l;return A(this,function(p){switch(p.label){case 0:return r=t.apiMode,n=t.isFullVersion,a=void 0!==n&&n,o=t.semverApi,i=t.customMetaUrl,[4,Se(e,t)];case 1:return[4,he(p.sent(),{apiMode:r,isFullVersion:a,semverApi:!i&&o,onlyVersion:!0})];case 2:if(s=p.sent(),c=s.data,u=s.code,l=s.msg,0!==parseInt(u,10)||!c)throw new Error(l||"ver not found");return[2,ge(c)]}})})}function Ce(e,t){return y(this,void 0,void 0,function(){var r,n,a,o,i,s,c,u,l=this;return A(this,function(p){switch(p.label){case 0:return e.length?(r=t.apiMode,n=t.batchGetFn,a=t.semverApi,o=P(t.platform),[4,ye(e,t)]):[2,[]];case 1:return i=p.sent().url,s=function(){return y(l,void 0,void 0,function(){var e,t,n,o;return A(this,function(s){switch(s.label){case 0:return[4,he(i,{apiMode:r,semverApi:a})];case 1:if(e=s.sent(),t=e.data,n=e.code,o=e.msg,0!==parseInt(n,10)||!t)throw new Error(o||"batch get failed");return[2,t.map(function(e){return{app:me(e.app),version:ge(e.version)}})]}})})},c=[],n?(u={url:i,platform:o,innerRequest:s},[4,Promise.resolve(n(u))]):[3,3];case 2:return c=p.sent(),[3,5];case 3:return[4,s()];case 4:c=p.sent(),p.label=5;case 5:return[2,c]}})})}var Te=o.commonUtil.noop,Ne=o.commonUtil.okeys;function we(e){var t;try{return!!(null===(t=(0,o.getGlobalThis)())||void 0===t?void 0:t.document).querySelector(e)}catch(r){return!1}}function Pe(e,t){var r=e["data-helex"]||"",n=e["data-helappend"],a=(0,o.getGlobalThis)();if("0"===n)return!1;if(r){var i=r.split(",");return("script"!==t||!i.every(function(e){return!!a[e]}))&&!we("".concat(t,'[data-helex="').concat(r,'"]'))}return!0}function Oe(e,t,r){var n=(0,o.getGlobalThis)().document;Ne(t).forEach(function(r){return e.setAttribute(r,t[r])}),r?n.body.appendChild(e):n.head.appendChild(e)}function De(e){var t=e.attrs,r=e.innerText,n=e.appendToBody,a=void 0===n||n,i=e.onloadCb,s=void 0===i?Te:i,c=e.onerrorCb,u=void 0===c?Te:c,l=t.src,p=b(t,["src"]),f=function(e){return s(e),e};if(!l&&!r)return f(!1);var d=(0,o.getGlobalThis)().document;if(l&&we('script[src="'.concat(l,'"]')))return f(!1);if(!Pe(p,"script"))return f(!1);var v=d.createElement("script");return l&&v.setAttribute("src",l),Ne(p).forEach(function(e){return v.setAttribute(e,p[e])}),v.onload=s,v.onerror=u,r&&function(e,t){""===e.textContent?e.textContent=t:e.innerText=t}(v,r),Oe(v,p,a),!0}function Me(e){var t=e.appendToBody,r=void 0!==t&&t,n=e.innerText,a=e.attrs,i=a.href,s=a.rel,c=b(a,["href","rel"]),u=(0,o.getGlobalThis)().document;if(i||n){if(!Pe(c,"link"))return!1;var l=u.createElement("link");i?(l.setAttribute("href",i),l.setAttribute("rel",s||"stylesheet")):s&&l.setAttribute("rel",s),n&&(l.innerText=n),Oe(l,c,r)}}function xe(e){return["link","staticLink","relativeLink"].includes(e.tag)}function Ve(e,t){return Te(t),["script","staticScript","relativeScript"].includes(e)}function ke(e){return"staticScript"===e}function Re(e,t){var r=e.attrs,n=e.innerText,a=void 0===n?"":n,o=t.appendToBody,i=t.appendCss,s=t.webDirPath,c=t.cssAppendTypes,u=t.excludeCssList,l={appendToBody:o,attrs:r,innerText:a},p=r.href;p.endsWith(".ico")&&!0!==e.append||(p.endsWith(".css")?i&&c.includes(function(e,t){return t.startsWith(e)?"build":T(t)?"relative":"static"}(s,p))&&!u.includes(p)&&Me(l):Me(l))}function je(e,t){var r=t.appendToBody;e.forEach(function(e){var n=e.tag,a=e.attrs,i=e.append,s=void 0===i||i,c=e.innerText,u=void 0===c?"":c;s&&(xe(e)?Re(e,t):Ve(n,a)?De({appendToBody:r,attrs:a,innerText:u}):"style"===n&&function(e){var t=e.appendToBody,r=void 0!==t&&t,n=e.innerText,a=void 0===n?"":n,i=e.attrs,s=(0,o.getGlobalThis)().document.createElement("style");s.innerText=a,Oe(s,i,r)}({appendToBody:r,attrs:a,innerText:u}))})}function Fe(e,t){return y(this,void 0,void 0,function(){var r,n;return A(this,function(a){switch(a.label){case 0:return r=t.appendToBody,n=function(e){return new Promise(function(n,a){var o=e.tag,i=e.attrs,s=e.append,c=void 0===s||s,u=e.innerText,l=void 0===u?"":u;if(!c)return n(!0);if(xe(e))return Re(e,t),n(!0);if(Ve(o,i)){return De({appendToBody:r,attrs:i,innerText:l,onloadCb:function(){return n(!0)},onerrorCb:function(e,t,r,n,o){console.error(e,t,r,n,o);var i=o instanceof Error?o:new Error(String(e));a(i)}})}n(!0)})},[4,Promise.all(e.map(n))];case 1:return a.sent(),[2]}})})}function Ue(e,t,r){return y(this,void 0,void 0,function(){var n,a,i,s,c,u,l,p,f,d,v,h,m,g,b,y,_,S,L,E,I,C,T,N,w,P,O,D,M,x;return A(this,function(A){switch(A.label){case 0:return(0,o.getGlobalThis)().__HEL_LOAD_ASSETS_FLAG__=1,n=e.additional_scripts,a=void 0===n?[]:n,i=e.additional_body_scripts,s=void 0===i?[]:i,c=t.src_map,u=c.headAssetList,l=void 0===u?[]:u,p=c.bodyAssetList,f=void 0===p?[]:p,d=c.webDirPath,v=c.chunkCssSrcList,h=void 0===v?[]:v,m=r.useAdditionalScript,g=void 0!==m&&m,b=r.appendCss,y=void 0===b||b,_=r.cssAppendTypes,S=void 0===_?["build","static","relative"]:_,L=r.getExcludeCssList,E=ue(r),I=o.commonUtil.merge2List(E,h),C=(null==L?void 0:L(I,{version:t}))||[],T={excludeCssList:C,webDirPath:d,appendCss:y,cssAppendTypes:S,appendToBody:!1},N={excludeCssList:C,webDirPath:d,appendCss:y,cssAppendTypes:S,appendToBody:!0},g?(w=function(e){return e.endsWith(".css")?{tag:"staticLink",attrs:{href:e}}:{tag:"staticScript",attrs:{src:e}}},P=a.map(w),O=s.map(w),[4,Fe(P,T)]):[3,3];case 1:return A.sent(),[4,Fe(O,N)];case 2:A.sent(),A.label=3;case 3:return E.length&&function(e){var t=e.assetUrlList,r=e.appendCss,n=e.excludeCssList,a=e.appendToBody;if(t)for(var o=0,i=t;o<i.length;o++){var s=i[o];s.endsWith(".css")?r&&!n.includes(s)&&Me({appendToBody:a,attrs:{href:s}}):De({appendToBody:a,attrs:{src:s}})}}({assetUrlList:E,excludeCssList:C,appendToBody:!1}),D=[],M=[],x=[],l.forEach(function(e){ke(e.tag)?D.push(e):M.push(e)}),f.forEach(function(e){ke(e.tag)?D.push(e):x.push(e)}),D.length?[4,Fe(D,T)]:[3,5];case 4:return A.sent(),je(M,T),je(x,N),[2];case 5:return je(M,T),je(x,N),[2]}})})}var Ge=!1,Be=!0,He=!0,Ke="localStorage",Ye="HelExtraData",We="[[ isEmitVerMatchInputVer ]]";function Je(e,t){var r,n=t.branchId,a=t.platform,i=t.emitVer,s=t.inputVer,c=t.projectId,u=q(a,"strictMatchVer",[t.strictMatchVer]),l=(0,o.getAppMeta)(e,a);if(!1===u)return(0,o.log)("".concat(We," set strictMatchVer false for app (").concat(e,"), trust emitVer (").concat(i,") is the target version")),!0;if(!i)return(0,o.log)("".concat(We," emitVer should not be null")),!0;if(!s&&l){if(n)return(0,o.log)("".concat(We," found branchId ").concat(n)),!0;var p=l.online_version,f=l.build_version;if(c){var d=((null===(r=l.proj_ver)||void 0===r?void 0:r.map)||{})[c];if(d)return i===d.b||i===f||i===d.o}return i===p||i===f}return i===s}var qe=o.helConsts.DEFAULT_ONLINE_VER,Xe="http://localhost",ze="http://127.0.0.1",Qe=["script","link","style"];var Ze={isSrcMatchHost:function(e,t){return t.startsWith(Xe)||t.startsWith(ze)?e.startsWith(Xe)||e.startsWith(ze):e.startsWith(t)},parseHtml:function(e){if((0,o.getGlobalThis)().DOMParser)return function(e){var t=(new(0,(0,o.getGlobalThis)().DOMParser)).parseFromString(e,"text/html"),r=[],n=function(e,t,n){e.querySelectorAll(n).forEach(function(e){var a=e.getAttributeNames(),o={};a.forEach(function(t){var r=e.getAttribute(t);null!==r&&(o[t]=r)}),r.push({head:t,tag:n,attrs:o,innerText:e.innerText})})};return Qe.forEach(function(e){return n(t.head,!0,e)}),Qe.forEach(function(e){return n(t.body,!1,e)}),r}(e);var t=!0,r=[],n=function(e){return Qe.includes(e)};return v(e,{onTagOpen:function(e){n(e)&&r.push({tag:e,attrs:{},innerText:"",head:t})},onTagClose:function(e,a){if("head"===e&&(t=!1),n(e)){var o=r[r.length-1];if(o){var i=a.children[0]||"";"string"==typeof i&&(o.innerText=i),o.attrs=a.attrs}}}}),r},convertToAssetList:function(e,t){var r=[],n=[],a=[],o=[],i=[],s=[];return e.forEach(function(e){var c=e.head,u=e.attrs,l=e.innerText,p=e.tag,f=c?r:n,d=u.src,v=u.href,h=u["data-helex"],m=u.rel,g=function(e,t,r){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]||r}(u,"data-helappend","1");if("style"===p)f.push({tag:p,attrs:u,innerText:l,append:!0});else{var b=d||v||"",y=b.endsWith(".css"),A="link"===p;if(!b)return;var _=!0,S=Ze.isSrcMatchHost(b,t);"icon"!==m&&(S||"1"===g||h)||(_=!1);var L=p;S||(T(b)?(L=A?"relativeLink":"relativeScript",y?i.push(b):s.push(b)):(L=A?"staticLink":"staticScript",y?a.push(b):o.push(b)));var E={tag:L,attrs:u,innerText:l,append:_};f.push(E)}}),{headAssetList:r,bodyAssetList:n,staticCssSrcList:a,staticJsSrcList:o,relativeCssSrcList:i,relativeJsSrcList:s}},getChunkList:function(e){var t=[],r=[];return e.forEach(function(e){var n=e.attrs,a=n.href,o=n.src,i=a||o||"";i&&(i.endsWith(".css")?t.push(i):r.push(i))}),{chunkCssSrcList:t,chunkJsSrcList:r}},extactHelMeta:function(e){var t=e.code,r=e.data,n=e.msg;if(t&&r){if("0"!==t)throw new Error(n||"server error occurred");return r}return e},getHelMeta:function(e,t,r){return y(this,void 0,void 0,function(){var n,a,i,s;return A(this,function(c){switch(c.label){case 0:n=function(r){return void 0===r&&(r=""),"fetch ".concat(e," helmeta by url ").concat(t," failed in custom mode! ").concat(r)},c.label=1;case 1:return c.trys.push([1,3,,4]),[4,ce(t)];case 2:if(a=c.sent().reply,(i=Ze.extactHelMeta(a))&&i.app&&i.version)return i.app.__fromCust=!0,[2,i];if(r)throw new Error(n());return(0,o.log)("[[ getCustomMeta ]] 404 is a expected behavior for custom mode, user can ignore it"),[2,null];case 3:if(s=c.sent(),r)throw new Error(n(s.messgae));return o.commonUtil.noop("json parse fail or other error"),[3,4];case 4:return[2]}})})}};function $e(e){if(e){var t=e.enable,r=void 0===t||t;return!(!e.host||!r)}return!1}function et(e,t){return y(this,void 0,Promise,function(){var r,n,a,o,i,s,c,u,l,p,f,d,v,h,m,y,_,S,L,E,I;return A(this,function(A){switch(A.label){case 0:return r=t.host,n=t.appGroupName,a=t.skipFetchHelMeta,o=void 0!==a&&a,i=t.isApiUrl,s=t.parseHtml,c=t.attachHostSuffix,u=void 0===c||c,l=Date.now(),i?[4,Ze.getHelMeta(e,r,!0)]:[3,2];case 1:return[2,f=A.sent()];case 2:return o?[3,4]:(p=r.endsWith("hel-meta.json")?r:"".concat(r,"/hel-meta.json?_t=").concat(l),[4,Ze.getHelMeta(e,p)]);case 3:if(f=A.sent())return[2,f];A.label=4;case 4:d="",A.label=5;case 5:return A.trys.push([5,7,,8]),[4,ce(u?"".concat(r,"/index.html?_t=").concat(l):r,!1)];case 6:if(v=A.sent(),d=v.reply||"",![200,304].includes(v.status))throw new Error("status ".concat(v.status));return[3,8];case 7:throw h=A.sent(),new Error("".concat(h.message," from ").concat(r));case 8:return m=s||Ze.parseHtml,y=m(d),_=Ze.convertToAssetList(y,r),S=_.headAssetList,L=_.bodyAssetList,E=b(_,["headAssetList","bodyAssetList"]),I=Ze.getChunkList(S.concat(L)),[2,{app:{__fromCust:!0,name:e,app_group_name:n||e,online_version:qe,build_version:qe},version:{sub_app_name:e,sub_app_version:qe,src_map:g(g({webDirPath:r,headAssetList:S,bodyAssetList:L},I),E)}}]}})})}var tt=o.commonUtil,rt=o.helConsts,nt=o.log,at=rt.KEY_ASSET_CTX,ot=function(e,t,r){var n=e.name,a=e.app_group_name,i=t.src_map,s=t.version_tag||t.sub_app_version,c=i.chunkCssSrcList,u=void 0===c?[]:c,l=i.chunkJsSrcList,p=void 0===l?[]:l,f=X(r,"beforeAppendAssetNode"),d=u.concat(p),v=r.platform;d.forEach(function(e){var t=(0,o.getCommonData)(at,e)||{};t.marked||(Object.assign(t,{marked:!0,platform:v,groupName:a,name:n,ver:s,beforeAppend:f}),(0,o.setCommonData)(at,e,t))})},it=function(e,t,r){var n=r.loadOptions,a=r.fromFallback,o=X(n,"onFetchMetaSuccess");null==o||o({app:e,version:t,fromFallback:a})};function st(e){var t=W(e.platform,"onFetchMetaFailed",e.onFetchMetaFailed);return X(e,"onFetchMetaFailed")||t}function ct(e,t){var r=P(e),n=function(e,t){var r=(0,o.getPlatformConfig)(e).apiMode;return t||r}(r,t);return{platform:r,apiMode:n}}function ut(e,t,r){return y(this,void 0,void 0,function(){var n,a;return A(this,function(o){switch(o.label){case 0:return n=N(),a=x(e,t,r),n?[4,n.removeItem(a)]:[3,2];case 1:o.sent(),o.label=2;case 2:return w().removeItem(a),[2]}})})}function lt(e,t,r){return y(this,void 0,void 0,function(){var n,a,i,s,c,u,l,p,f,d,v,h,m,g,b,_,S,L,E,I,C,T,N,w,P,O,D,M,x,k,R,j,F,U,G=this;return A(this,function(B){switch(B.label){case 0:return n=t.enableDiskCache,a=void 0===n?Ge:n,i=t.enableSyncMeta,s=void 0===i?He:i,c=t.versionId,u=void 0===c?"":c,l=t.projectId,p=void 0===l?"":l,f=t.branchId,d=t.isFullVersion,v=void 0!==d&&d,h=t.custom,m=t.strictMatchVer,g=t.semverApi,b=(r||{}).callRemote,_=void 0===b||b,S=ct(t.platform,t.apiMode),L=S.platform,E=S.apiMode,$e(h)?[4,et(e,h)]:[3,2];case 1:return I=B.sent(),C=I.app,T=I.version,dt(C,{appVersion:T,platform:L,toDisk:!1,loadOptions:t}),(0,o.setAppPlatform)(C.app_group_name,L),(0,o.setAppPlatformByAppName)(e,L),[2,{appInfo:C,appVersion:T}];case 2:return N=(0,o.getAppMeta)(e,L),w=(0,o.getVersion)(e,{platform:L,versionId:u}),!g&&!f&&N&&w&&(P=w.version_tag||w.sub_app_version,Je(e,{platform:L,projectId:p,emitVer:P,inputVer:u,strictMatchVer:m}))?[2,{appInfo:N,appVersion:w}]:(O={platform:L,apiMode:E,versionId:u,projectId:p,branchId:f,isFullVersion:v,loadOptions:t},D=null,M=function(t){return y(G,void 0,void 0,function(){return A(this,function(r){switch(r.label){case 0:return t?[4,vt(e,O)]:[3,2];case 1:return[2,r.sent()];case 2:return[2,null]}})})},a?[4,V(e,t)]:[3,9]);case 3:return(D=B.sent())?[3,5]:(nt("[[ getAppFromRemoteOrLocal ]] get meta from disk but failed!"),[4,M(_)]);case 4:return D=B.sent(),[3,8];case 5:return x=D.appInfo,k=D.appVersion,nt("[[ getAppFromRemoteOrLocal ]] disk meta:",D),R=k.version_tag||k.sub_app_version,u&&R!==u?[4,M(_)]:[3,7];case 6:return D=B.sent(),nt("[[ getAppFromRemoteOrLocal ]] remote meta:",D),[3,8];case 7:dt(x,{appVersion:k,platform:L,toDisk:!1,loadOptions:t}),M(s).catch(function(e){return tt.noop(e)}),B.label=8;case 8:return[3,11];case 9:return[4,M(_)];case 10:D=B.sent(),B.label=11;case 11:return D&&(j=D.appInfo,F=j.app_group_name,U=j.name,(0,o.setAppPlatform)(F,L),(0,o.setAppPlatformByAppName)(U,L)),[2,D]}})})}function pt(e,t){return y(this,void 0,Promise,function(){var r,n,a,o,i,s;return A(this,function(c){switch(c.label){case 0:r=t.isFirstCall,n=void 0===r||r,a=t.enableDiskCacheForErr,o=void 0===a?Be:a,c.label=1;case 1:return c.trys.push([1,3,,6]),[4,lt(e,t)];case 2:return[2,{data:s=c.sent(),err:""}];case 3:if(i=c.sent(),n)throw i;return st(t)?[2,{data:null,err:i.message}]:(s=null,o?[4,V(e,t)]:[3,5]);case 4:if(!(s=c.sent()))throw i;tt.nbalert("\n        [Dev mode alert err only]: ".concat(i.message,", hel-micro will try use cached data to keep your app works well,\n        please check your network if this behavior is not as you expected! you can also set enableDiskCacheForErr = false\n        to skip reusing cached data.\n      ")),c.label=5;case 5:return[2,{data:s,err:i}];case 6:return[2]}})})}function ft(e,t){return y(this,void 0,void 0,function(){var r,n,a,o,i,s,c;return A(this,function(u){switch(u.label){case 0:return r=ct(t.platform,t.apiMode),n=r.platform,a=r.apiMode,o=g(g({},t),{platform:n,apiMode:a}),[4,Ee(e,o)];case 1:if(i=u.sent(),s=i.app,c=i.version,nt("[[ getAppAndVersion ]] result:",{app:s,version:c}),!c)throw new Error("no version found or builded");return[2,{appInfo:s,appVersion:c}]}})})}function dt(e,t){var r=t.appVersion,n=t.platform,a=t.toDisk,i=void 0===a||a,s=t.loadOptions;if(e&&r){var c=e,u=c.name;if(i)!function(e,t,r){if("indexedDB"!==r)return O(e,t);var n=N();if(!n)return O(e,t);n.setItem(e,t).catch(function(r){(0,o.log)("save indexeddb failed, use localStorage instead, err: ".concat(r.message)),O(e,t)})}(x(u,s.getCacheKey),{app:e,version:r},s.storageType);if(s.semverApi){var l=(0,o.getAppMeta)(u,n);!0!==(null==l?void 0:l.__setByLatest)&&(c=s.versionId?c:g(g({},c),{__setByLatest:!0}),(0,o.setAppMeta)(c,n))}else(0,o.setAppMeta)(e,n);(0,o.setVersion)(u,r,{platform:n});var p=ue(s),f=r.version_tag||r.sub_app_version;(0,o.setVerExtraCssList)(u,p,{platform:n,versionId:f})}}function vt(e,t){return y(this,void 0,void 0,function(){var r,n,a,o,i;return A(this,function(s){switch(s.label){case 0:return r=t.platform,n=t.loadOptions,[4,ft(e,t)];case 1:return a=s.sent(),o=a.appInfo,i=a.appVersion,dt(o,{appVersion:i,platform:r,loadOptions:n}),[2,a]}})})}function ht(e,t){return void 0===t&&(t={}),y(this,void 0,Promise,function(){var r,n,a,o,i,s,c,u,l,p,f,d,v,h,m,b,_,S,L=this;return A(this,function(E){switch(E.label){case 0:r=t.isFirstCall,n=void 0===r||r,a=t.controlLoadAssets,o=void 0!==a&&a,i=t.platform,s=t.versionId,c=void 0===s?"":s,E.label=1;case 1:return E.trys.push([1,6,,9]),[4,pt(e,t)];case 2:return u=E.sent(),l=u.data,p=u.err,d=(f=l||{}).appInfo,v=f.appVersion,h=!1,!(!d||!v)||n?[3,4]:(m=st(t))?[4,Promise.resolve(m({platform:i,appName:e,versionId:c}))]:[3,4];case 3:(b=E.sent())&&(d=b.app,v=b.version,h=!0,dt(d,{appVersion:v,platform:P(i),toDisk:!1,loadOptions:t})),E.label=4;case 4:if(!d)throw new Error(p||"app[".concat(e,"] not exist"));if(!v)throw new Error(p||"app[".concat(e,"]'s version[").concat(c,"] not exist"));return it(d,v,{loadOptions:t,fromFallback:h}),ot(d,v,t),_=function(){return y(L,void 0,void 0,function(){return A(this,function(e){switch(e.label){case 0:return[4,Ue(d,v,t)];case 1:return e.sent(),[2]}})})},o?[2,_]:[4,_()];case 5:return E.sent(),[2,null];case 6:return S=E.sent(),n?(console.error("loadApp err and try one more time: ",S),[4,ht(e,g(g({},t),{isFirstCall:!1}))]):[3,8];case 7:return[2,E.sent()];case 8:throw new Error("loadApp [".concat(e,"] err (").concat(S.message,"), recommend config onFetchMetaFailed hook"));case 9:return[2]}})})}var mt=Object.freeze({__proto__:null,getSubAppVersion:function(e,t){return y(this,void 0,Promise,function(){return A(this,function(r){switch(r.label){case 0:return[4,Ie(e,t)];case 1:return[2,r.sent()]}})})},getSubAppMeta:function(e,t){return y(this,void 0,Promise,function(){var r,n,a,i,s,c,u,l,p;return A(this,function(f){switch(f.label){case 0:return n=(r=t||{}).versionId,a=r.projectId,i=r.branchId,s=r.platform,c=r.reuseCache,!(void 0===c||c)||n||a||i||(l=(0,o.getAppMeta)(e,s),p=(0,o.getVersion)(e,{platform:s}),l&&p&&(u={app:l,version:p})),u?[3,2]:[4,Ee(e,t||{})];case 1:u=f.sent(),f.label=2;case 2:return[2,u]}})})},getMetaDataUrl:function(e,t){var r=t||{},n=r.versionId,a=r.platform,o=r.apiMode,i=void 0===o?B:o,s=r.protocol,c=void 0===s?"http":s,u=r.projectId,l=r.branchId,p=r.semverApi,f=ye(e,{platform:a,versionId:n,branchId:l,apiMode:i,projectId:u,semverApi:void 0===p||p}).url;return"http"===c&&(f=f.replace("https:","http:")),f},clearDiskCachedApp:function(e,t,r){return y(this,void 0,void 0,function(){var n;return A(this,function(a){switch(a.label){case 0:return Array.isArray(e)?(n=[],e.forEach(function(e){return n.push(ut(e,t,r))}),[4,Promise.all(n)]):[3,2];case 1:return a.sent(),[3,4];case 2:return[4,ut(e,t,r)];case 3:a.sent(),a.label=4;case 4:return[2]}})})}});function gt(e,t){var r=(0,o.getVersion)(e,t);return(null==r?void 0:r.src_map.webDirPath)||""}function bt(e,t){var r=t||{},n=P(r.platform),a=r.versionId||"";if(!a){var i=(0,o.getVersion)(e,{platform:n});if(i)a=i.version_tag||i.sub_app_version;else{var s=(0,o.getAppMeta)(e,n);a=(null==s?void 0:s.online_version)||(null==s?void 0:s.build_version)||""}}return{platform:n,versionId:a}}var yt=gt,At=Object.freeze({__proto__:null,getPlatAndVer:bt,getGroupedStyleList:function(e,t){var r={static:[],build:[]},n=(0,o.getVersion)(e,t);if(n){var a=n.src_map,i=a.webDirPath;a.chunkCssSrcList.forEach(function(e){e.startsWith(i)?r.build.push(e):r.static.push(e)})}return r},getWebDirPath:yt}),_t=o.helConsts.KEY_CSS_STR,St=o.helLoadStatus,Lt=St.LOADED,Et=St.LOADING,It=St.NOT_LOAD,Ct=o.commonUtil.merge2List,Tt=(0,o.getHelEventBus)(),Nt=o.helEvents.STYLE_STR_FETCHED,wt={isStyleStatusMatch:function(e,t,r){var n=bt(e,r),a=n.platform,i=n.versionId;return(0,o.getVerStyleStrStatus)(e,{platform:a,versionId:i})===t},getSelfCssList:function(e,t){var r=bt(e,t),n=(0,o.getVersion)(e,r),a=(0,o.getVerExtraCssList)(e,r),i=[],s=[];if(n){var c=n.src_map||{},u=c.chunkCssSrcList,l=void 0===u?[]:u,p=c.headAssetList,f=void 0===p?[]:p,d=c.bodyAssetList,v=void 0===d?[]:d;i=l;var h=function(e){var t=[];return e.forEach(function(e){var r=e.append,n=void 0===r||r,a=e.attrs.href||"";a.endsWith(".css")&&n&&t.push(a)}),t},m=Ct(h(f),h(v));s=Ct(m,i)}return{buildCssList:i,initExtraCssList:a,appCssList:s=Ct(s,a)}},fetchStyleStr:function(e){return y(this,void 0,void 0,function(){var t,r,n,a,i,s,c;return A(this,function(u){switch(u.label){case 0:t="",r=0,n=e.length,u.label=1;case 1:if(!(r<n))return[3,7];if(!(a=e[r]).endsWith(".css"))return[3,6];if(i=(0,o.getCommonData)(_t,a))return[3,5];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,ce(a,!1)];case 3:return s=u.sent(),i=s.reply,(0,o.setCommonData)(_t,a,i),[3,5];case 4:return c=u.sent(),console.error(c),[3,5];case 5:t+=i,u.label=6;case 6:return r++,[3,1];case 7:return[2,t]}})})},waitStyleReady:function(e,t){return y(this,void 0,void 0,function(){var r;return A(this,function(n){switch(n.label){case 0:return r=null,[4,new Promise(function(n){r=function(r){var a=r.appName,o=r.platform,i=r.versionId,s=t.branchId,c=t.versionId,u=t.platform,l=t.strictMatchVer;a===e&&o===u&&Je(e,{branchId:s,platform:u,emitVer:i,inputVer:c,strictMatchVer:l})&&n(!0)},Tt.on(Nt,r)})];case 1:return n.sent(),r&&Tt.off(Nt,r),[2]}})})},computeStyleData:function(e,t){var r=bt(e,t),n=wt.getSelfCssList(e,t),a=n.appCssList,i=n.buildCssList,s=n.initExtraCssList,c=t.extraCssList,u=void 0===c?[]:c,l=t.getExcludeCssList,p=Ct(a,u),f=(null==l?void 0:l(p,{version:(0,o.getVersion)(e,r)}))||[],d=!f.length&&!u.length,v=p;return f.length&&(v=p.filter(function(e){return!f.includes(e)})),{validCssList:v,onlyUseAppCssList:d,buildCssList:i,initExtraCssList:s,appCssList:a}},fetchStyleData:function(e,t){return y(this,void 0,void 0,function(){var r,n,a,i,s,c,u,l,p,f,d,v,h,m,b,y,_,S;return A(this,function(A){switch(A.label){case 0:return r=bt(e,t),n=t.extraStyleStr,a=void 0===n?"":n,i=t.cssListToStr,s=t.extraCssList,c=void 0===s?[]:s,u=t.strictMatchVer,l=t.branchId,p=wt.computeStyleData(e,t),f=p.validCssList,d=p.onlyUseAppCssList,v=p.buildCssList,h=p.initExtraCssList,m=p.appCssList,b={validCssList:f,buildCssList:v,initExtraCssList:h,appCssList:m,extraCssList:c,extraStyleStr:a,renderStyleStr:""},i?d?(y=(0,o.getVerStyleStrStatus)(e,r),_="",y!==Et?[3,2]:[4,wt.waitStyleReady(e,g(g({},r),{strictMatchVer:u,branchId:l}))]):[3,6]:[2,b];case 1:return A.sent(),_=(0,o.getAppStyleStr)(e,r)||"",[3,5];case 2:return y!==It?[3,4]:((0,o.setVerStyleStrStatus)(e,Et,r),[4,wt.fetchStyleStr(m)]);case 3:return _=A.sent(),(0,o.setAppStyleStr)(e,_,r),(0,o.setVerStyleStrStatus)(e,Lt,r),Tt.emit(Nt,g({appName:e},r)),[3,5];case 4:_=(0,o.getAppStyleStr)(e,r)||"",A.label=5;case 5:return b.renderStyleStr="".concat(_).concat(a),[3,8];case 6:return[4,wt.fetchStyleStr(f)];case 7:S=A.sent(),b.renderStyleStr="".concat(S).concat(a),A.label=8;case 8:return[2,b]}})})}};function Pt(e,t){var r=(t||{}).custom||{},n="",a=r.host,o=r.enable;if(a&&(void 0===o||o))if(a.endsWith(".json")||a.endsWith(".html")){var i=a.split("/"),s=i.length;i.splice(s-1,s),n=i.join("/")}else n=a;else n=gt(e,t);return n}var Ot=Object.freeze({__proto__:null,fetchAppStyleData:function(e,t){return y(this,void 0,Promise,function(){return A(this,function(r){switch(r.label){case 0:return[4,wt.fetchStyleData(e,t||{})];case 1:return[2,r.sent()]}})})},getAppStyleStr:function(e,t){var r=bt(e,t);return(0,o.getAppStyleStr)(e,r)},getAppCssList:function(e,t){return wt.getSelfCssList(e,t||{})},fetchStyleByUrlList:function(e){return y(this,void 0,void 0,function(){return A(this,function(t){switch(t.label){case 0:return[4,wt.fetchStyleStr(e)];case 1:return[2,t.sent()]}})})},isStyleFetched:function(e,t){return wt.isStyleStatusMatch(e,Lt,t||{})},disableStyleTags:function(e){var t=(0,o.getGlobalThis)();t.document&&t.document.querySelectorAll('style[data-gname="'.concat(e,'"]')).forEach(o.commonUtil.disableNode)},getStyleTagText:function(e){return o.commonDataUtil.getStyleTagText(e)},getIgnoredCssUrlList:function(e,t){var r=Pt(e,t);return o.commonDataUtil.getIgnoreCssPrefixCssUrlList(r)||[]},getSuitableCssPrefix:Pt});function Dt(e,t,r){var n=r.platform;if(!(0,o.getAppMeta)(t,n)){var a=(0,o.getAppMeta)(e,n),i=(0,o.getVersion)(e,r);if(a&&i){(0,o.setAppMeta)(g(g({},a),{name:t,__addedByTrust:!0}),n),(0,o.setVersion)(t,g(g({},i),{sub_app_name:t,__addedByTrust:!0}),{platform:n});var s=(0,o.getVerExtraCssList)(e,r);(0,o.setVerExtraCssList)(t,s,r)}}}function Mt(e,t){var r=t.versionId,n=void 0===r?"":r,a=t.isLib,i=P(t.platform),s=q(i,"strictMatchVer",[t.strictMatchVer]),c=g(g({},t),{strictMatchVer:s}),u=e,l=t.custom;$e(l)&&(u=l.appGroupName||e,c.strictMatchVer=!1);var p=(0,o.getAppMeta)(u,i);if(t.semverApi&&!n&&p&&!0!==p.__setByLatest)return null;if(a){var f=(0,o.getVerLib)(u,c),d={appName:u,appGroupName:(null==p?void 0:p.app_group_name)||"",platform:i,appProperties:f,isLib:!0,versionId:n,Comp:null,lifecycle:void 0};return f?d:null}return(0,o.getVerApp)(u,c)||null}function xt(e,t,r){var n="[[ judgeAppReady ]]",a=t.versionId,i=void 0===a?"":a,s=t.projectId,c=t.appName,u=t.platform,l=t.next,p=t.error,f=t.isLib,d=t.strictMatchVer;(0,o.log)("".concat(n," receive emit app and judge (emitAppInfo, judgeOptions):"),e,{inputVer:i,projectId:s,appName:c,platform:u,isLib:f,strictMatchVer:d});var v=P(u),h=e.appName,b=e.appGroupName,y=e.platform,A=void 0===y?v:y,_=e.versionId,S="".concat(u,"/").concat(c,"/").concat(i),L=(0,o.getAppMeta)(c,u),E=r.branchId,I=r.custom,C=r.trust,T=function(e){try{var t=f?function(e,t,r){var n=r.platform,a=r.emitPlatform,i=r.versionId,s=r.emitVer;if(!(0,o.getVerLib)(e,r)){Dt(e,t,r);var c=(0,o.getVerLib)(t,{platform:n,versionId:i});if(!c&&a&&(c=(0,o.getVerLib)(t,{platform:a,versionId:s,strictMatchVer:!1})),!c)throw new Error("seems plat ".concat(a," emit null lib for ").concat(t));return(0,o.libReady)(t,c,{platform:n,appName:e,versionId:i}),!1}return!0}(c,b,e):function(e,t,r){var n=r.platform,a=r.emitPlatform,i=r.versionId,s=r.emitVer;if(!(0,o.getVerApp)(e,r)){Dt(e,t,r);var c=(0,o.getVerApp)(t,{platform:n,versionId:i});if(!c&&a&&(c=(0,o.getVerApp)(t,{platform:a,versionId:s,strictMatchVer:!1})),!c)throw new Error("seems plat ".concat(a," emit null app for ").concat(t));return m(g(g({},c),{platform:n,appGroupName:t,appName:e,versionId:i})),!1}return!0}(c,b,e);return t}catch(r){return p(r),!1}};if(I){var N=I.enable,w=void 0===N||N,O=I.host,D=I.appGroupName,M=I.trust,x=void 0!==M&&M;if(w&&O){(0,o.log)("".concat(n," judge for custom:"),I);var V=function(e){(0,o.log)("".concat(n," custom conf ").concat(e?"":"mis","match current emit app!")),e&&l()};return V(x?T({versionId:i,platform:v,emitPlatform:A,emitVer:_}):b&&(b===c||b===D))}}if(!1===d&&b&&(null==L?void 0:L.app_group_name)===b&&v===A)return(0,o.log)("".concat(n," treat emitApp as wanted when strictMatchVer is false (appInfo):"),e),l();var k=function(){return(0,o.log)("".concat(n," still wait ").concat(S," to be emitted (emitAppInfo,toMatch):"),e,R)},R={branchId:E,platform:u,emitVer:_,inputVer:i,projectId:s,strictMatchVer:d};if(c!==h||!Je(c,R))return k();var j=q(v,"trustAppNames",[null,[]],{emptyArrIsNull:!1});if(v!==A&&(C||j.includes(c))&&!T({versionId:i,platform:v,emitPlatform:A,emitVer:_}))return(0,o.log)("".concat(n," transfer ").concat(A," app [").concat(c,"] to ").concat(v," plat due to being in trustAppNames")),k();l()}var Vt=Object.freeze({__proto__:null,getLibOrApp:Mt,judgeAppReady:xt});function kt(e){var t=e.platform,r=b(e,["platform"]);(0,o.initPlatformConfig)(r,t)}function Rt(){return(0,o.isSubApp)()}function jt(e){if(e&&!e.default)try{e.default=e}catch(t){}return e}function Ft(e){var t=(0,o.getGlobalThis)();Object.keys(e).forEach(function(r){var n=e[r];n&&(t[r]=n)})}function Ut(e){var t=jt(e.React),r=jt(e.ReactDOM),n=e.ReactIs||null,a=e.ReactReconciler||null;Ft({LEAH_React:t,LEAH_ReactDOM:r,LEAH_ReactIs:n,LEAH_ReactReconciler:a,React:t,ReactDOM:r,ReactIs:n,ReactReconciler:a})}function Gt(e){var t=jt(e.Vue);Ft({LEAH_Vue:t,Vue:t})}function Bt(e){return"".concat(Ye,".").concat(e)}function Ht(e,t){var r,n,a=null!=t&&t,i=null!==(n=null===(r=(0,o.getGlobalThis)().localStorage)||void 0===r?void 0:r.getItem(Bt(e)))&&void 0!==n?n:null;return i?a?JSON.parse(i):i:null}function Kt(e,t,r){var n,a=null!=r&&r?JSON.stringify(t):t;null===(n=(0,o.getGlobalThis)().localStorage)||void 0===n||n.setItem(Bt(e),a)}function Yt(e){var t;return"string"==typeof e?null===(t=(0,o.getGlobalThis)())||void 0===t?void 0:t.document.getElementById(e):e}function Wt(e,t){return{name:e,platform:(null==t?void 0:t.platform)||(0,o.getAppPlatform)(e),versionId:(null==t?void 0:t.versionId)||"",getShadowAppRoot:Yt,getShadowBodyRoot:Yt}}var Jt=o.commonUtil.getObjsVal,qt=o.commonUtil.purify,Xt=Ge,zt=He,Qt=Ke,Zt="preFetchLib",$t="preFetch";function er(e,t){var r="string"==typeof t?{versionId:t}:g({},t||{});r.platform=P(r.platform),r.isLib=e;var n=r.platform;return r.strictMatchVer=q(n,"strictMatchVer",[r.strictMatchVer]),r.storageType=r.storageType||"indexedDB",r.semverApi=q(n,"semverApi",[r.semverApi]),r}function tr(e,t,r){return y(this,void 0,void 0,function(){var n,a,i,s,c,u,l,p,f;return A(this,function(d){switch(d.label){case 0:return n=(0,o.getHelEventBus)(),a=t.platform,i=t.isLib,s=void 0!==i&&i,c=t.versionId,u=t.projectId,l=t.strictMatchVer,p=s?o.helEvents.SUB_LIB_LOADED:o.helEvents.SUB_APP_LOADED,f=null,[4,new Promise(function(i,d){if(f=function(r){xt(r,{appName:e,platform:a,versionId:c,projectId:u,isLib:s,next:i,error:d,strictMatchVer:l},t)},n.on(p,f),r){var v=(0,o.getAppMeta)(e,a);v&&function(e,t,r){if(r.shadow){if(!t)return;var n=Pt(e,r);o.commonDataUtil.setIgnoreCssPrefix(n),o.commonDataUtil.setIgnoreStyleTagKey(e),o.commonDataUtil.setIgnoreStyleTagKey(t),o.commonDataUtil.setIgnoreCssPrefixKey(n,t)}}(e,v.app_group_name,t),r().catch(d)}})];case 1:return d.sent(),f&&n.off(p,f),[2,Mt(e,t)]}})})}function rr(e,t){return y(this,void 0,void 0,function(){var r,n,a,i,s,c,u;return A(this,function(l){switch(l.label){case 0:r=null,n=t.versionId,a=t.isLib,i=a?Zt:"preFetchApp",l.label=1;case 1:return l.trys.push([1,7,,8]),(r=Mt(e,t))&&(!n||n&&r.versionId===n)?((0,o.log)("[[ ".concat(i," ]] return cached app:"),e,t),[2,{emitApp:r,msg:""}]):(s=null,(c=(0,o.getVerLoadStatus)(e,t))!==o.helLoadStatus.LOADED?[3,3]:[4,tr(e,t)]);case 2:return r=l.sent(),(0,o.log)("[[ ".concat(i," ]] return emit app:"),e,t,r),[2,{emitApp:r,msg:""}];case 3:return c===o.helLoadStatus.LOADING?[3,5]:((0,o.setVerLoadStatus)(e,o.helLoadStatus.LOADING,t),[4,ht(e,g(g({},t),{controlLoadAssets:!0}))]);case 4:s=l.sent(),(0,o.perfPeek)($t,"loadApp"),l.label=5;case 5:return[4,tr(e,t,s)];case 6:return r=l.sent(),(0,o.perfPeek)($t,"waitAppEmit"),(0,o.log)("[[ ".concat(i," ]] return fetch&emit app:"),e,t,r),[2,{emitApp:r,msg:""}];case 7:return u=l.sent(),console.error(u),(0,o.setVerLoadStatus)(e,o.helLoadStatus.NOT_LOAD,t),[2,{emitApp:r,msg:u.message}];case 8:return[2]}})})}function nr(e,t){return y(this,void 0,Promise,function(){var r,n,a,i,s,c,u,l,p;return A(this,function(f){switch(f.label){case 0:return(0,o.perfMark)($t),r="".concat(Zt,"(").concat(e,")"),n=ne(r,!0),a=er(!0,t),[4,rr(e,a)];case 1:if(i=f.sent(),s=i.emitApp,c=i.msg,!(u=null==s?void 0:s.appProperties)&&a.onLibNull&&(l=a.onLibNull(e,{versionId:a.versionId}))&&(u=l),ae(r,n),(0,o.perfPeek)($t,"end",!0),!u)throw p=c?" details : ".concat(c):"",new Error("".concat(Zt," ").concat(e," fail from ").concat(a.platform,", it may be an invalid module!").concat(p));return[2,u]}})})}function ar(e,t){return y(this,void 0,void 0,function(){var r,n;return A(this,function(a){switch(a.label){case 0:return(0,o.perfMark)($t),r=er(!1,t),[4,rr(e,r)];case 1:return n=a.sent(),(0,o.perfPeek)($t,"end",!0),[2,(null==n?void 0:n.emitApp)||null]}})})}function or(e,t){return y(this,void 0,Promise,function(){var r,n,a,o,i,s,c,u,l,p,f,d,v,h,m,b,y,_,S,L,E,I,C;return A(this,function(A){switch(A.label){case 0:if(r=(null==t?void 0:t.preFetchConfigs)||{},n=g({semverApi:!1},(null==t?void 0:t.common)||{}),a=P(n.platform),o=n.versionIdList,i=void 0===o?[]:o,s=n.projectIdList,c=void 0===s?[]:s,u=n.branchIdList,l=void 0===u?[]:u,p=[],f=[],d=[],e.length>8)throw new Error("only support 8 appName at most!");for(y in v=[],h=[],m={},b=[],e)b.push(y);_=0,A.label=1;case 1:return _<b.length?(S=b[_],L=e[S],E=r[L],I={platform:a,versionId:i[S]||"",projectId:c[S]||"",branchId:l[S]||""},"string"==typeof E&&E?I.versionId=E:"object"==typeof E&&E&&((I=g(g({},I),qt(E))).platform=a),m[L]=I,I.enableDiskCache=Jt([I,n],"enableDiskCache",Xt),I.enableSyncMeta=Jt([I,n],"enableSyncMeta",zt),I.storageType=Jt([I,n],"storageType",Qt),[4,lt(L,I,{callRemote:!1})]):[3,4];case 2:A.sent()||(h.push(L),p[S]=I.versionId||"",f[S]=I.projectId||"",d[S]=I.branchId||""),A.label=3;case 3:return _++,[3,1];case 4:return n.versionIdList=p,n.projectIdList=f,n.branchIdList=d,n.semverApi?[4,Promise.all(h.map(function(e){return Ee(e,m[e])}))]:[3,6];case 5:return v=A.sent(),[3,8];case 6:return[4,Ce(h,n)];case 7:v=A.sent(),A.label=8;case 8:return v.forEach(function(e){var t=e.app,r=e.version,n=m[t.name]||{};dt(t,{appVersion:r,platform:a,toDisk:n.enableDiskCache,loadOptions:n})}),C=e.map(function(e){return nr(e,m[e])}),[4,Promise.all(C)];case 9:return[2,A.sent()]}})})}var ir=Object.freeze({__proto__:null,core:o,VER:h,emitApp:m,getAppCacheKey:D,getCachedAppMeta:M,appMetaSrv:mt,appParamSrv:At,appStyleSrv:Ot,logicSrv:Vt,init:kt,isSubApp:Rt,bindExternals:Ft,bindReactRuntime:Ut,bindVueRuntime:Gt,getExtraData:Ht,setExtraData:Kt,getFakeHelContext:Wt,batchPreFetchLib:or,preFetchApp:ar,preFetchLib:nr}),sr=o.commonUtil.purify,cr=(0,o.getUserEventBus)(),ur=["eventBus","getExtraData","setExtraData","bindExternals","bindVueRuntime","bindReactRuntime","isSubApp"],lr={ignoreFns:["tryGetAppName","log","commonUtil","getCommonData","setCommonData","setGlobalThis"],arg1PlatFns:["getPlatformConfig","getSharedCache"],arg2PlatFns:["initPlatformConfig","getAppMeta","setAppMeta","tryGetVersion","setAppPlatform"],arg2PlatObjFns:[]},pr=["preFetchLib","preFetchApp"],fr=["getSubAppMeta","getMetaDataUrl"],dr=["emitApp","init"],vr=["getAppCacheKey"];function hr(e,t,r){var n=r.preFetchOptions,a=r.isCore,o={};return Object.keys(t).forEach(function(i){var s=t[i];if(ur.includes(i))o[i]=s;else{var c=typeof s;if("function"!==c)if(s&&"object"===c){var u=g(g({},r),{isCore:"core"===i});o[i]=hr(e,s,u)}else o[i]=s;else{var l={fnName:i,fn:s,isCore:a,preFetchOptions:n};o[i]=function(e,t){var r=this,n=t.fnName,a=t.fn,o=t.isCore,i=t.preFetchOptions;return function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];var c=function(t){return g({platform:e},sr(t||{}))},u=t[0],l=t[1],p=t[2];if(o){if("getPlatform"===n)return e;lr.arg1PlatFns.includes(n)?t[0]=u||e:lr.arg2PlatFns.includes(n)?t[1]=l||e:lr.arg2PlatObjFns.includes(n)?t[1]=c(l):lr.ignoreFns.includes(n)||(n.startsWith("set")?t[2]=c(p):t[1]=c(l))}else if("batchPreFetchLib"===n){var f=l||{},d=c(f.common);t[1]=g(g({},f),{common:d})}else if(pr.includes(n)){var v=sr("string"==typeof l?{versionId:l}:l||{});i&&(v=sr(g(g({},i),v))),t[1]=g({platform:e},v)}else if(fr.includes(n)){var h=(i||{}).semverApi,m=void 0===h||h;t[1]=c(g({semverApi:m},sr(l||{})))}else dr.includes(n)?t[0]=c(u):vr.includes(n)?t[1]=l||e:t[1]=c(l);return a.apply(r,t)}}(e,l)}}}),o}function mr(e,t){var r=hr(e,ir,{preFetchOptions:t});return r.createInstance=mr,r.createOriginInstance=gr,r.resetGlobalThis=o.resetGlobalThis,r.eventBus=cr,r.default=r,r}function gr(e,t){var r=t||{},n=(r.trustAppNames,b(r,["trustAppNames"]));return(0,o.originInit)(e,t),mr(e,n)}var br=h,yr=nr,Ar=ar,_r=or,Sr=Ot,Lr=At,Er=mt,Ir=Vt,Cr=m,Tr=kt,Nr=Rt,wr=D,Pr=M,Or=Wt,Dr=Ht,Mr=Kt,xr=Ft,Vr=Gt,kr=Ut,Rr=o,jr=o.resetGlobalThis,Fr=mr,Ur=gr,Gr=(0,o.getUserEventBus)();Rr.log("hel-micro ver ".concat(br));var Br={VER:br,preFetchLib:yr,preFetchApp:Ar,batchPreFetchLib:_r,appStyleSrv:Sr,appParamSrv:Lr,appMetaSrv:Er,logicSrv:Ir,emitApp:Cr,eventBus:Gr,init:Tr,isSubApp:Nr,getAppCacheKey:wr,getCachedAppMeta:Pr,getFakeHelContext:Or,getExtraData:Dr,setExtraData:Mr,bindExternals:xr,bindVueRuntime:Vr,bindReactRuntime:kr,resetGlobalThis:jr,core:o,createInstance:Fr,createOriginInstance:Ur};!function(e){var t=(0,o.getGlobalThis)();o.commonUtil.isServer()||t.HelMicro||((0,o.log)("auto bind hel-micro to global.HelMicro"),t.HelMicro=e)}(Br),o.commonUtil.noop(a())},2917:(e,t,r)=>{"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){a(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,s=[],c=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return s}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function l(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}r.r(t),r.d(t,{allowLog:()=>gt,appReady:()=>or,clearPerfMark:()=>_t,commonDataUtil:()=>kt,commonUtil:()=>pt,evName:()=>nr,getAppMeta:()=>Nt,getAppPlatform:()=>qt,getAppPlatformByAppName:()=>Qt,getAppStyleStr:()=>Gt,getCommonData:()=>xt,getCustomData:()=>Dt,getGlobalThis:()=>St,getHelDebug:()=>mt,getHelEventBus:()=>tr,getPlatform:()=>vt,getPlatformConfig:()=>Jt,getSharedCache:()=>ht,getUserEventBus:()=>rr,getVerApp:()=>Et,getVerExtraCssList:()=>Ht,getVerLib:()=>Ct,getVerLoadStatus:()=>Rt,getVerStyleStrStatus:()=>Ft,getVersion:()=>Pt,helConsts:()=>ut,helEvents:()=>st,helLoadStatus:()=>ct,inectPlatToMod:()=>lt,initGlobalConfig:()=>er,initPlatformConfig:()=>Zt,isSubApp:()=>ft,libReady:()=>ar,log:()=>bt,originInit:()=>$t,perfMark:()=>yt,perfPeek:()=>At,resetGlobalThis:()=>dt,setAppMeta:()=>wt,setAppPlatform:()=>Xt,setAppPlatformByAppName:()=>zt,setAppStyleStr:()=>Bt,setCommonData:()=>Vt,setCustomData:()=>Mt,setEmitApp:()=>It,setEmitLib:()=>Tt,setGlobalThis:()=>Lt,setVerExtraCssList:()=>Kt,setVerLoadStatus:()=>jt,setVerStyleStrStatus:()=>Ut,setVersion:()=>Ot,tryGetAppName:()=>Wt,tryGetVersion:()=>Yt});var p=null;function f(){return p||function(){if("undefined"==typeof window){if("undefined"==typeof globalThis)throw new Error("unable to locate global object");p=globalThis}else p=window}(),p}function d(){return f()}function v(){var e=f();return e.MutationObserver||e.WebKitMutationObserver||e.MozMutationObserver}function h(e,t){for(var r=null,n=e.length,a=0;a<n;a++){var o=e[a];if(o.tagName===t){r=o;break}}return r}function m(e){return Object.keys(e)}function g(e){var t,r=null===(t=f())||void 0===t?void 0:t.localStorage;return null==r?void 0:r.getItem(e)}function b(e,t){var r,n=null===(r=f())||void 0===r?void 0:r.localStorage;return null==n?void 0:n.setItem(e,t)}function y(){var e=function(){var e=function(e){var t=e||{},r=t.search||"";if(!r){var n=(t.hash||"").split("?")[1]||"";n&&(r="?".concat(n))}return r};try{var t;return e(null===(t=f())||void 0===t||null===(t=t.top)||void 0===t?void 0:t.location)}catch(n){var r;return e(null===(r=f())||void 0===r?void 0:r.location)}}(),t={};null!=e&&e.startsWith("?")&&e.substring(1).split("&").forEach(function(e){var r=s(e.split("="),2),n=r[0],a=r[1];t[n]=a});return t}function A(){var e="";try{throw new Error("getJsRunLocation")}catch(n){var t=n.stack.split("\n"),r=t.length;e=t[r-1]||t[r-2]||""}return e}function _(e,t,r,n){S(e,t)[r]=n}function S(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=e[t];return n||(n=r,e[t]=n),n}function L(e,t){Object.keys(t).forEach(function(r){var n=t[r];[null,void 0,""].includes(n)||(e[r]=n)})}function E(e,t){e.includes(t)||e.push(t)}function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.nullValues,n=void 0===r?[null,void 0,""]:r,a=t.emptyObjIsNull,o=void 0===a||a,i=t.emptyArrIsNull,s=void 0===i||i;if(n.includes(e))return!0;if(Array.isArray(e))return!!s&&0===e.length;if("object"===u(e)){var c=m(e).length;return!!o&&0===c}return!1}function C(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t}var T=I,N=E,w=m;function P(e,t){var r=t||function(e){return!T(e)},n={};return w(e).forEach(function(t){r(e[t])&&(n[t]=e[t])}),n}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MULTI",r=e.split("\n"),n=r.length-1,a=r.map(function(e,r){var a;if(!e&&(0===r||r===n))return"";var o=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=e;return e.endsWith("<br/>")?(n=e.substring(0,n.length-5),"".concat(n).concat(t)):"".concat(n).concat(r)},i=(null===(a=e.trimStart)||void 0===a?void 0:a.call(e))||e;return"MULTI"===t?"".concat(o(i,""),"\n"):i=o(i,"\n"," ")}).join("");return a}function D(e){return O(e,"ONE")}function M(e,t,r){e.dataset?e.dataset[t]=r:e.setAttribute("data-".concat(t),r)}function x(e){M(e,"heldisabled","1"),e.disabled=!0}var V=Object.freeze({__proto__:null,noop:C,hasProp:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},isServer:function(){var e=f();return e.process&&e.global&&!e.document},safeParse:function(e,t,r){if(e&&"string"!=typeof e)return e;try{return JSON.parse(e)||t}catch(n){if(void 0!==t)return t;if(r)throw new Error(r);throw n}},isNull:T,noDupPush:N,okeys:w,merge2List:function(e,t){var r=[];return e.forEach(function(e){return N(r,e)}),t.forEach(function(e){return N(r,e)}),r},purify:P,getObjsVal:function(e,t,r){var n,a=r,o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=l(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}(e);try{for(o.s();!(n=o.n()).done;){var i=n.value[t];if(![null,void 0,""].includes(i)){a=i;break}}}catch(s){o.e(s)}finally{o.f()}return a},pfstr:O,nbstr:D,nbalert:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=f(),a=D(e),o=n.alert||C;r?(null===(t=n.location)||void 0===t?void 0:t.port)&&o(a):o(a)},setDataset:M,disableNode:x});var k="unpkg",R="__default_online_ver__",j=k,F={CORE_VER:"4.13.1",DEFAULT_API_PREFIX:"https://unpkg.com",DEFAULT_API_URL:"/openapi/v1/app/info",DEFAULT_ONLINE_VER:R,DEFAULT_USER_LS_KEY:"HelUserRtxName",DEFAULT_PLAT:j,LS_LOG_MODE:"HelConfig.logMode",LS_LOG_FILTER:"HelConfig.logFilter",PLAT_HEL:"hel",PLAT_UNPKG:k,KEY_CSS_STR:"CSS_STR",KEY_ASSET_CTX:"ASSET_CTX",KEY_STYLE_TAG_ADDED:"STYLE_TAG_ADDED",KEY_CSS_LINK_TAG_ADDED:"CSS_LINK_TAG_ADDED",KEY_IGNORE_CSS_PREFIX_LIST:"IGNORE_CSS_PREFIX_LIST",KEY_IGNORE_STYLE_TAG_KEY:"IGNORE_STYLE_TAG_KEY",KEY_IGNORE_CSS_PREFIX_2_KEYS:"IGNORE_CSS_PREFIX_2_KEYS"},U={SUB_APP_LOADED:"subAppLoaded",SUB_LIB_LOADED:"SubLibLoaded",STYLE_STR_FETCHED:"StyleStrFetched",STYLE_TAG_ADDED:"StyleTagAdded",CSS_LINK_TAG_ADDED:"CssLinkTagAdded"},G={NOT_LOAD:0,LOADING:1,LOADED:2},B=F.LS_LOG_FILTER,H=F.LS_LOG_MODE,K=0,Y=1,W=2,J={isIncludeFilter:function(e,t){return t.includes(",")?t.split(",").some(function(t){return e.includes(t)}):e.includes(t)},getLogFilter:function(){return Q().logFilter},setLogFilter:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Q().logFilter=e,t&&b(B,e)},setLogMode:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=parseInt(e,10);[K,Y,W].includes(r)&&(Q().logMode=r,t&&b(H,r))},getLogMode:function(){return Q().logMode}},q={};function X(){if(I(q=d().__HEL_MICRO_DEBUG__)){q={logMode:K,logFilter:"",isInit:!1},d().__HEL_MICRO_DEBUG__=q;try{!function(){if(!Q().isInit){Q().isInit=!0;var e=y(),t=e.hellog,r=e.hellogf,n=t||g(H)||K;J.setLogMode(n,!1);var a=r||g(B)||"";J.setLogFilter(a,!1)}}()}catch(e){}}else void 0===q.logMode&&(q.logMode=K,q.logFilter="")}function z(){return J.getLogMode()!==K}function Q(){return q}var Z="  %c--\x3e HEL LOG:",$="color:#ad4e00;font-weight:600";function ee(){if(z()){for(var e=J.getLogMode()===Y?console.log:console.trace||console.log,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],o=r.slice(1);if("string"!=typeof a)return e.apply(void 0,[Z,$].concat(r));var i=J.getLogFilter(),s=["".concat(Z," ").concat(a),$].concat(c(o));i?J.isIncludeFilter(a,i)&&e.apply(void 0,c(s)):e.apply(void 0,c(s))}}var te={};function re(e,t,r){if(z()&&te[e]){var n=te[e];ee("[[ PerfCheck ]] (".concat(e,"/").concat(t,") costs ").concat(Date.now()-n," ms")),r&&ne(e)}}function ne(e){te[e]=0}var ae=F.DEFAULT_API_URL,oe=F.DEFAULT_USER_LS_KEY,ie=F.PLAT_HEL,se=F.PLAT_UNPKG,ce=F.DEFAULT_API_PREFIX,ue=F.CORE_VER,le=F.KEY_CSS_LINK_TAG_ADDED,pe=F.KEY_STYLE_TAG_ADDED,fe=F.KEY_IGNORE_CSS_PREFIX_LIST,de=F.KEY_IGNORE_STYLE_TAG_KEY,ve=F.KEY_IGNORE_CSS_PREFIX_2_KEYS;function he(e){return{apiMode:"get",apiPrefix:(e||{}).apiPrefix,apiSuffix:"",apiPathOfApp:ae,apiPathOfAppVersion:"",getSubAppAndItsVersionFn:null,customMetaUrl:"",customMetaJsonpUrl:"",getMeta:null,onFetchMetaFailed:null,strictMatchVer:!0,getUserName:null,userLsKey:oe,shouldUseGray:null,trustAppNames:null,semverApi:null,hook:{}}}function me(e){return i(i({isConfigOverwrite:!1,platform:e,appName2Comp:{},appName2Lib:{},appName2isLibAssigned:{},appName2EmitApp:{},appName2verLoadStatus:{},appName2verEmitLib:{},appName2verEmitApp:{},appName2verStyleStr:{},appName2verStyleFetched:{},appName2verExtraCssList:{},appName2verAppVersion:{},appName2verCustomData:{},appName2app:{},appName2appVersion:{},appName2styleStr:{},appGroupName2firstVer:{},isOriginInitCalled:!1},he()),{},{origin:he({apiPrefix:ce})})}function ge(){var e={};return{on:function(t,r){var n=e[t];if(!n){var a=[];e[t]=a,n=a}n.push(r)},emit:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];var o=e[t];o&&o.slice().forEach(function(e){return e.apply(void 0,n)})},off:function(t,r){var n=e[t];if(n)for(var a=0,o=n.length;a<o;a++){if(n[a]===r){n.splice(a,1);break}}}}}function be(e){[le,pe,fe,de,ve].forEach(function(t){return S(e,t,function(e){return e===fe?[]:{}}(t))})}function ye(){var e=Ae();if(e){var t=e.cacheRoot;S(t,"appGroupName2platform"),S(t,"common");var r=t.caches;return Object.keys(r).forEach(function(e){var t=r[e];S(t,"appGroupName2firstVer"),S(t,"appName2isLibAssigned"),S(t,"appName2verExtraCssList"),S(t,"appName2verCustomData"),S(t,"hook"),S(t,"origin",he()),S(t.origin,"hook")}),be(t.common),void(e.userEventBus||(e.userEventBus=ge()))}e=function(){var e=me(se),t=me(ie),r={platform:ie,platformHint:"the platform value here does not make any sense!",appName2platform:{},appGroupName2platform:{},caches:a(a({},se,e),ie,t),common:{}},n=ge(),o=ge();return{ver:ue,isStyleObInit:!1,nativeHeadAppend:null,nativeBodyAppend:null,patchedHeadAppend:null,patchedBodyAppend:null,createFeature:A(),eventBus:n,userEventBus:o,cacheRoot:r,unpkgCache:e,helCache:t,dev:{setLogMode:J.setLogMode,setLogFilter:J.setLogFilter}}}(),be(e.cacheRoot.common),d().__HEL_MICRO_SHARED__=e}function Ae(){return d().__HEL_MICRO_SHARED__}function _e(){return j}function Se(e){var t=e||_e(),r=Le(),n=r.caches[t];if(!n){var a=u(e);if("string"!==a)throw console.error("invalid plaform:",e),new Error("fatal error: platform only can be a string, now it is ".concat(a));var o=me(e);r.caches[t]=o,n=o}return n}function Le(){return Ae().cacheRoot}var Ee={getCustomData:function(e,t,r){var n=r.versionId,a=S(Se(r.platform).appName2verCustomData,e);return S(a,t)[n||R]},getAppMeta:function(e,t){return Se(t).appName2app[e]},setVerLoadStatus:function(e,t,r,n){var a=n||{},o=a.versionId;_(Se(a.platform)[r],e,o||R,t)},getVerLoadStatus:function(e,t,r){var n,a=r||{},o=a.versionId,i=Se(a.platform)[t],s=o||R;return(null===(n=i[e])||void 0===n?void 0:n[s])||G.NOT_LOAD},ensureOnlineModule:function(e,t,r){if(!e[R]){var n=Ee.getAppMeta(t,r),a=e[null==n?void 0:n.online_version];a&&(e[R]=a)}}};function Ie(e,t){ee("[[ core:setEmitApp ]] appName,emitApp:",e,t);var r=t.versionId,n=Se(t.platform),a=n.appName2verEmitApp,o=n.appName2Comp,i=n.appName2EmitApp;S(a,e)[R]||(o[e]=t.Comp,i[e]=t,_(a,e,R,t)),r&&_(a,e,r,t)}var Ce=F.KEY_CSS_LINK_TAG_ADDED,Te=F.KEY_STYLE_TAG_ADDED,Ne=F.KEY_IGNORE_CSS_PREFIX_LIST,we=F.KEY_IGNORE_STYLE_TAG_KEY,Pe=F.KEY_IGNORE_CSS_PREFIX_2_KEYS;function Oe(e){return S(Le().common,e)}function De(e){return Le().common[e]}function Me(e,t){var r=Oe(e)[t];return void 0!==r?r:null}function xe(e,t,r){Oe(e)[t]=r}var Ve={setIgnoreCssPrefix:function(e){E(De(Ne),e)},setIgnoreStyleTagKey:function(e){Ve.getIgnoreStyleTagMap()[e]=1},getIgnoreStyleTagMap:function(){return De(we)},setIgnoreCssPrefixKey:function(e,t){var r=Me(Pe,e);r||xe(Pe,e,r=[]),E(r,t)},getIgnoreCssPrefixKeys:function(e){return De(Pe)[e]||[]},getMatchedIgnoreCssPrefix:function(e){for(var t=De(Ne),r="",n=0;n<t.length;n++){var a=t[n];if(e.startsWith(a)){r=a;break}}return r},getIgnoreCssPrefixCssUrlList:function(e){var t=Me(Ce,e);return t||xe(Ce,e,t=[]),t},setIgnoreCssPrefixCssUrl:function(e,t){Ve.getIgnoreCssPrefixCssUrlList(e).push(t)},getStyleTagText:function(e){return Me(Te,e)||""},clearStyleTagText:function(e){xe(Te,e,"")},appendStyleTagText:function(e,t){var r=Ve.getStyleTagText(e);xe(Te,e,"".concat(r," ").concat(t))}};function ke(e,t){var r=e.apiMode,n=e.apiPrefix,a=e.apiSuffix,o=e.apiPathOfApp,i=e.apiPathOfAppVersion,s=e.getSubAppAndItsVersionFn,c=e.onFetchMetaFailed,u=e.strictMatchVer,l=e.getUserName,p=e.userLsKey,f=e.shouldUseGray,d=e.getApiPrefix,v=e.trustAppNames,h=e.platform,m=e.origin,g={apiMode:r,apiPrefix:n,apiSuffix:a,apiPathOfApp:o,apiPathOfAppVersion:i,getSubAppAndItsVersionFn:s,onFetchMetaFailed:c,strictMatchVer:u,getUserName:l,userLsKey:p,shouldUseGray:f,getApiPrefix:d,trustAppNames:v,hook:e.hook,platform:h,customMetaUrl:e.customMetaUrl,customMetaJsonpUrl:e.customMetaJsonpUrl,getMeta:e.getMeta};return t&&(g.origin=m),g}function Re(e){return Le().appGroupName2platform[e]||_e()}function je(e){return Le().appName2platform[e]||_e()}function Fe(e,t){var r=t.customKey,n=t.platform,a=S(Se(void 0===n?je(e):n).appName2verCustomData,e);return S(a,r)}var Ue=U.STYLE_TAG_ADDED,Ge=U.CSS_LINK_TAG_ADDED;function Be(){return Ae().eventBus}var He={styleTagAdded:function(e){return"".concat(Ue,"/").concat(e)},cssLinkTagAdded:function(e){return"".concat(Ge,"(").concat(e,")")}};function Ke(e,t,r){var n=(r||{}).appGroupName,a=t.versionId,o=t.appProperties,i=t.platform||r.platform,s=Se(i),c=s.appName2verEmitLib,l=s.appName2Lib,p=s.appName2isLibAssigned,f=Ee.getAppMeta(e,i),d=function(e){var t=l[e];t?"object"===u(t)&&0===Object.keys(t).length&&Object.assign(t,o):l[e]=o,p[e]=!0};d(e),n?d(n):f&&d(f.app_group_name),ee("[[ core:setEmitLib ]] appMeta:",f),S(c,e)[R]||_(c,e,R,o),a&&_(c,e,a,o)}function Ye(e,t){return Se(t).appName2app[e]}function We(e,t,r){Ee.setVerLoadStatus(e,t,"appName2verLoadStatus",r)}function Je(e,t){return e.split("@").slice(1).join("@")||t||e}function qe(e){return"js"===e||"mjs"===e}function Xe(e,t){var r=A();ee("[[ core:tryGetVersion ]] may include ver source > ".concat(r));var n=Se(t).appGroupName2firstVer[e]||"";if(r.includes("https://")||r.includes("http://")){var a=s(r.split("//"),2)[1],o=a.split("/");if(n){if(a.includes("/".concat(n,"/"))){if(n.startsWith("@"))return Je(n.split("/")[1]||"");var i=o.indexOf(n);if(!o[i-1].startsWith("@"))return Je(n)}var c=o[1],u=o[2];if("static"===c&&qe(u)||qe(c))return Je(n)}if(a.indexOf("@")>=0){var l=o.filter(function(e){return e.includes("@")}),p=l.findIndex(function(e){return e.startsWith("@")});return Je(p>=0?l[p+1]||"":l[0]||"",n)}var f=s(a.split("/".concat(t,"/")),2)[1];return s((void 0===f?"":f).split("/"),1)[0]||n}return n}function ze(e,t){return e===R?t||"":e.includes("_")?e.substring(0,e.length-15):t||""}var Qe=!1,Ze=!1;var $e=F.KEY_ASSET_CTX;function et(e,t){if(!t||!["LINK","SCRIPT"].includes(t.tagName))return e(t);var r=t.href,n=t.tagName,a=t.src,o="LINK"===n,i=Me($e,r||a||"")||{},s=i.platform,c=i.groupName,u=i.name,l=i.ver,p=i.beforeAppend,f=t;if(p){var d=o?"href":"src",v=t.getAttribute(d);f=p({el:t,nativeAppend:e,setAssetUrl:function(e){return t.setAttribute(d,e)},url:v,tagName:n})||t}return s&&function(e,t){var r=t.platform,n=t.groupName,a=t.name,o=t.ver;M(e,"el",t.elName),M(e,"plat",r),M(e,"gname",n),M(e,"name",a),M(e,"ver",o)}(f,{platform:s,groupName:c,name:u,ver:l,elName:o?"HelLink":"HelScript"}),e(f)}var tt="preFetch";var rt="/* @helstart ",nt=" @helend */",at=rt.length;function ot(e,t){var r=e.tagName,n=e.innerText,a=e.href;if(["STYLE","LINK"].includes(r))if("STYLE"!==r){var o=function(e,t){var r=Be(),n=Ve.getMatchedIgnoreCssPrefix(t);return n&&(Ve.setIgnoreCssPrefixCssUrl(n,t),r.emit(He.cssLinkTagAdded(n),{nodes:[e]})),n}(e,a);o&&x(e)}else{if(!n)return;var i=n.indexOf(rt);if(i<0)return;var s=n.indexOf(nt);if(s<0)return;var c=n.substring(at+i,s);if(c){var u=c.trim(),l="",p=u;if(u.includes("/")){var f=u.split("/");l=f[0],p=f[1]}M(e,"gname",p),l&&M(e,"plat",l),t[u]&&x(e);var d=Be();Ve.appendStyleTagText(u,n),d.emit(He.styleTagAdded(u),{nodes:[e]})}}}function it(e,t){var r=e.tagName,n=e.src,a=void 0===n?"":n;if("SCRIPT"!==r)return!1;if(!a.endsWith(".hot-update.js"))return!1;var o=Ve.getMatchedIgnoreCssPrefix(a);if(!o)return!1;var i=Ve.getIgnoreCssPrefixKeys(o);if(!i.length)return!1;var s=!1;return i.forEach(function(e){t[e]&&(!function(e){var t=f();if(t){var r=t.document.head.querySelectorAll('style[data-gname="'.concat(e,'"]'));r.length&&(Ve.clearStyleTagText(e),r.forEach(function(t){x(t),Ve.appendStyleTagText(e,t.innerText)}),Be().emit(He.styleTagAdded(e),{nodes:r}))}}(e),s=!0)}),s}dt(),ee("hel-micro-core ver ".concat(F.CORE_VER));var st=U,ct=G,ut=F,lt=function e(t,r,n){var a=n||{},o=a.ignoreKeys,s=void 0===o?[]:o,c=a.arg1PlatObjFnKeys,l=void 0===c?[]:c,p={};return Object.keys(r).forEach(function(a){var o=r[a];if(s.includes(a))p[a]=o;else{var c=u(o);p[a]=c&&"object"===c?e(t,o,n):"function"!==c?o:function(e,t){var r=this,n=t.fn,a=t.fnName,o=t.arg1PlatObjFnKeys.includes(a);return function(){for(var t=function(t){return i({platform:e},P(t||{}))},a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];var u=s[0],l=s[1];return o?s[0]=t(u):s[1]=t(l),n.apply(r,s)}}(t,{arg1PlatObjFnKeys:l,fn:o,fnName:a})}}),p},pt=V,ft=function(){return console.log("%c".concat("WARNING: calling isSubApp is unsafe, use hel-iso.isSubApp instead,\nmore details see: https://tnfe.github.io/hel/docs/tutorial/attention-is-subapp"),"color:red;"),!Qe};function dt(e){e&&Lt(e),function(e){if(e&&(Qe=!1,Ze=!1),!Ze){Ze=!0;var t=f();void 0===t.__MASTER_APP_LOADED__&&(t.__MASTER_APP_LOADED__=!0,Qe=!0)}}(!!e),ye(),X(),function(){var e=f();if(!e.__POWERED_BY_QIANKUN__&&!e.__DISABLE_HEL_MONKEY_PATCH__){var t=Ae(),r=e.document,n=t.nativeHeadAppend,a=t.nativeBodyAppend;if(!n&&r){var o=r.head,i=r.body;if(n=o.appendChild.bind(o),t.nativeHeadAppend=n,i)a=i.appendChild.bind(i),t.nativeBodyAppend=a;else{var s=new(v())(function(e){for(var r,n=0;n<e.length;n++){var o=e[n].addedNodes;if(r=h(o,"BODY"))break}r&&(a=r.appendChild.bind(r),t.nativeBodyAppend=a,r.appendChild=function(e){return et(u(a,r,"body"),e)},s.disconnect())}),c=h(r.childNodes,"HTML");c&&s.observe(c,{childList:!0})}var u=function(r,n,a){var o=t.patchedHeadAppend,i=t.patchedBodyAppend,s="head"===a;if(o&&s)return o;if(i&&!s)return i;if(e.__POWERED_BY_WUJIE__)return r;var c=e.Element;return c?c.prototype.appendChild.bind(n):r};o.appendChild=function(e){return et(u(n,o,"head"),e)},i&&(i.appendChild=function(e){return et(u(a,i,"body"),e)})}}}(),function(){var e=Ae(),t=f(),r=e.isStyleObInit,n=t.document;if(!r&&n){e.isStyleObInit=!0;var a=Ve.getIgnoreStyleTagMap(),o=v();o&&new o(function(e){e.forEach(function(e){for(var t=e.addedNodes,r=e.removedNodes,n=t.length,o=0;o<n;o++)ot(t[o],a);for(var i=r.length,s=0;s<i&&!it(r[s],a);s++);})}).observe(document.head,{childList:!0})}}()}var vt=_e,ht=Se,mt=Q,gt=z,bt=ee,yt=function(e){z()&&!te[e]&&(te[e]=Date.now())},At=re,_t=ne,St=f,Lt=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null;null!==(t=p)&&void 0!==t&&t.__HEL_MICRO_SHARED__&&(n=p.__HEL_MICRO_SHARED__),p=r?i(i({},p),e):e,n&&(p.__HEL_MICRO_SHARED__=n)},Et=function(e,t){var r,n=t||{},a=n.versionId,o=n.platform,i=Se(o),s=i.appName2verEmitApp,c=i.appName2Comp,u=i.strictMatchVer,l=i.appName2EmitApp,p=null!==(r=n.strictMatchVer)&&void 0!==r?r:u,f=S(s,e);Ee.ensureOnlineModule(f,e,o);var d=f[a||R],v=c[e],h=v?{Comp:v}:null,m=p?null:l[e]||h,g=d||m||null;return ee("[[ core:getVerApp ]] appName,options,result:",e,n,g),g},It=Ie,Ct=function(e,t){var r,n=t||{},a=n.versionId,o=Se(n.platform),i=o.appName2verEmitLib,s=o.appName2Lib,c=o.strictMatchVer,u=o.appName2isLibAssigned,l=null!==(r=n.strictMatchVer)&&void 0!==r?r:c,p=S(i,e);Ee.ensureOnlineModule(p,e);var f=p[a||R],d=u[e]?s[e]:null,v=f||(l?null:d)||null;return ee("[[ core:getVerLib ]] appName,options,result:",e,n,v),v},Tt=Ke,Nt=Ye,wt=function(e,t){Se(t).appName2app[e.name]=e},Pt=function(e,t){var r,n=t||{},a=n.platform,o=n.versionId,i=Se(a),s=i.appName2verAppVersion,c=i.appName2appVersion[e]||null;return o&&(null===(r=s[e])||void 0===r?void 0:r[o])||c},Ot=function(e,t,r){var n=(r||{}).platform,a=Se(n),o=a.appName2verAppVersion,i=a.appGroupName2firstVer,s=a.appName2appVersion,c=t.version_tag||t.sub_app_version;if(c){var u=Ee.getAppMeta(e,n);S(o,e)[R]||(_(o,e,R,t),s[e]=t),_(o,e,c,t),i[u.app_group_name]=t.sub_app_version}},Dt=function(e,t){var r=Fe(e,t)[t.versionId||R];return void 0!==r?r:null},Mt=function(e,t){var r=t.customValue,n=t.versionId,a=Fe(e,t);a[n||R]=r,a[R]||(a[R]=r)},xt=Me,Vt=xe,kt=Ve,Rt=function(e,t){return Ee.getVerLoadStatus(e,"appName2verLoadStatus",t)},jt=We,Ft=function(e,t){return Ee.getVerLoadStatus(e,"appName2verStyleFetched",t)},Ut=function(e,t,r){Ee.setVerLoadStatus(e,t,"appName2verStyleFetched",r)},Gt=function(e,t){var r,n=t||{},a=n.platform,o=n.versionId,i=Se(a),s=i.appName2verStyleStr,c=i.appName2styleStr[e]||"";return o?(null===(r=s[e])||void 0===r?void 0:r[o])||c||"":c},Bt=function(e,t,r){var n=r||{},a=n.platform,o=n.versionId,i=Se(a),s=i.appName2verStyleStr,c=i.appName2verStyleFetched,u=i.appName2styleStr;o?(_(s,e,o,t),_(c,e,o,G.LOADED)):u[e]=t},Ht=function(e,t){var r=t||{},n=r.versionId,a=S(Se(r.platform).appName2verExtraCssList,e),o=a[n]||a[R]||[];return ee("[[ core:getVerExtraCssList ]] options,cssList:",r,o),o},Kt=function(e,t,r){var n=r||{},a=n.versionId,o=Se(n.platform).appName2verExtraCssList;ee("[[ core:setVerExtraCssList ]] cssList:",t),S(o,e)[R]||_(o,e,R,t),a&&_(o,e,a,t)},Yt=Xe,Wt=ze,Jt=function(e){return ke(Se(e),!0)},qt=Re,Xt=function(e,t,r){var n=Le().appGroupName2platform;return!r&&n[e]||(n[e]=t),Re(e)},zt=function(e,t,r){var n=Le().appName2platform;return!r&&n[e]||(n[e]=t),je(e)},Qt=je,Zt=function(e,t){var r=Se(t),n=ke(e);r.isConfigOverwrite||(r.isConfigOverwrite=!0,L(r,n))},$t=function(e,t){var r=Se(e),n="[[ core:originInit ]] invalid call, it can only been called";if(r.isConfigOverwrite)ee("".concat(n," before init"));else if(r.isOriginInitCalled)ee("".concat(n," one time"));else{var a=ke(t);r.isOriginInitCalled=!0,L(r.origin,a)}},er=function(e){var t=Ae(),r=t.nativeHeadAppend,n=t.nativeBodyAppend,a=e.headAppend||null,o=e.bodyAppend||null,i=function(e){return"pass same ".concat(e," handle, hel will ignore it for avlid 'Maximum call stack size exceeded'")};a&&a===r?console.error(i("headAppend")):t.patchedHeadAppend=a,o&&o===n?console.error(i("bodyAppend")):t.patchedBodyAppend=o},tr=Be,rr=function(){return Ae().userEventBus},nr=He,ar=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.platform||Re(e),a=r.versionId||Xe(e,n),o=r.appName||ze(a,e);ee("[[ core:libReady ]] appGroupName ".concat(e,", appName ").concat(o,", versionId ").concat(a));var i=Ye(o,n);null!=i&&i.__fromCust&&(a=r.versionId||i.online_version,o=i.name,ee("[[ core:libReady ]] fromCust, appGroupName ".concat(e,", appName ").concat(o,", versionId ").concat(a)));var s={platform:n,appName:o,appGroupName:e,versionId:a,appProperties:t,Comp:function(){},lifecycle:{}};Ke(o,s,{appGroupName:e,platform:n}),We(o,G.LOADED,{versionId:a,platform:n});var c=Be();re(tt,"libReady"),c.emit(U.SUB_LIB_LOADED,s)},or=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.lifecycle,a=r.platform||Re(e),o=r.versionId||Xe(e,a),i=r.appName||ze(o,e),s={Comp:t,appName:i,appGroupName:e,lifecycle:n,platform:a,versionId:o,isLib:!1};Ie(i,s),We(i,G.LOADED,{versionId:o,platform:a});var c=Be();re(tt,"appReady"),c.emit(U.SUB_APP_LOADED,s)}},3127:function(e,t,r){!function(e,t){"use strict";function r(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}}),t.default=e,Object.freeze(t)}var n=r(t),a=function(){return a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},a.apply(this,arguments)};function o(e,r){var n=r||(null===t.getAppPlatform||void 0===t.getAppPlatform?void 0:t.getAppPlatform(e)),a=t.getSharedCache(n).appName2Lib;return a[e]||(a[e]={}),a[e]}var i="4.12.1";n.log("hel-lib-proxy ver ".concat(i));var s=n.getUserEventBus,c=n.helConsts,u=s();function l(e,t){var r=a({},t||{});return r.platform=c.DEFAULT_PLAT,n.getVerLib(e,r)}function p(e,r){var a,i=!0,s="";r&&("string"==typeof r?s=r:(s=r.platform||"",i=null===(a=r.asProxy)||void 0===a||a));var u=o(e,s=s||n.getAppPlatform(e)||c.DEFAULT_PLAT);return"function"==typeof Proxy&&i&&(u=function(e,r,n){return new Proxy(r,{get:function(r,a){var i=String(a);return t.log("[[getLibProxy]] call lib [".concat(e,"] method [").concat(i,"]")),Object.keys(r).length?r[i]:o(e,n)[i]}})}(e,u,s)),n.log("[[ exposeLib ]] libName, libObj",e,u),u}function f(e,r,o){var i=function(e){var r={allowDup:!1,platform:t.helConsts.DEFAULT_PLAT};return a(a({},r),e||{})}(o);n.libReady(e,r,i)}function d(e,t,r){n.appReady(e,t,r)}function v(e,t){return n.getVerApp(e,t)}var h=n.isSubApp;function m(){return!n.isSubApp()}var g=Object.freeze({__proto__:null,VER:i,eventBus:u,getLib:l,exposeLib:p,libReady:f,appReady:d,exposeApp:v,isSubApp:h,isMasterApp:m}),b=t.commonUtil.purify,y=["isMasterApp","isSubApp","eventBus"],A=["appReady","libReady"];function _(e,t){return t&&"object"==typeof t?a({platform:e},b(t)):t}function S(e,t){var r={};return Object.keys(e).forEach(function(n){var a=e[n];if(y.includes(n))r[n]=a;else if(A.includes(n))r[n]=function(e,t){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var a=r[0],o=r[1],i=r[2];return e(a,o,_(t,void 0===i?{}:i))}}(a,t);else{var o="exposeLib"===n;r[n]=function(e,t,r){return function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];var o=n[0],i=n[1];return e(o,!r||"string"!=typeof i&&void 0!==i?_(t,i):i||t)}}(a,t,o)}}),r}var L=function e(t){var r=S(g,t);return r.createInstance=e,r},E=i,I=f,C=p,T=l,N=h,w=m,P=u,O=d,D=v,M={VER:E,libReady:I,exposeLib:C,getLib:T,isSubApp:N,isMasterApp:w,eventBus:P,appReady:O,exposeApp:D,createInstance:L};!function(e){var r=t.getGlobalThis();t.commonUtil.isServer()||r.HelLibProxy||(t.log("auto bind hel-lib-proxy to global.HelLibProxy"),r.HelLibProxy=e)}(M),e.VER=E,e.appReady=O,e.createInstance=L,e.default=M,e.eventBus=P,e.exposeApp=D,e.exposeLib=C,e.getLib=T,e.isMasterApp=w,e.isSubApp=N,e.libReady=I,Object.defineProperty(e,"__esModule",{value:!0})}(t,r(2917))}}]);