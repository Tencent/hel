/*! For license information please see 7123.75c5a63a.js.LICENSE.txt */
"use strict";(self.webpackChunkhel_doc=self.webpackChunkhel_doc||[]).push([[7123],{7123:(e,t,r)=>{r.r(t),r.d(t,{VER:()=>Ta,appMetaSrv:()=>Va,appParamSrv:()=>xa,appStyleSrv:()=>Da,batchPreFetchLib:()=>wa,bindExternals:()=>Ha,bindReactRuntime:()=>Ua,bindVueRuntime:()=>Ka,core:()=>Ya,createInstance:()=>Xa,createOriginInstance:()=>qa,default:()=>za,emitApp:()=>Ra,eventBus:()=>Ja,getExtraData:()=>Ga,getFakeHelContext:()=>ja,init:()=>Fa,isSubApp:()=>ka,logicSrv:()=>Ma,preFetchApp:()=>Oa,preFetchLib:()=>Pa,resetGlobalThis:()=>Wa,setExtraData:()=>Ba});var n={};function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,s=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(l){u=!0,a=l}finally{try{if(!c&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.r(n),r.d(n,{allowLog:()=>pt,appReady:()=>qt,commonDataUtil:()=>Ct,commonUtil:()=>it,evName:()=>Wt,getAppMeta:()=>_t,getAppPlatform:()=>jt,getAppStyleStr:()=>Dt,getCommonData:()=>It,getCustomData:()=>St,getGlobalThis:()=>dt,getHelDebug:()=>lt,getHelEventBus:()=>Ut,getPlatform:()=>ct,getPlatformConfig:()=>kt,getSharedCache:()=>ut,getUserEventBus:()=>Yt,getVerApp:()=>ht,getVerExtraCssList:()=>Vt,getVerLib:()=>gt,getVerLoadStatus:()=>Tt,getVerStyleStrStatus:()=>Ot,getVersion:()=>At,helConsts:()=>nt,helEvents:()=>tt,helLoadStatus:()=>rt,inectPlatToMod:()=>at,initGlobalConfig:()=>Kt,initPlatformConfig:()=>Bt,isSubApp:()=>ot,libReady:()=>Xt,log:()=>ft,originInit:()=>Ht,resetGlobalThis:()=>st,setAppMeta:()=>yt,setAppPlatform:()=>Gt,setAppStyleStr:()=>xt,setCommonData:()=>Nt,setCustomData:()=>Lt,setEmitApp:()=>mt,setEmitLib:()=>bt,setGlobalThis:()=>vt,setVerExtraCssList:()=>Mt,setVerLoadStatus:()=>Pt,setVerStyleStrStatus:()=>wt,setVersion:()=>Et,tryGetAppName:()=>Ft,tryGetVersion:()=>Rt});var f=null;function d(){return f||function(){if("undefined"==typeof window){if(void 0===r.g)throw new Error("unable to locate global object");f=r.g}else f=window}(),f}function v(){return d()}function h(){var e=d();return e.MutationObserver||e.WebKitMutationObserver||e.MozMutationObserver}function m(e,t){for(var r=null,n=e.length,a=0;a<n;a++){var i=e[a];if(i.tagName===t){r=i;break}}return r}function g(e){return Object.keys(e)}function b(e){var t,r=null===(t=d())||void 0===t?void 0:t.localStorage;return null==r?void 0:r.getItem(e)}function _(e,t){var r,n=null===(r=d())||void 0===r?void 0:r.localStorage;return null==n?void 0:n.setItem(e,t)}function y(){var e=function(){var e=function(e){var t=e||{},r=t.search||"";if(!r){var n=(t.hash||"").split("?")[1]||"";n&&(r="?".concat(n))}return r};try{var t,r;return e(null===(t=d())||void 0===t||null===(r=t.top)||void 0===r?void 0:r.location)}catch(a){var n;return e(null===(n=d())||void 0===n?void 0:n.location)}}(),t={};null!=e&&e.startsWith("?")&&e.substring(1).split("&").forEach((function(e){var r=c(e.split("="),2),n=r[0],a=r[1];t[n]=a}));return t}function A(){var e="";try{throw new Error("getJsRunLocation")}catch(n){var t=n.stack.split("\n"),r=t.length;e=t[r-1]||t[r-2]||""}return e}function E(e,t,r,n){S(e,t)[r]=n}function S(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=e[t];return n||(n=r,e[t]=n),n}function L(e,t){Object.keys(t).forEach((function(r){var n=t[r];[null,void 0,""].includes(n)||(e[r]=n)}))}function I(e,t){e.includes(t)||e.push(t)}function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.nullValues,n=void 0===r?[null,void 0,""]:r,a=t.emptyObjIsNull,i=void 0===a||a,s=t.emptyArrIsNull,c=void 0===s||s;if(n.includes(e))return!0;if(Array.isArray(e))return!!c&&0===e.length;if("object"===o(e)){var u=g(e).length;return!!i&&0===u}return!1}function C(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t}var T=N,P=I,O=g;function w(e,t){var r=t||function(e){return!T(e)},n={};return O(e).forEach((function(t){r(e[t])&&(n[t]=e[t])})),n}function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MULTI",r=e.split("\n"),n=r.length-1,a=r.map((function(e,r){var a;if(!e&&(0===r||r===n))return"";var i=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=e;return e.endsWith("<br/>")?(n=e.substring(0,n.length-5),"".concat(n).concat(t)):"".concat(n).concat(r)},o=(null===(a=e.trimStart)||void 0===a?void 0:a.call(e))||e;return"MULTI"===t?"".concat(i(o,""),"\n"):o=i(o,"\n"," ")})).join("");return a}function x(e){return D(e,"ONE")}function V(e,t,r){e.dataset?e.dataset[t]=r:e.setAttribute("data-".concat(t),r)}function M(e){V(e,"heldisabled","1"),e.disabled=!0}var R=Object.freeze({__proto__:null,noop:C,safeParse:function(e,t,r){if(e&&"string"!=typeof e)return e;try{return JSON.parse(e)||t}catch(n){if(void 0!==t)return t;if(r)throw new Error(r);throw n}},isNull:T,noDupPush:P,okeys:O,merge2List:function(e,t){var r=[];return e.forEach((function(e){return P(r,e)})),t.forEach((function(e){return P(r,e)})),r},purify:w,getObjsVal:function(e,t,r){var n,a=r,i=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=l(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}(e);try{for(i.s();!(n=i.n()).done;){var o=n.value[t];if(![null,void 0,""].includes(o)){a=o;break}}}catch(s){i.e(s)}finally{i.f()}return a},pfstr:D,nbstr:x,nbalert:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=d(),a=x(e),i=n.alert||C;r?(null===(t=n.location)||void 0===t?void 0:t.port)&&i(a):i(a)},setDataset:V,disableNode:M});var F="unpkg",k="__default_online_ver__",j=F,G={CORE_VER:"4.9.2",DEFAULT_API_PREFIX:"https://unpkg.com",DEFAULT_API_URL:"/openapi/v1/app/info",DEFAULT_ONLINE_VER:k,DEFAULT_USER_LS_KEY:"HelUserRtxName",DEFAULT_PLAT:j,LS_LOG_MODE:"HelConfig.logMode",LS_LOG_FILTER:"HelConfig.logFilter",PLAT_HEL:"hel",PLAT_UNPKG:F,KEY_CSS_STR:"CSS_STR",KEY_ASSET_CTX:"ASSET_CTX",KEY_STYLE_TAG_ADDED:"STYLE_TAG_ADDED",KEY_CSS_LINK_TAG_ADDED:"CSS_LINK_TAG_ADDED",KEY_IGNORE_CSS_PREFIX_LIST:"IGNORE_CSS_PREFIX_LIST",KEY_IGNORE_STYLE_TAG_KEY:"IGNORE_STYLE_TAG_KEY",KEY_IGNORE_CSS_PREFIX_2_KEYS:"IGNORE_CSS_PREFIX_2_KEYS"},B={SUB_APP_LOADED:"subAppLoaded",SUB_LIB_LOADED:"SubLibLoaded",STYLE_STR_FETCHED:"StyleStrFetched",STYLE_TAG_ADDED:"StyleTagAdded",CSS_LINK_TAG_ADDED:"CssLinkTagAdded"},H={NOT_LOAD:0,LOADING:1,LOADED:2},K=G.LS_LOG_FILTER,U=G.LS_LOG_MODE,Y=0,W=1,X=2,q={isIncludeFilter:function(e,t){return t.includes(",")?t.split(",").some((function(t){return e.includes(t)})):e.includes(t)},getLogFilter:function(){return Z().logFilter},setLogFilter:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Z().logFilter=e,t&&_(K,e)},setLogMode:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=parseInt(e,10);[Y,W,X].includes(r)&&(Z().logMode=r,t&&_(U,r))},getLogMode:function(){return Z().logMode}},J={};function z(){if(N(J=v().__HEL_MICRO_DEBUG__)){J={logMode:Y,logFilter:"",isInit:!1},v().__HEL_MICRO_DEBUG__=J;try{!function(){if(!Z().isInit){Z().isInit=!0;var e=y(),t=e.hellog,r=e.hellogf,n=t||b(U)||Y;q.setLogMode(n,!1);var a=r||b(K)||"";q.setLogFilter(a,!1)}}()}catch(e){}}else void 0===J.logMode&&(J.logMode=Y,J.logFilter="")}function Q(){return q.getLogMode()!==Y}function Z(){return J}var $="  %c--\x3e HEL LOG:",ee="color:#ad4e00;font-weight:600";function te(){if(Q()){for(var e=q.getLogMode()===W?console.log:console.trace||console.log,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],i=r.slice(1);if("string"!=typeof a)return e.apply(void 0,[$,ee].concat(r));var o=q.getLogFilter(),s=["".concat($," ").concat(a),ee].concat(u(i));o?q.isIncludeFilter(a,o)&&e.apply(void 0,u(s)):e.apply(void 0,u(s))}}var re=G.DEFAULT_API_URL,ne=G.DEFAULT_USER_LS_KEY,ae=G.PLAT_HEL,ie=G.PLAT_UNPKG,oe=G.DEFAULT_API_PREFIX,se=G.CORE_VER,ce=G.KEY_CSS_LINK_TAG_ADDED,ue=G.KEY_STYLE_TAG_ADDED,le=G.KEY_IGNORE_CSS_PREFIX_LIST,pe=G.KEY_IGNORE_STYLE_TAG_KEY,fe=G.KEY_IGNORE_CSS_PREFIX_2_KEYS;function de(e){return{apiMode:"get",apiPrefix:(e||{}).apiPrefix,apiSuffix:"",apiPathOfApp:re,apiPathOfAppVersion:"",getSubAppAndItsVersionFn:null,onFetchMetaFailed:null,strictMatchVer:!0,getUserName:null,userLsKey:ne,shouldUseGray:null,trustAppNames:null,semverApi:null,hook:{}}}function ve(e){return i(i({isConfigOverwrite:!1,platform:e,appName2Comp:{},appName2Lib:{},appName2isLibAssigned:{},appName2EmitApp:{},appName2verLoadStatus:{},appName2verEmitLib:{},appName2verEmitApp:{},appName2verStyleStr:{},appName2verStyleFetched:{},appName2verExtraCssList:{},appName2verAppVersion:{},appName2verCustomData:{},appName2app:{},appName2appVersion:{},appName2styleStr:{},appGroupName2firstVer:{},isOriginInitCalled:!1},de()),{},{origin:de({apiPrefix:oe})})}function he(){var e={};return{on:function(t,r){var n=e[t];if(!n){var a=[];e[t]=a,n=a}n.push(r)},emit:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];var i=e[t];i&&i.slice().forEach((function(e){return e.apply(void 0,n)}))},off:function(t,r){var n=e[t];if(n)for(var a=0,i=n.length;a<i;a++){if(n[a]===r){n.splice(a,1);break}}}}}function me(e){[ce,ue,le,pe,fe].forEach((function(t){return S(e,t,function(e){return e===le?[]:{}}(t))}))}function ge(){var e=be();if(e){var t=e.cacheRoot;S(t,"appGroupName2platform"),S(t,"common");var r=t.caches;return Object.keys(r).forEach((function(e){var t=r[e];S(t,"appGroupName2firstVer"),S(t,"appName2isLibAssigned"),S(t,"appName2verExtraCssList"),S(t,"appName2verCustomData"),S(t,"hook"),S(t,"origin",de()),S(t.origin,"hook")})),me(t.common),void(e.userEventBus||(e.userEventBus=he()))}e=function(){var e,t=ve(ie),r=ve(ae),n={platform:ae,platformHint:"the platform value here does not make any sense!",appName2platform:{},appGroupName2platform:{},caches:(e={},s(e,ie,t),s(e,ae,r),e),common:{}},a=he(),i=he();return{ver:se,isStyleObInit:!1,nativeHeadAppend:null,nativeBodyAppend:null,patchedHeadAppend:null,patchedBodyAppend:null,createFeature:A(),eventBus:a,userEventBus:i,cacheRoot:n,unpkgCache:t,helCache:r,dev:{setLogMode:q.setLogMode,setLogFilter:q.setLogFilter}}}(),me(e.cacheRoot.common),v().__HEL_MICRO_SHARED__=e}function be(){return v().__HEL_MICRO_SHARED__}function _e(){return j}function ye(e){var t=e||_e(),r=Ae(),n=r.caches[t];if(!n){var a=o(e);if("string"!==a)throw console.error("invalid plaform:",e),new Error("fatal error: platform only can be a string, now it is ".concat(a));var i=ve(e);r.caches[t]=i,n=i}return n}function Ae(){return be().cacheRoot}var Ee={getCustomData:function(e,t,r){var n=r.versionId,a=S(ye(r.platform).appName2verCustomData,e);return S(a,t)[n||k]},getAppMeta:function(e,t){return ye(t).appName2app[e]},setVerLoadStatus:function(e,t,r,n){var a=n||{},i=a.versionId;E(ye(a.platform)[r],e,i||k,t)},getVerLoadStatus:function(e,t,r){var n,a=r||{},i=a.versionId,o=ye(a.platform)[t],s=i||k;return(null===(n=o[e])||void 0===n?void 0:n[s])||H.NOT_LOAD},ensureOnlineModule:function(e,t,r){if(!e[k]){var n=Ee.getAppMeta(t,r),a=e[null==n?void 0:n.online_version];a&&(e[k]=a)}}};function Se(e,t){te("[[ core:setEmitApp ]] appName,emitApp:",e,t);var r=t.versionId,n=ye(t.platform),a=n.appName2verEmitApp,i=n.appName2Comp,o=n.appName2EmitApp;S(a,e)[k]||(i[e]=t.Comp,o[e]=t,E(a,e,k,t)),r&&E(a,e,r,t)}var Le=G.KEY_CSS_LINK_TAG_ADDED,Ie=G.KEY_STYLE_TAG_ADDED,Ne=G.KEY_IGNORE_CSS_PREFIX_LIST,Ce=G.KEY_IGNORE_STYLE_TAG_KEY,Te=G.KEY_IGNORE_CSS_PREFIX_2_KEYS;function Pe(e){return S(Ae().common,e)}function Oe(e){return Ae().common[e]}function we(e,t){var r=Pe(e)[t];return void 0!==r?r:null}function De(e,t,r){Pe(e)[t]=r}var xe={setIgnoreCssPrefix:function(e){I(Oe(Ne),e)},setIgnoreStyleTagKey:function(e){xe.getIgnoreStyleTagMap()[e]=1},getIgnoreStyleTagMap:function(){return Oe(Ce)},setIgnoreCssPrefixKey:function(e,t){var r=we(Te,e);r||De(Te,e,r=[]),I(r,t)},getIgnoreCssPrefixKeys:function(e){return Oe(Te)[e]||[]},getMatchedIgnoreCssPrefix:function(e){for(var t=Oe(Ne),r="",n=0;n<t.length;n++){var a=t[n];if(e.startsWith(a)){r=a;break}}return r},getIgnoreCssPrefixCssUrlList:function(e){var t=we(Le,e);return t||De(Le,e,t=[]),t},setIgnoreCssPrefixCssUrl:function(e,t){xe.getIgnoreCssPrefixCssUrlList(e).push(t)},getStyleTagText:function(e){return we(Ie,e)||""},clearStyleTagText:function(e){De(Ie,e,"")},appendStyleTagText:function(e,t){var r=xe.getStyleTagText(e);De(Ie,e,"".concat(r," ").concat(t))}};function Ve(e,t){var r=e.apiMode,n=e.apiPrefix,a=e.apiSuffix,i=e.apiPathOfApp,o=e.apiPathOfAppVersion,s=e.getSubAppAndItsVersionFn,c=e.onFetchMetaFailed,u=e.strictMatchVer,l=e.getUserName,p=e.userLsKey,f=e.shouldUseGray,d=e.getApiPrefix,v=e.trustAppNames,h=e.platform,m=e.origin,g={apiMode:r,apiPrefix:n,apiSuffix:a,apiPathOfApp:i,apiPathOfAppVersion:o,getSubAppAndItsVersionFn:s,onFetchMetaFailed:c,strictMatchVer:u,getUserName:l,userLsKey:p,shouldUseGray:f,getApiPrefix:d,trustAppNames:v,hook:e.hook,platform:h};return t&&(g.origin=m),g}function Me(e){return Ae().appGroupName2platform[e]||_e()}function Re(e,t){var r=t.customKey,n=S(ye(t.platform).appName2verCustomData,e);return S(n,r)}var Fe=B.STYLE_TAG_ADDED,ke=B.CSS_LINK_TAG_ADDED;function je(){return be().eventBus}var Ge={styleTagAdded:function(e){return"".concat(Fe,"/").concat(e)},cssLinkTagAdded:function(e){return"".concat(ke,"(").concat(e,")")}};function Be(e,t,r){var n=(r||{}).appGroupName,a=t.versionId,i=t.appProperties,s=t.platform||r.platform,c=ye(s),u=c.appName2verEmitLib,l=c.appName2Lib,p=c.appName2isLibAssigned,f=Ee.getAppMeta(e,s),d=function(e){var t=l[e];t?"object"===o(t)&&0===Object.keys(t).length&&Object.assign(t,i):l[e]=i,p[e]=!0};d(e),n?d(n):f&&d(f.app_group_name),te("[[ core:setEmitLib ]] appMeta:",f),S(u,e)[k]||E(u,e,k,i),a&&E(u,e,a,i)}function He(e,t){return ye(t).appName2app[e]}function Ke(e,t,r){Ee.setVerLoadStatus(e,t,"appName2verLoadStatus",r)}function Ue(e,t){var r=A();te("[[ core:tryGetVersion ]] may include source > ".concat(r));var n=ye(t).appGroupName2firstVer[e]||"";if(r.includes("https://")||r.includes("http://")){var a=c(r.split("//"),2)[1],i=a.split("/");if(n){if(t===j&&i.some((function(e){return e.includes(n)})))return n;if(i.includes(n))return n;if("static"===i[1]&&"js"===i[2]||"js"===i[1])return n}if(t===j){var o=1;return a.indexOf("@")!==a.lastIndexOf("@")&&(o=2),i[o].split("@")[1]||n}var s=c(a.split("/".concat(t,"/")),2);return c(s[1].split("/"),1)[0]||n}return n}function Ye(e,t){return e===k?t||"":e.includes("_")?e.substring(0,e.length-15):t||""}var We=!1,Xe=!1;var qe=G.KEY_ASSET_CTX;function Je(e,t){if(!t||!["LINK","SCRIPT"].includes(t.tagName))return e(t);var r=t.href,n=t.tagName,a=t.src,i="LINK"===n,o=we(qe,r||a||"")||{},s=o.platform,c=o.groupName,u=o.name,l=o.ver,p=o.beforeAppend,f=t;if(p){var d=i?"href":"src",v=t.getAttribute(d);f=p({el:t,nativeAppend:e,setAssetUrl:function(e){return t.setAttribute(d,e)},url:v,tagName:n})||t}return s&&function(e,t){var r=t.platform,n=t.groupName,a=t.name,i=t.ver;V(e,"el",t.elName),V(e,"plat",r),V(e,"gname",n),V(e,"name",a),V(e,"ver",i)}(f,{platform:s,groupName:c,name:u,ver:l,elName:i?"HelLink":"HelScript"}),e(f)}var ze="/* @helstart ",Qe=" @helend */",Ze=ze.length;function $e(e,t){var r=e.tagName,n=e.innerText,a=e.href;if(["STYLE","LINK"].includes(r)&&("STYLE"!==r||n))if("STYLE"===r){var i=n.indexOf(ze);if(i<0)return;var o=n.indexOf(Qe);if(o<0)return;var s=n.substring(Ze+i,o);if(s){var c=s.trim(),u="",l=c;if(c.includes("/")){var p=c.split("/");u=p[0],l=p[1]}V(e,"gname",l),u&&V(e,"plat",u),t[c]&&M(e);var f=je();xe.appendStyleTagText(c,n),f.emit(Ge.styleTagAdded(c),{nodes:[e]})}}else{var d=function(e,t){var r=je(),n=xe.getMatchedIgnoreCssPrefix(t);return n&&(xe.setIgnoreCssPrefixCssUrl(n,t),r.emit(Ge.cssLinkTagAdded(n),{nodes:[e]})),n}(e,a);d&&M(e)}}function et(e,t){var r=e.tagName,n=e.src,a=void 0===n?"":n;if("SCRIPT"!==r)return!1;if(!a.endsWith(".hot-update.js"))return!1;var i=xe.getMatchedIgnoreCssPrefix(a);if(!i)return!1;var o=xe.getIgnoreCssPrefixKeys(i);if(!o.length)return!1;var s=!1;return o.forEach((function(e){t[e]&&(!function(e){var t=d();if(t){var r=t.document.head.querySelectorAll('style[data-gname="'.concat(e,'"]'));r.length&&(xe.clearStyleTagText(e),r.forEach((function(t){M(t),xe.appendStyleTagText(e,t.innerText)})),je().emit(Ge.styleTagAdded(e),{nodes:r}))}}(e),s=!0)})),s}st(),te("hel-micro-core ver ".concat(G.CORE_VER));var tt=B,rt=H,nt=G,at=function e(t,r,n){var a=n||{},s=a.ignoreKeys,c=void 0===s?[]:s,u=a.arg1PlatObjFnKeys,l=void 0===u?[]:u,p={};return Object.keys(r).forEach((function(a){var s=r[a];if(c.includes(a))p[a]=s;else{var u=o(s);p[a]=u&&"object"===u?e(t,s,n):"function"!==u?s:function(e,t){var r=this,n=t.fn,a=t.fnName,o=t.arg1PlatObjFnKeys.includes(a);return function(){for(var t=function(t){return i({platform:e},w(t||{}))},a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];var u=s[0],l=s[1];return o?s[0]=t(u):s[1]=t(l),n.apply(r,s)}}(t,{arg1PlatObjFnKeys:l,fn:s,fnName:a})}})),p},it=R,ot=function(){return"more details see: https://tnfe.github.io/hel/docs/tutorial/attention-is-subapp",console.log("%c".concat("WARNING: calling isSubApp is unsafe, use hel-iso.isSubApp instead,\nmore details see: https://tnfe.github.io/hel/docs/tutorial/attention-is-subapp"),"color:red;"),!We};function st(e){e&&vt(e),function(e){if(e&&(We=!1,Xe=!1),!Xe){Xe=!0;var t=d();void 0===t.__MASTER_APP_LOADED__&&(t.__MASTER_APP_LOADED__=!0,We=!0)}}(!!e),ge(),z(),function(){var e=d();if(!e.__POWERED_BY_QIANKUN__){var t=be(),r=e.document,n=t.nativeHeadAppend,a=t.nativeBodyAppend;if(!n&&r){var i=r.head,o=r.body;if(n=i.appendChild.bind(i),t.nativeHeadAppend=n,o)a=o.appendChild.bind(o),t.nativeBodyAppend=a;else{var s=new(h())((function(e){for(var r,n=0;n<e.length;n++){var i=e[n].addedNodes;if(r=m(i,"BODY"))break}r&&(a=r.appendChild.bind(r),t.nativeBodyAppend=a,r.appendChild=function(e){return Je(u(a,r,"body"),e)},s.disconnect())})),c=m(r.childNodes,"HTML");c&&s.observe(c,{childList:!0})}var u=function(r,n,a){var i=t.patchedHeadAppend,o=t.patchedBodyAppend,s="head"===a;if(i&&s)return i;if(o&&!s)return o;if(e.__POWERED_BY_WUJIE__)return r;var c=e.Element;return c?c.prototype.appendChild.bind(n):r};i.appendChild=function(e){return Je(u(n,i,"head"),e)},o&&(o.appendChild=function(e){return Je(u(a,o,"body"),e)})}}}(),function(){var e=be(),t=d(),r=e.isStyleObInit,n=t.document;if(!r&&n){e.isStyleObInit=!0;var a=xe.getIgnoreStyleTagMap(),i=h();i&&new i((function(e){e.forEach((function(e){for(var t=e.addedNodes,r=e.removedNodes,n=t.length,i=0;i<n;i++)$e(t[i],a);for(var o=r.length,s=0;s<o&&!et(r[s],a);s++);}))})).observe(document.head,{childList:!0})}}()}var ct=_e,ut=ye,lt=Z,pt=Q,ft=te,dt=d,vt=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null;null!==(t=f)&&void 0!==t&&t.__HEL_MICRO_SHARED__&&(n=f.__HEL_MICRO_SHARED__),f=r?i(i({},f),e):e,n&&(f.__HEL_MICRO_SHARED__=n)},ht=function(e,t){var r,n=t||{},a=n.versionId,i=n.platform,o=ye(i),s=o.appName2verEmitApp,c=o.appName2Comp,u=o.strictMatchVer,l=o.appName2EmitApp,p=null!==(r=n.strictMatchVer)&&void 0!==r?r:u,f=S(s,e);Ee.ensureOnlineModule(f,e,i);var d=f[a||k],v=c[e],h=v?{Comp:v}:null,m=p?null:l[e]||h,g=d||m||null;return te("[[ core:getVerApp ]] appName,options,result:",e,n,g),g},mt=Se,gt=function(e,t){var r,n=t||{},a=n.versionId,i=ye(n.platform),o=i.appName2verEmitLib,s=i.appName2Lib,c=i.strictMatchVer,u=i.appName2isLibAssigned,l=null!==(r=n.strictMatchVer)&&void 0!==r?r:c,p=S(o,e);Ee.ensureOnlineModule(p,e);var f=p[a||k],d=u[e]?s[e]:null,v=f||(l?null:d)||null;return te("[[ core:getVerLib ]] appName,options,result:",e,n,v),v},bt=Be,_t=He,yt=function(e,t){ye(t).appName2app[e.name]=e},At=function(e,t){var r,n=t||{},a=n.platform,i=n.versionId,o=ye(a),s=o.appName2verAppVersion,c=o.appName2appVersion[e]||null;return i&&(null===(r=s[e])||void 0===r?void 0:r[i])||c},Et=function(e,t,r){var n=(r||{}).platform,a=ye(n),i=a.appName2verAppVersion,o=a.appGroupName2firstVer,s=a.appName2appVersion,c=t.sub_app_version;if(c){var u=Ee.getAppMeta(e,n);S(i,e)[k]||(E(i,e,k,t),s[e]=t),E(i,e,c,t),o[u.app_group_name]=c}},St=function(e,t){var r=Re(e,t)[t.versionId||k];return void 0!==r?r:null},Lt=function(e,t){var r=t.customValue,n=t.versionId;Re(e,t)[n||k]=r},It=we,Nt=De,Ct=xe,Tt=function(e,t){return Ee.getVerLoadStatus(e,"appName2verLoadStatus",t)},Pt=Ke,Ot=function(e,t){return Ee.getVerLoadStatus(e,"appName2verStyleFetched",t)},wt=function(e,t,r){Ee.setVerLoadStatus(e,t,"appName2verStyleFetched",r)},Dt=function(e,t){var r,n=t||{},a=n.platform,i=n.versionId,o=ye(a),s=o.appName2verStyleStr,c=o.appName2styleStr[e]||"";return i?(null===(r=s[e])||void 0===r?void 0:r[i])||c||"":c},xt=function(e,t,r){var n=r||{},a=n.platform,i=n.versionId,o=ye(a),s=o.appName2verStyleStr,c=o.appName2verStyleFetched,u=o.appName2styleStr;i?(E(s,e,i,t),E(c,e,i,H.LOADED)):u[e]=t},Vt=function(e,t){var r=t||{},n=r.versionId,a=S(ye(r.platform).appName2verExtraCssList,e),i=a[n]||a[k]||[];return te("[[ core:getVerExtraCssList ]] options,cssList:",r,i),i},Mt=function(e,t,r){var n=r||{},a=n.versionId,i=ye(n.platform).appName2verExtraCssList;te("[[ core:setVerExtraCssList ]] cssList:",t),S(i,e)[k]||E(i,e,k,t),a&&E(i,e,a,t)},Rt=Ue,Ft=Ye,kt=function(e){return Ve(ye(e),!0)},jt=Me,Gt=function(e,t){return Ae().appGroupName2platform[e]=t,Me(e)},Bt=function(e,t){var r=ye(t),n=Ve(e);r.isConfigOverwrite||(r.isConfigOverwrite=!0,L(r,n))},Ht=function(e,t){var r=ye(e),n="[[ core:originInit ]] invalid call, it can only been called";if(r.isConfigOverwrite)te("".concat(n," before init"));else if(r.isOriginInitCalled)te("".concat(n," one time"));else{var a=Ve(t);r.isOriginInitCalled=!0,L(r.origin,a)}},Kt=function(e){var t=be(),r=t.nativeHeadAppend,n=t.nativeBodyAppend,a=e.headAppend||null,i=e.bodyAppend||null,o=function(e){return"pass same ".concat(e," handle, hel will ignore it for avlid 'Maximum call stack size exceeded'")};a&&a===r?console.error(o("headAppend")):t.patchedHeadAppend=a,i&&i===n?console.error(o("bodyAppend")):t.patchedBodyAppend=i},Ut=je,Yt=function(){return be().userEventBus},Wt=Ge,Xt=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.platform||Me(e),a=r.versionId||Ue(e,n),i=r.appName||Ye(a,e),o=He(i,n);null!=o&&o.__fromCust&&(a=r.versionId||o.online_version,i=o.name);var s={platform:n,appName:i,appGroupName:e,versionId:a,appProperties:t,Comp:function(){},lifecycle:{}};Be(i,s,{appGroupName:e,platform:n}),Ke(i,H.LOADED,{versionId:a,platform:n}),je().emit(B.SUB_LIB_LOADED,s)},qt=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.lifecycle,a=r.platform||Me(e),i=r.versionId||Ue(e,a),o=r.appName||Ye(i,e),s={Comp:t,appName:o,appGroupName:e,lifecycle:n,platform:a,versionId:i,isLib:!1};Se(o,s),Ke(o,H.LOADED,{versionId:i,platform:a}),je().emit(B.SUB_APP_LOADED,s)};function Jt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(a=n.key,i=void 0,"symbol"==typeof(i=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"))?i:String(i)),n)}var a,i}var zt=/\s/,Qt=/[a-zA-Z0-9\-]/,Zt="<!DOCTYPE html>",$t=["meta","link"],er={meta:"</meta>",link:"</link>"},tr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.input="",this.len=0,this.cur=0}var t,r,n;return t=e,r=[{key:"eof",get:function(){return this.cur>=this.len}},{key:"peek",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.input[this.cur+e]}},{key:"sub",value:function(e,t){var r=t||this.cur;return this.input.substring(r,r+e)}},{key:"moveCur",value:function(e){this.cur+=e}},{key:"consumeChar",value:function(e){var t=this.peek();if(t!==e)throw new Error("Unexpected character: '".concat(t,"' should be '").concat(e,"'"));return this.cur++,t}},{key:"consumeSpace",value:function(){this.consumeWhile(zt)}},{key:"consumeWhile",value:function(e){var t=[];do{var r=this.peek();if(!e.test(r))break;t.push(r),this.cur++}while(!this.eof);return t.join("")}},{key:"noop",value:function(){}},{key:"pureInput",value:function(e){var t=e.trim();return t.startsWith(Zt)&&(t=t.substring(Zt.length)),t=function e(t){var r=t.indexOf("\x3c!--"),n=t.indexOf("--\x3e");if(r>=0&&n>=0){var a=t.substring(0,r),i=t.substring(n+"--\x3e".length);return e("".concat(a).concat(i))}return t}(t),t}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e||"";return this.input=this.pureInput(r),this.len=r.length,this.onTagOpen=t.onTagOpen||this.noop(),this.onTagClose=t.onTagClose||this.noop(),this.cur=0,this.parseNodes()}},{key:"parseNodes",value:function(){var e=[];do{var t=void 0;if("<"===this.peek()){if("/"===this.peek(1))break;t=this.parseElement()}else t=this.parseTextNode();" "!==t&&e.push(t)}while(!this.eof);return e}},{key:"parseTextNode",value:function(){return this.consumeWhile(/[^<]/).replace(/[\s\n]+/g," ")}},{key:"parseElement",value:function(){var e=this;this.consumeChar("<");var t=this.parseTag();this.onTagOpen(t),this.consumeSpace();var r=this.parseAttrs(),n=this.peek(),a=this.peek(-1),i=function(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.parseTag(),e.consumeSpace(),e.consumeChar(">"),a&&e.moveCur(a);var i={tag:t,attrs:r,children:n};return e.onTagClose(t,i),i};if("/>"==="".concat(a).concat(n))return i([]);if($t.includes(t)&&">"===n){var o=er[t],s=o.length;return i([],this.sub(s,this.cur+1)===o?s:0)}this.consumeChar(">");var c=this.parseNodes();return this.consumeChar("<"),this.consumeChar("/"),i(c)}},{key:"parseTag",value:function(){return this.consumeWhile(Qt)}},{key:"parseAttrs",value:function(){for(var e={};">"!==this.peek();){var t=this.parseTag();if(t){if("="===this.peek()){this.consumeChar("="),this.consumeChar('"');var r=this.consumeWhile(/[^"]/);this.consumeChar('"'),e[t]=r}else e[t]="";this.consumeSpace()}else this.consumeChar(this.peek())}return e}}],r&&Jt(t.prototype,r),n&&Jt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function rr(e,t){return(new tr).parse(e,t)}var nr="4.9.10";function ar(e){var t=e.appGroupName,r=e.Comp,n=e.platform,a=e.lifecycle,i=e.appName,o=e.versionId;qt(t,r,{lifecycle:a,platform:n,appName:i,versionId:o})}var ir=function(){return ir=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},ir.apply(this,arguments)};function or(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}function sr(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))}function cr(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(s){i=[6,s],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var ur={GET_APP_AND_VER:"getSubAppAndItsVersion",GET_APP_AND_FULL_VER:"getSubAppAndItsFullVersion",BATCH_GET_APP_AND_VER:"batchGetSubAppAndItsVersion",BATCH_GET_APP_AND_FULL_VER:"batchGetSubAppAndItsFullVersion",GET_APP_VER:"getSubAppVersion",GET_APP_FULL_VER:"getSubAppFullVersion"},lr="get",pr="Jsonp",fr={LS_CACHE_APP_PREFIX:"HelAppCache",DATABASE_NAME:"HelIndexedDB",STORE_NAME:"HelMetaData"},dr={};function vr(){var e=dt();return"indexedDB"in e?e.indexedDB:(console.warn("The current browser is not support indexedDB!"),null)}var hr=function(){function e(e){this.dbInfo={db:null,name:"",storeName:"",version:1},this.ready=null,this.initStorage(e)}return e.prototype.initStorage=function(e){var t=vr();if(t){var r=null,n=null;this.ready=new Promise((function(e,t){r=e,n=t}));var a=this.dbInfo;if(e){var i=e.name,o=e.storeName,s=e.version;Object.assign(a,it.purify({name:i,storeName:o,version:s}))}var c=dr[a.name];c||(c={db:null,name:"",storeName:"",version:1},dr[a.name]=c),a.db=c.db;var u=this.isUpgradeNeeded(a);if(a.db){if(!u)return void r(a);a.db.close()}var l=[a.name,void 0];u&&(l[1]=a.version);var p=t.open.apply(t,l);u&&(p.onupgradeneeded=function(e){c.db=p.result,a.db=p.result;try{a.db.createObjectStore(a.storeName)}catch(r){if("ConstraintError"!==r.name)throw r;var t=it.nbstr('\n              The database "'.concat(a.name,'"\n              has been upgraded from version ').concat(e.oldVersion," to version ").concat(e.newVersion,',\n              but the storage "').concat(a.storeName,'" already exists.'));console.warn(t)}}),p.onerror=function(){n(p.error)},p.onsuccess=function(){a.db=p.result,c.db=p.result,a.db.onversionchange=function(e){e.target.close()},r(a)}}},e.prototype.isUpgradeNeeded=function(e){if(!e.db)return!0;var t=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,n=e.version>e.db.version;if(r&&(console.warn('The database "'.concat(e.name,"\" can't be downgraded from version ").concat(e.db.version," to version ").concat(e.version)),e.version=e.db.version),n||t){if(t){var a=e.db.version+1;a>e.version&&(e.version=a)}return!0}return!1},e.prototype.getObjectStore=function(e,t){var r=e.name,n=e.db,a=e.storeName;if(!n)throw new Error("get ".concat(a," objectStore failed in ").concat(r," database"));return n.transaction(a,t||"readonly").objectStore(a)},e.prototype.attachHandler=function(e,t,r){e.onsuccess=function(){t(e.result||null)},e.onerror=function(){r(e.error)}},e.prototype.getItem=function(e){return sr(this,void 0,void 0,(function(){var t,r,n,a=this;return cr(this,(function(i){switch(i.label){case 0:return[4,this.getDbInfo()];case 1:return t=i.sent(),r=this.getObjectStore(t),n=r.get(e),[2,new Promise((function(e,t){a.attachHandler(n,e,t)}))]}}))}))},e.prototype.setItem=function(e,t){return sr(this,void 0,void 0,(function(){var r,n,a,i=this;return cr(this,(function(o){switch(o.label){case 0:return[4,this.getDbInfo()];case 1:return r=o.sent(),n=this.getObjectStore(r,"readwrite"),a=n.put(t,e),[2,new Promise((function(e,t){i.attachHandler(a,e,t)}))]}}))}))},e.prototype.removeItem=function(e){return sr(this,void 0,void 0,(function(){var t,r,n,a=this;return cr(this,(function(i){switch(i.label){case 0:return[4,this.getDbInfo()];case 1:return t=i.sent(),r=this.getObjectStore(t,"readwrite"),n=r.delete(e),[2,new Promise((function(e,t){a.attachHandler(n,e,t)}))]}}))}))},e.prototype.getDbInfo=function(){return this.ready?this.ready:Promise.reject("forget init")},e}();function mr(e){return!e.startsWith("//")&&(e.startsWith("/")||e.startsWith("./")||e.startsWith("../"))}function gr(){if(!vr())return null;try{var e=new hr({name:fr.DATABASE_NAME,storeName:fr.STORE_NAME});return{setItem:function(t,r){return e.setItem(t,r)},getItem:function(t){return e.getItem(t)},removeItem:function(t){return e.removeItem(t)}}}catch(t){return console.error("new IndexedDBStorage error: ".concat(t.message)),null}}function br(){var e,t={getItem:function(){},setItem:function(){},removeItem:function(){}};try{return(null===(e=dt())||void 0===e?void 0:e.localStorage)||t}catch(r){return t}}var _r=Object.freeze({__proto__:null,getUserName:function(e){var t=e.userLsKey,r=br().getItem(t)||"";if(r)return r;try{var n={};dt().document.cookie.split(";").forEach((function(e){var t=e.split("="),r=t[0],a=t[1];n[r]=a})),r=n[t]||"",ft("[[ getUserName ]] result:",r)}catch(a){ft("[[ getUserName ]] err:",a)}return r}}),yr=it.isNull;function Ar(e,t,r){var n=kt(e),a=n.origin,i=n[t],o=a[t];return r||i||o}function Er(e,t,r,n){var a=r||[],i=a[0],o=a[1];if(!yr(i,n))return i;var s=kt(e),c=s.origin,u=s[t];if(!yr(u,n))return u;var l=c[t];return yr(l,n)?o:l}function Sr(e,t){var r,n=kt(e.platform),a=e.hook||{},i=n.origin,o=n.hook;return a[t]||o[t]||(null===(r=i.hook)||void 0===r?void 0:r[t])}function Lr(e,t){var r,n,a,i="";if(t&&(i=(null===(r=t.getApiPrefix)||void 0===r?void 0:r.call(t))||t.apiPrefix),i)return i;var o=kt(e);if(i=(null===(n=o.getApiPrefix)||void 0===n?void 0:n.call(o))||o.apiPrefix)return i;var s=o.origin;return i=(null===(a=s.getApiPrefix)||void 0===a?void 0:a.call(s))||s.apiPrefix}var Ir={now:function(){return(new Date).getTime()},rand:function(){return Math.random().toString().substring(6)},removeElem:function(e){var t=e.parentNode;t&&11!==t.nodeType&&t.removeChild(e)},parseData:function(e){var t="";if("string"==typeof e)t=e;else if("object"==typeof e)for(var r in e)t+="".concat(t,"&").concat(r,"=").concat(encodeURIComponent(e[r]));return t=(t+="&_t=".concat(Ir.now())).substring(1)},getJSON:function(e,t){return new Promise((function(r,n){var a="",i=e;i=i+(-1===i.indexOf("?")?"?":"&")+Ir.parseData(t);var o=/callback=(\w+)/.exec(i);a=(null==o?void 0:o[1])?o[1]:"helJsonp_".concat(Ir.now(),"_").concat(Ir.rand()),i=i.includes("?")?"".concat(i,"&callback=").concat(a):"".concat(i,"?callback=").concat(a);var s=dt(),c=s.document,u=c.createElement("script");u.type="text/javascript",u.src=i,u.id=a,u.onerror=n,u.addEventListener("error",n),s[a]=function(e){delete s[a];var t=c.getElementById(a);return t&&Ir.removeElem(t),r(e)};var l=c.getElementsByTagName("head");(null==l?void 0:l[0])&&l[0].appendChild(u)}))}},Nr=Ir.getJSON;function Cr(e){return e||ct()}function Tr(e,t){return sr(this,void 0,Promise,(function(){var r,n,a;return cr(this,(function(i){switch(i.label){case 0:return n=(r=t||{}).method,a=or(r,["method"]),[4,new Pr(a).request(e,n)];case 1:return[2,i.sent()]}}))}))}var Pr=function(){function e(e){this.req=null,this.resultPromise=Promise.resolve(null),this.init(e||{})}return e.prototype.init=function(e){var t="XMLHttpRequest"in dt()?new XMLHttpRequest:null;if(!t)throw new Error("current browser is not support XMLHttpRequest!");this.req=t;var r=e.responseType,n=e.timeout,a=void 0===n?1e4:n,i=e.withCredentials,o=e.headers;t.responseType=r||"json",t.timeout=a,t.withCredentials=!!i,o&&Object.keys(o).forEach((function(e){t.setRequestHeader(e,o[e])}));var s=null,c=null;this.resultPromise=new Promise((function(e,t){s=e,c=t}));var u=function(e){var r=t.status,n=t.statusText,a=t.responseURL;c({msg:e,status:r,statusText:n,url:a})};t.onload=function(){return e=t.response,r=t.status,n=t.statusText,a=t.responseURL,void s({data:e,status:r,statusText:n,url:a});var e,r,n,a},t.onerror=function(e){return u(e)},t.onabort=function(e){return u(e)},t.ontimeout=function(e){return u(e)},t.onprogress=function(){}},e.prototype.request=function(e,t){return sr(this,void 0,Promise,(function(){return cr(this,(function(r){switch(r.label){case 0:if(!this.req)throw new Error("forget init");return this.req.open(t?t.toUpperCase():"GET",e),this.req.send(),[4,this.resultPromise];case 1:return[2,r.sent()]}}))}))},e}();function Or(e,t){return sr(this,void 0,void 0,(function(){var r,n,a;return cr(this,(function(i){switch(i.label){case 0:return"try_detect_latest_ver",[4,xr("".concat(t,"/").concat(e,"@latest/").concat("try_detect_latest_ver","_").concat(Date.now()))];case 1:return r=i.sent().url,n=r.split("@"),a=n[n.length-1],[2,a.split("/")[0]]}}))}))}function wr(e,t){return sr(this,void 0,void 0,(function(){var r,n,a,i,o;return cr(this,(function(s){switch(s.label){case 0:return[4,dt().fetch(e)];case 1:return r=s.sent(),n=r.status,a=r.url,[200,304].includes(n)?t?[4,r.json()]:[3,3]:[2,{url:a,reply:null,status:n}];case 2:return i=s.sent(),[2,{url:a,reply:i,status:n}];case 3:return[4,r.text()];case 4:return o=s.sent(),[2,{url:a,reply:o,status:n}]}}))}))}function Dr(e,t){return sr(this,void 0,void 0,(function(){var r,n,a,i,o;return cr(this,(function(s){switch(s.label){case 0:return[4,Tr(e,{method:"GET",responseType:t?"json":"text"})];case 1:return r=s.sent(),n=r.status,a=r.data,i=r.url,o=void 0===i?"":i,400===n?[2,{url:o,reply:null,status:n}]:[2,{url:o,reply:a,status:n}]}}))}))}function xr(e,t){return void 0===t&&(t=!0),sr(this,void 0,void 0,(function(){var r;return cr(this,(function(n){switch(n.label){case 0:return r=Dr,dt().fetch&&(r=wr),[4,r(e,t)];case 1:return[2,n.sent()]}}))}))}function Vr(e){var t=e.extraCssList,r=void 0===t?[]:t,n=e.custom;if(n){var a=n.extraCssList,i=void 0===a?[]:a,o=n.enable;if(void 0===o||o)return it.merge2List(r,i)}return r.slice()}var Mr=it.safeParse,Rr={handleSemverRet:function(e,t){var r=(e||{}).version,n=e;return t.onlyVersion&&(n=r),!t.isFullVersion&&r&&Reflect.deleteProperty(r,"html_content"),r?{data:n,code:"0",msg:""}:{data:null,code:"404",msg:"no version found"}},appendSearchKV:function(e,t,r){var n=e;return r&&(n+="&".concat(t,"=").concat(r)),n},appendSuffix:function(e,t){var r=e;return t&&(r+=t),r}};function Fr(e,t){return sr(this,void 0,Promise,(function(){var r,n,a,i,o,s;return cr(this,(function(c){switch(c.label){case 0:r=null,n=t.semverApi,i=(a=void 0===n||n)?lr:t.apiMode,o="request ".concat(e),u=o,pt()&&console.time(u),c.label=1;case 1:return c.trys.push([1,6,,7]),i!==lr?[3,3]:[4,xr(e)];case 2:return s=c.sent(),r=s.reply,[3,5];case 3:return[4,Nr(e)];case 4:r=c.sent(),c.label=5;case 5:return function(e){pt()&&console.timeEnd(e)}(o),a?[2,Rr.handleSemverRet(r,t)]:[2,r];case 6:return[2,{data:null,code:"404",msg:c.sent().message}];case 7:return[2]}var u}))}))}function kr(e){var t=ir({},e);return t.additional_scripts=Mr(t.additional_scripts,[]),t.additional_body_scripts=Mr(t.additional_body_scripts,[]),t}function jr(e){var t=ir({},e);return t.src_map=Mr(t.src_map,{htmlIndexSrc:"",webDirPath:"",headAssetList:[],bodyAssetList:[],chunkJsSrcList:[],chunkCssSrcList:[],staticJsSrcList:[],staticCssSrcList:[],relativeJsSrcList:[],relativeCssSrcList:[],otherSrcList:[]}),t}function Gr(e,t,r,n){return void 0===n&&(n=!1),sr(this,void 0,void 0,(function(){var a;return cr(this,(function(i){switch(i.label){case 0:return(a=r)?[3,3]:n?(a="latest",[3,3]):[3,1];case 1:return[4,Or(t,e)];case 2:a=i.sent(),i.label=3;case 3:return[2,"".concat(e,"/").concat(t,"@").concat(a,"/hel_dist/hel-meta.json?_t=").concat(Date.now())]}}))}))}function Br(e,t){var r=t.versionId,n=t.projectId,a=t.branchId,i=t.apiMode,o=t.isFullVersion,s=void 0!==o&&o,c=t.versionIdList,u=void 0===c?[]:c,l=t.projectIdList,p=void 0===l?[]:l,f=t.branchIdList,d=void 0===f?[]:f,v=t.loadOptions,h=void 0===v?{}:v,m=Cr(t.platform),g=e,b=g,_=r,y=n,A=a,E=!1;Array.isArray(e)&&(g=e[0],b=e.join(","),_=u.join(","),y=p.join(","),A=d.join(","),E=!0);var S=function(e,t){return Er(m,e,[h[e],t])},L=function(e,t){return function(e,t,r,n){var a=Ar(e,t,n);return a?a(r):(_r[t]||function(){return null})(r)}(m,e,t,h[e])},I=S("userLsKey",nt.DEFAULT_USER_LS_KEY),N=L("getUserName",{platform:m,appName:g,userLsKey:I}),C=L("shouldUseGray",{appName:g}),T=S("apiSuffix"),P=S("apiPathOfApp",nt.DEFAULT_API_URL),O=Lr(m,h),w="";"boolean"==typeof C&&(w=C?"1":"0");var D=i===lr?"":pr,x="";x=E?s?ur.BATCH_GET_APP_AND_FULL_VER:ur.BATCH_GET_APP_AND_VER:s?ur.GET_APP_AND_FULL_VER:ur.GET_APP_AND_VER;var V="".concat(x).concat(D),M="";return M="".concat(O).concat(P,"/").concat(V,"?name=").concat(b),M=Rr.appendSearchKV(M,"userName",N),M=Rr.appendSearchKV(M,"version",_),M=Rr.appendSearchKV(M,"projId",y),M=Rr.appendSearchKV(M,"branch",A),M=Rr.appendSearchKV(M,"gray",w),{url:M=Rr.appendSuffix(M,T),userName:N}}function Hr(e,t){return sr(this,void 0,void 0,(function(){var r,n,a;return cr(this,(function(i){switch(i.label){case 0:return r=t.versionId,n=t.platform,a=t.loadOptions,[4,Gr(Lr(n,a),e,r||"",null==a?void 0:a.skip404Sniff)];case 1:return[2,i.sent()]}}))}))}function Kr(e,t){var r;return sr(this,void 0,void 0,(function(){var n,a,i,o;return cr(this,(function(s){switch(s.label){case 0:return n=t.loadOptions,a="",i="",null===(r=null==n?void 0:n.semverApi)||void 0===r||r?[4,Hr(e,t)]:[3,2];case 1:return i=s.sent(),[3,3];case 2:o=Br(e,t),i=o.url,a=o.userName,s.label=3;case 3:return[2,{url:i,userName:a}]}}))}))}function Ur(e,t){return sr(this,void 0,void 0,(function(){var r,n,a,i,o,s,c,u,l,p,f,d,v,h,m,g;return cr(this,(function(b){switch(b.label){case 0:return r=t.apiMode,n=t.appName,a=t.isFullVersion,i=void 0!==a&&a,o=t.semverApi,s=void 0===o||o,c=Cr(t.platform),u=Er(c,"apiPrefix"),l=Er(c,"apiSuffix"),p=Er(c,"apiPathOfApp"),f=Er(c,"apiPathOfAppVersion"),d="",s?[4,Gr(u,n,e)]:[3,2];case 1:return d=b.sent(),[3,3];case 2:v=r===lr?"":pr,h=i?ur.GET_APP_FULL_VER:ur.GET_APP_VER,m="".concat(h).concat(v),g=f||p||nt.DEFAULT_API_URL,d="".concat(u).concat(g,"/").concat(m,"?ver=").concat(e),d=Rr.appendSearchKV(d,"name",n),d=Rr.appendSuffix(d,l),b.label=3;case 3:return[2,d]}}))}))}function Yr(e,t){return sr(this,void 0,void 0,(function(){var r,n,a,i,o,s,c,u,l,p,f,d=this;return cr(this,(function(v){switch(v.label){case 0:return r=t.versionId,n=t.platform,a=t.apiMode,i=t.loadOptions,o=Ar(n,"getSubAppAndItsVersionFn",null==i?void 0:i.getSubAppAndItsVersionFn),[4,Kr(e,t)];case 1:return s=v.sent(),c=s.url,u=s.userName,l=function(e,t){return sr(d,void 0,void 0,(function(){var r,n;return cr(this,(function(o){switch(o.label){case 0:return[4,Fr(r=e||c,{apiMode:t||a,semverApi:null==i?void 0:i.semverApi})];case 1:if(n=o.sent(),0!==parseInt(n.code,10)||!n)throw new Error((null==n?void 0:n.msg)||"getSubAppAndItsVersion err");return[2,{app:kr(n.data.app),version:jr(n.data.version),metaUrl:r}]}}))}))},o?(p={platform:n,appName:e,userName:u,versionId:r,url:c,innerRequest:l},[4,Promise.resolve(o(p))]):[3,3];case 2:return[2,{app:kr((f=v.sent()).app),version:jr(f.version)}];case 3:return[4,l()];case 4:return[2,v.sent()]}}))}))}function Wr(e,t){return sr(this,void 0,void 0,(function(){var r,n,a,i,o,s,c,u;return cr(this,(function(l){switch(l.label){case 0:return r=t.apiMode,n=t.isFullVersion,a=void 0!==n&&n,i=t.semverApi,[4,Ur(e,t)];case 1:return[4,Fr(l.sent(),{apiMode:r,isFullVersion:a,semverApi:i,onlyVersion:!0})];case 2:if(o=l.sent(),s=o.data,c=o.code,u=o.msg,0!==parseInt(c,10)||!s)throw new Error(u||"ver not found");return[2,jr(s)]}}))}))}function Xr(e,t){return sr(this,void 0,void 0,(function(){var r,n,a,i,o,s,c,u,l=this;return cr(this,(function(p){switch(p.label){case 0:return e.length?(r=t.apiMode,n=t.batchGetFn,a=t.semverApi,i=Cr(t.platform),[4,Br(e,t)]):[2,[]];case 1:return o=p.sent().url,s=function(){return sr(l,void 0,void 0,(function(){var e,t,n,i;return cr(this,(function(s){switch(s.label){case 0:return[4,Fr(o,{apiMode:r,semverApi:a})];case 1:if(e=s.sent(),t=e.data,n=e.code,i=e.msg,0!==parseInt(n,10)||!t)throw new Error(i||"batch get failed");return[2,t.map((function(e){return{app:kr(e.app),version:jr(e.version)}}))]}}))}))},c=[],n?(u={url:o,platform:i,innerRequest:s},[4,Promise.resolve(n(u))]):[3,3];case 2:return c=p.sent(),[3,5];case 3:return[4,s()];case 4:c=p.sent(),p.label=5;case 5:return[2,c]}}))}))}var qr=it.noop,Jr=it.okeys,zr=Object.assign;function Qr(e){var t;try{return!!(null===(t=dt())||void 0===t?void 0:t.document).querySelector(e)}catch(r){return!1}}function Zr(e,t){var r=e["data-helex"],n=e["data-helappend"],a=dt();return"0"!==n&&(!r||("script"!==t||!a[r])&&!Qr("".concat(t,'[data-helex="').concat(r,'"]')))}function $r(e,t,r){var n=dt().document;Jr(t).forEach((function(r){return e.setAttribute(r,t[r])})),r?n.body.appendChild(e):n.head.appendChild(e)}function en(e){var t=e.attrs,r=e.innerText,n=e.appendToBody,a=void 0===n||n,i=e.onloadCb,o=t.src,s=or(t,["src"]);if(!o&&!r)return!1;var c=dt().document;if(o&&Qr('script[src="'.concat(o,'"]')))return!1;if(!Zr(s,"script"))return!1;var u=c.createElement("script");return o&&u.setAttribute("src",o),Jr(s).forEach((function(e){return u.setAttribute(e,s[e])})),i&&(u.onload=i),r&&(u.innerText=r),$r(u,s,a),!0}function tn(e){var t=e.appendToBody,r=void 0!==t&&t,n=e.innerText,a=e.attrs,i=a.href,o=a.rel,s=or(a,["href","rel"]),c=dt().document;if(i||n){if(!Zr(s,"link"))return!1;var u=c.createElement("link");i?(u.setAttribute("href",i),u.setAttribute("rel",o||"stylesheet")):o&&u.setAttribute("rel",o),n&&(u.innerText=n),$r(u,s,r)}}function rn(e,t){var r=t.appendToBody,n=t.appendCss,a=t.webDirPath,i=t.cssAppendTypes,o=t.excludeCssList;e.forEach((function(e){var t=e.tag,s=e.attrs,c=e.append,u=void 0===c||c,l=e.innerText,p=void 0===l?"":l;if(u){if(function(e,t){return qr(t),["link","staticLink","relativeLink"].includes(e)}(t,s)){var f={appendToBody:r,attrs:s,innerText:p},d=s.href;if(d.endsWith(".ico")&&!0!==e.append)return;return d.endsWith(".css")?void(n&&i.includes(function(e,t){return t.startsWith(e)?"build":mr(t)?"relative":"static"}(a,d))&&!o.includes(d)&&tn(f)):void tn(f)}(function(e,t){return qr(t),["script","staticScript","relativeScript"].includes(e)})(t,s)&&en({appendToBody:r,attrs:s,innerText:p}),"style"===t&&function(e){var t=e.appendToBody,r=void 0!==t&&t,n=e.innerText,a=void 0===n?"":n,i=e.attrs,o=dt().document.createElement("style");o.innerText=a,$r(o,i,r)}({appendToBody:r,attrs:s,innerText:p})}}))}function nn(e,t,r){dt().__HEL_LOAD_ASSETS_FLAG__=1;var n=e.additional_scripts,a=void 0===n?[]:n,i=e.additional_body_scripts,o=void 0===i?[]:i,s=t.src_map,c=s.headAssetList,u=void 0===c?[]:c,l=s.bodyAssetList,p=void 0===l?[]:l,f=s.webDirPath,d=s.chunkCssSrcList,v=void 0===d?[]:d,h=r.useAdditionalScript,m=void 0!==h&&h,g=r.appendCss,b=void 0===g||g,_=r.cssAppendTypes,y=void 0===_?["build","static","relative"]:_,A=r.getExcludeCssList,E=Vr(r),S=it.merge2List(E,v),L=(null==A?void 0:A(S,{version:t}))||[],I=function(e,t){if(e)for(var r=0,n=e;r<n.length;r++){var a=n[r];a.endsWith(".css")?b&&!L.includes(a)&&tn({appendToBody:t,attrs:{href:a}}):en({appendToBody:t,attrs:{src:a}})}};m&&(I(a,!1),I(o,!0)),I(E,!1);var N={excludeCssList:L,webDirPath:f,appendCss:b,cssAppendTypes:y};rn(u,zr(N,{appendToBody:!1})),rn(p,zr(N,{appendToBody:!0}))}var an={SHADOW:!0,SET_STYLE_AS_STRING:!0,ENABLE_DISK_CACHE:!1,ENABLE_DISK_CACHE_FOR_ERR:!0,ENABLE_SYNC_META:!0,STORAGE_TYPE:"localStorage",ENABLE_APPEND_CSS:!0,API_MODE:"get",EXTRA_DATA_PREFIX:"HelExtraData"},on="[[ isEmitVerMatchInputVer ]]";function sn(e,t){var r,n=t.branchId,a=t.platform,i=t.emitVer,o=t.inputVer,s=t.projectId,c=Er(a,"strictMatchVer",[t.strictMatchVer]),u=_t(e,a);if(!1===c)return ft("".concat(on," set strictMatchVer false for app (").concat(e,"), trust emitVer (").concat(i,") is the target version")),!0;if(!i)return ft("".concat(on," emitVer should not be null")),!0;if(!o&&u){if(n)return ft("".concat(on," found branchId ").concat(n)),!0;var l=u.online_version,p=u.build_version;if(s){var f=((null===(r=u.proj_ver)||void 0===r?void 0:r.map)||{})[s];if(f)return i===f.b||i===p||i===f.o}return i===l||i===p}return i===o}var cn=nt.DEFAULT_ONLINE_VER,un="http://localhost",ln="http://127.0.0.1",pn=["script","link","style"];var fn={isSrcMatchHost:function(e,t){return t.startsWith(un)||t.startsWith(ln)?e.startsWith(un)||e.startsWith(ln):e.startsWith(t)},parseHtml:function(e){if(dt().DOMParser)return function(e){var t=(new(0,dt().DOMParser)).parseFromString(e,"text/html"),r=[],n=function(e,t,n){e.querySelectorAll(n).forEach((function(e){var a=e.getAttributeNames(),i={};a.forEach((function(t){var r=e.getAttribute(t);null!==r&&(i[t]=r)})),r.push({head:t,tag:n,attrs:i,innerText:e.innerText})}))};return pn.forEach((function(e){return n(t.head,!0,e)})),pn.forEach((function(e){return n(t.body,!1,e)})),r}(e);var t=!0,r=[],n=function(e){return pn.includes(e)};return rr(e,{onTagOpen:function(e){n(e)&&r.push({tag:e,attrs:{},innerText:"",head:t})},onTagClose:function(e,a){if("head"===e&&(t=!1),n(e)){var i=r[r.length-1];if(i){var o=a.children[0]||"";"string"==typeof o&&(i.innerText=o),i.attrs=a.attrs}}}}),r},convertToAssetList:function(e,t){var r=[],n=[],a=[],i=[],o=[],s=[];return e.forEach((function(e){var c=e.head,u=e.attrs,l=e.innerText,p=e.tag,f=c?r:n,d=u.src,v=u.href,h=u["data-helex"],m=u.rel,g=function(e,t,r){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]||r}(u,"data-helappend","1");if("style"===p)f.push({tag:p,attrs:u,innerText:l,append:!0});else{var b=d||v||"",_=b.endsWith(".css"),y="link"===p;if(!b)return;var A=!0,E=fn.isSrcMatchHost(b,t);"icon"!==m&&(E||"1"===g||h)||(A=!1);var S=p;E||(mr(b)?(S=y?"relativeLink":"relativeScript",_?o.push(b):s.push(b)):(S=y?"staticLink":"staticScript",_?a.push(b):i.push(b)));var L={tag:S,attrs:u,innerText:l,append:A};f.push(L)}})),{headAssetList:r,bodyAssetList:n,staticCssSrcList:a,staticJsSrcList:i,relativeCssSrcList:o,relativeJsSrcList:s}},getChunkList:function(e){var t=[],r=[];return e.forEach((function(e){var n=e.attrs,a=n.href,i=n.src,o=a||i||"";o&&(o.endsWith(".css")?t.push(o):r.push(o))})),{chunkCssSrcList:t,chunkJsSrcList:r}},extactHelMeta:function(e){var t=e.code,r=e.data,n=e.msg;if(t&&r){if("0"!==t)throw new Error(n||"server error occurred");return r}return e},getHelMeta:function(e,t,r){return sr(this,void 0,void 0,(function(){var n,a,i,o;return cr(this,(function(s){switch(s.label){case 0:n=function(r){return void 0===r&&(r=""),"fetch ".concat(e," helmeta by url ").concat(t," failed in custom mode! ").concat(r)},s.label=1;case 1:return s.trys.push([1,3,,4]),[4,xr(t)];case 2:if(a=s.sent().reply,(i=fn.extactHelMeta(a))&&i.app&&i.version)return i.app.__fromCust=!0,[2,i];if(r)throw new Error(n());return ft("[[ getCustomMeta ]] 404 is a expected behavior for custom mode, user can ignore it"),[2,null];case 3:if(o=s.sent(),r)throw new Error(n(o.messgae));return it.noop("json parse fail or other error"),[3,4];case 4:return[2]}}))}))}};function dn(e){if(e){var t=e.enable,r=void 0===t||t;return!(!e.host||!r)}return!1}function vn(e,t){return sr(this,void 0,Promise,(function(){var r,n,a,i,o,s,c,u,l,p,f,d,v,h,m,g,b,_,y,A,E;return cr(this,(function(S){switch(S.label){case 0:return r=t.host,n=t.appGroupName,a=t.skipFetchHelMeta,i=void 0!==a&&a,o=t.isApiUrl,s=t.parseHtml,c=t.attachHostSuffix,u=void 0===c||c,l=Date.now(),o?[4,fn.getHelMeta(e,r,!0)]:[3,2];case 1:return[2,f=S.sent()];case 2:return i?[3,4]:(p=r.endsWith("hel-meta.json")?r:"".concat(r,"/hel-meta.json?_t=").concat(l),[4,fn.getHelMeta(e,p)]);case 3:if(f=S.sent())return[2,f];S.label=4;case 4:d="",S.label=5;case 5:return S.trys.push([5,7,,8]),[4,xr(u?"".concat(r,"/index.html?_t=").concat(l):r,!1)];case 6:if(v=S.sent(),d=v.reply||"",![200,304].includes(v.status))throw new Error("status ".concat(v.status));return[3,8];case 7:throw h=S.sent(),new Error("".concat(h.message," from ").concat(r));case 8:return m=s||fn.parseHtml,g=m(d),b=fn.convertToAssetList(g,r),_=b.headAssetList,y=b.bodyAssetList,A=or(b,["headAssetList","bodyAssetList"]),E=fn.getChunkList(_.concat(y)),[2,{app:{__fromCust:!0,name:e,app_group_name:n||e,online_version:cn,build_version:cn},version:{sub_app_name:e,sub_app_version:cn,src_map:ir(ir({webDirPath:r,headAssetList:_,bodyAssetList:y},E),A)}}]}}))}))}var hn=it,mn=nt.KEY_ASSET_CTX,gn={recordAssetCtx:function(e,t,r){var n=e.name,a=e.app_group_name,i=t.src_map,o=t.sub_app_version,s=i.chunkCssSrcList,c=void 0===s?[]:s,u=i.chunkJsSrcList,l=void 0===u?[]:u,p=Sr(r,"beforeAppendAssetNode"),f=c.concat(l),d=r.platform;f.forEach((function(e){var t=It(mn,e)||{};t.marked||(Object.assign(t,{marked:!0,platform:d,groupName:a,name:n,ver:o,beforeAppend:p}),Nt(mn,e,t))}))},tryTriggerOnFetchMetaSuccess:function(e,t,r){var n=r.loadOptions,a=r.fromFallback,i=Sr(n,"onFetchMetaSuccess");null==i||i({app:e,version:t,fromFallback:a})}};function bn(e){var t=Ar(e.platform,"onFetchMetaFailed",e.onFetchMetaFailed);return Sr(e,"onFetchMetaFailed")||t}function _n(e,t){var r=Cr(e),n=function(e,t){var r=kt(e).apiMode;return t||r}(r,t);return{platform:r,apiMode:n}}function yn(e,t){var r="".concat(fr.LS_CACHE_APP_PREFIX,".").concat(e);return(null==t?void 0:t({appName:e,innerKey:r}))||r}function An(e,t){return sr(this,void 0,Promise,(function(){var r,n,a,i;return cr(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),r=yn(e,t.getCacheKey),"indexedDB"!==t.storageType?[3,2]:(n=gr())?[4,n.getItem(r)]:[3,2];case 1:return[2,o.sent()];case 2:return a=br().getItem(r),[2,hn.safeParse(a||"",null)];case 3:return i=o.sent(),console.error(i),[2,null];case 4:return[2]}}))}))}function En(e,t){return sr(this,void 0,void 0,(function(){var r,n;return cr(this,(function(a){switch(a.label){case 0:return r=gr(),n=yn(e,t),r?[4,r.removeItem(n)]:[3,2];case 1:a.sent(),a.label=2;case 2:return br().removeItem(n),[2]}}))}))}function Sn(e,t,r){return sr(this,void 0,void 0,(function(){var n,a,i,o,s,c,u,l,p,f,d,v,h,m,g,b,_,y,A,E,S,L,I,N,C,T,P,O,w,D=this;return cr(this,(function(x){switch(x.label){case 0:return n=t.enableDiskCache,a=void 0===n?an.ENABLE_DISK_CACHE:n,i=t.enableSyncMeta,o=void 0===i?an.ENABLE_SYNC_META:i,s=t.versionId,c=void 0===s?"":s,u=t.projectId,l=void 0===u?"":u,p=t.branchId,f=t.isFullVersion,d=void 0!==f&&f,v=t.custom,h=t.strictMatchVer,m=t.semverApi,g=(r||{}).callRemote,b=void 0===g||g,_=_n(t.platform,t.apiMode),y=_.platform,A=_.apiMode,dn(v)?[4,vn(e,v)]:[3,2];case 1:return E=x.sent(),S=E.app,L=E.version,Nn(S,{appVersion:L,platform:y,toDisk:!1,loadOptions:t}),Gt(S.app_group_name,y),[2,{appInfo:S,appVersion:L}];case 2:return I=_t(e,y),N=At(e,{platform:y,versionId:c}),!m&&!p&&I&&N&&sn(e,{platform:y,projectId:l,emitVer:N.sub_app_version,inputVer:c,strictMatchVer:h})?[2,{appInfo:I,appVersion:N}]:(C={platform:y,apiMode:A,versionId:c,projectId:l,branchId:p,isFullVersion:d,loadOptions:t},T=null,P=function(t){return sr(D,void 0,void 0,(function(){return cr(this,(function(r){switch(r.label){case 0:return t?[4,Cn(e,C)]:[3,2];case 1:return[2,r.sent()];case 2:return[2,null]}}))}))},a?[4,An(e,t)]:[3,9]);case 3:return(T=x.sent())?[3,5]:[4,P(b)];case 4:return T=x.sent(),[3,8];case 5:return O=T.appInfo,w=T.appVersion,c&&w.sub_app_version!==c?[4,P(b)]:[3,7];case 6:return T=x.sent(),[3,8];case 7:Nn(O,{appVersion:w,platform:y,toDisk:!1,loadOptions:t}),P(o).catch((function(e){return hn.noop(e)})),x.label=8;case 8:return[3,11];case 9:return[4,P(b)];case 10:T=x.sent(),x.label=11;case 11:return T&&Gt(T.appInfo.app_group_name,y),[2,T]}}))}))}function Ln(e,t){return sr(this,void 0,Promise,(function(){var r,n,a,i,o,s;return cr(this,(function(c){switch(c.label){case 0:r=t.isFirstCall,n=void 0===r||r,a=t.enableDiskCacheForErr,i=void 0===a?an.ENABLE_DISK_CACHE_FOR_ERR:a,c.label=1;case 1:return c.trys.push([1,3,,6]),[4,Sn(e,t)];case 2:return[2,{data:s=c.sent(),err:""}];case 3:if(o=c.sent(),n)throw o;return bn(t)?[2,{data:null,err:o.message}]:(s=null,i?[4,An(e,t)]:[3,5]);case 4:if(!(s=c.sent()))throw o;hn.nbalert("\n        [Dev mode alert err only]: ".concat(o.message,", hel-micro will try use cached data to keep your app works well,\n        please check your network if this behavior is not as you expected! you can also set enableDiskCacheForErr = false\n        to skip reusing cached data.\n      ")),c.label=5;case 5:return[2,{data:s,err:o}];case 6:return[2]}}))}))}function In(e,t){return sr(this,void 0,void 0,(function(){var r,n,a,i,o,s,c;return cr(this,(function(u){switch(u.label){case 0:return r=_n(t.platform,t.apiMode),n=r.platform,a=r.apiMode,i=ir(ir({},t),{platform:n,apiMode:a}),[4,Yr(e,i)];case 1:if(o=u.sent(),s=o.app,!(c=o.version))throw new Error("no version found or builded");return[2,{appInfo:s,appVersion:c}]}}))}))}function Nn(e,t){var r=t.appVersion,n=t.platform,a=t.toDisk,i=void 0===a||a,o=t.loadOptions;if(e&&r){var s=e,c=s.name;if(i){var u=yn(c,o.getCacheKey),l=function(){try{br().setItem(u,JSON.stringify({appInfo:e,appVersion:r}))}catch(t){ft("save localStorage failed: ".concat(t.message))}};if("indexedDB"===o.storageType){var p=gr();p?p.setItem(u,{appInfo:e,appVersion:r}).catch((function(e){ft("save indexeddb failed, use localStorage instead, err: ".concat(e.message)),l()})):l()}else l()}if(o.semverApi){var f=_t(c,n);!0!==(null==f?void 0:f.__setByLatest)&&(s=o.versionId?s:ir(ir({},s),{__setByLatest:!0}),yt(s,n))}else yt(e,n);Et(c,r,{platform:n});var d=Vr(o);Mt(c,d,{platform:n,versionId:r.sub_app_version})}}function Cn(e,t){return sr(this,void 0,void 0,(function(){var r,n,a,i,o;return cr(this,(function(s){switch(s.label){case 0:return r=t.platform,n=t.loadOptions,[4,In(e,t)];case 1:return a=s.sent(),i=a.appInfo,o=a.appVersion,Nn(i,{appVersion:o,platform:r,loadOptions:n}),[2,a]}}))}))}function Tn(e,t){return void 0===t&&(t={}),sr(this,void 0,Promise,(function(){var r,n,a,i,o,s,c,u,l,p,f,d,v,h,m,g,b,_;return cr(this,(function(y){switch(y.label){case 0:r=t.isFirstCall,n=void 0===r||r,a=t.controlLoadAssets,i=void 0!==a&&a,o=t.platform,s=t.versionId,c=void 0===s?"":s,y.label=1;case 1:return y.trys.push([1,5,,8]),[4,Ln(e,t)];case 2:return u=y.sent(),l=u.data,p=u.err,d=(f=l||{}).appInfo,v=f.appVersion,h=!1,!(!d||!v)||n?[3,4]:(m=bn(t))?[4,Promise.resolve(m({platform:o,appName:e,versionId:c}))]:[3,4];case 3:(g=y.sent())&&(d=g.app,v=g.version,h=!0,Nn(d,{appVersion:v,platform:Cr(o),toDisk:!1,loadOptions:t})),y.label=4;case 4:if(!d)throw new Error(p||"app[".concat(e,"] not exist"));if(!v)throw new Error(p||"app[".concat(e,"]'s version[").concat(c,"] not exist"));return gn.tryTriggerOnFetchMetaSuccess(d,v,{loadOptions:t,fromFallback:h}),gn.recordAssetCtx(d,v,t),b=function(){nn(d,v,t)},i?[2,b]:(b(),[2,null]);case 5:return _=y.sent(),n?(console.error("loadApp err and try one more time: ",_),[4,Tn(e,ir(ir({},t),{isFirstCall:!1}))]):[3,7];case 6:return[2,y.sent()];case 7:throw new Error("loadApp [".concat(e,"] err (").concat(_.message,"), recommend config onFetchMetaFailed hook"));case 8:return[2]}}))}))}var Pn=Object.freeze({__proto__:null,getSubAppVersion:function(e,t){return sr(this,void 0,Promise,(function(){return cr(this,(function(r){switch(r.label){case 0:return[4,Wr(e,t)];case 1:return[2,r.sent()]}}))}))},getSubAppMeta:function(e,t){return sr(this,void 0,Promise,(function(){return cr(this,(function(r){switch(r.label){case 0:return[4,Yr(e,t||{})];case 1:return[2,r.sent()]}}))}))},getMetaDataUrl:function(e,t){var r=t||{},n=r.versionId,a=r.platform,i=r.apiMode,o=void 0===i?lr:i,s=r.protocol,c=void 0===s?"http":s,u=r.projectId,l=r.branchId,p=r.semverApi,f=Br(e,{platform:a,versionId:n,branchId:l,apiMode:o,projectId:u,semverApi:void 0===p||p}).url;return"http"===c&&(f=f.replace("https:","http:")),f},clearDiskCachedApp:function(e,t){return sr(this,void 0,void 0,(function(){var r;return cr(this,(function(n){switch(n.label){case 0:return Array.isArray(e)?(r=[],e.forEach((function(e){return r.push(En(e,t))})),[4,Promise.all(r)]):[3,2];case 1:return n.sent(),[3,4];case 2:return[4,En(e,t)];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))}});function On(e,t){var r=At(e,t);return(null==r?void 0:r.src_map.webDirPath)||""}function wn(e,t){var r=t||{},n=Cr(r.platform),a=r.versionId||"";if(!a){var i=At(e,{platform:n});if(i)a=i.sub_app_version;else{var o=_t(e,n);a=(null==o?void 0:o.online_version)||(null==o?void 0:o.build_version)||""}}return{platform:n,versionId:a}}var Dn=On,xn=Object.freeze({__proto__:null,getPlatAndVer:wn,getGroupedStyleList:function(e,t){var r={static:[],build:[]},n=At(e,t);if(n){var a=n.src_map,i=a.webDirPath;a.chunkCssSrcList.forEach((function(e){e.startsWith(i)?r.build.push(e):r.static.push(e)}))}return r},getWebDirPath:Dn}),Vn=nt.KEY_CSS_STR,Mn=rt,Rn=Mn.LOADED,Fn=Mn.LOADING,kn=Mn.NOT_LOAD,jn=it.merge2List,Gn=Ut(),Bn=tt.STYLE_STR_FETCHED,Hn={isStyleStatusMatch:function(e,t,r){var n=wn(e,r),a=n.platform,i=n.versionId;return Ot(e,{platform:a,versionId:i})===t},getSelfCssList:function(e,t){var r=wn(e,t),n=At(e,r),a=Vt(e,r),i=[],o=[];if(n){var s=n.src_map||{},c=s.chunkCssSrcList,u=void 0===c?[]:c,l=s.headAssetList,p=void 0===l?[]:l,f=s.bodyAssetList,d=void 0===f?[]:f;i=u;var v=function(e){var t=[];return e.forEach((function(e){var r=e.append,n=void 0===r||r,a=e.attrs.href||"";a.endsWith(".css")&&n&&t.push(a)})),t},h=jn(v(p),v(d));o=jn(h,i)}return{buildCssList:i,initExtraCssList:a,appCssList:o=jn(o,a)}},fetchStyleStr:function(e){return sr(this,void 0,void 0,(function(){var t,r,n,a,i,o,s;return cr(this,(function(c){switch(c.label){case 0:t="",r=0,n=e.length,c.label=1;case 1:if(!(r<n))return[3,7];if(!(a=e[r]).endsWith(".css"))return[3,6];if(i=It(Vn,a))return[3,5];c.label=2;case 2:return c.trys.push([2,4,,5]),[4,xr(a,!1)];case 3:return o=c.sent(),i=o.reply,Nt(Vn,a,i),[3,5];case 4:return s=c.sent(),console.error(s),[3,5];case 5:t+=i,c.label=6;case 6:return r++,[3,1];case 7:return[2,t]}}))}))},waitStyleReady:function(e,t){return sr(this,void 0,void 0,(function(){var r;return cr(this,(function(n){switch(n.label){case 0:return r=null,[4,new Promise((function(n){r=function(r){var a=r.appName,i=r.platform,o=r.versionId,s=t.branchId,c=t.versionId,u=t.platform,l=t.strictMatchVer;a===e&&i===u&&sn(e,{branchId:s,platform:u,emitVer:o,inputVer:c,strictMatchVer:l})&&n(!0)},Gn.on(Bn,r)}))];case 1:return n.sent(),r&&Gn.off(Bn,r),[2]}}))}))},computeStyleData:function(e,t){var r=wn(e,t),n=Hn.getSelfCssList(e,t),a=n.appCssList,i=n.buildCssList,o=n.initExtraCssList,s=t.extraCssList,c=void 0===s?[]:s,u=t.getExcludeCssList,l=jn(a,c),p=(null==u?void 0:u(l,{version:At(e,r)}))||[],f=!p.length&&!c.length,d=l;return p.length&&(d=l.filter((function(e){return!p.includes(e)}))),{validCssList:d,onlyUseAppCssList:f,buildCssList:i,initExtraCssList:o,appCssList:a}},fetchStyleData:function(e,t){return sr(this,void 0,void 0,(function(){var r,n,a,i,o,s,c,u,l,p,f,d,v,h,m,g,b,_;return cr(this,(function(y){switch(y.label){case 0:return r=wn(e,t),n=t.extraStyleStr,a=void 0===n?"":n,i=t.cssListToStr,o=t.extraCssList,s=void 0===o?[]:o,c=t.strictMatchVer,u=t.branchId,l=Hn.computeStyleData(e,t),p=l.validCssList,f=l.onlyUseAppCssList,d=l.buildCssList,v=l.initExtraCssList,h=l.appCssList,m={validCssList:p,buildCssList:d,initExtraCssList:v,appCssList:h,extraCssList:s,extraStyleStr:a,renderStyleStr:""},i?f?(g=Ot(e,r),b="",g!==Fn?[3,2]:[4,Hn.waitStyleReady(e,ir(ir({},r),{strictMatchVer:c,branchId:u}))]):[3,6]:[2,m];case 1:return y.sent(),b=Dt(e,r)||"",[3,5];case 2:return g!==kn?[3,4]:(wt(e,Fn,r),[4,Hn.fetchStyleStr(h)]);case 3:return b=y.sent(),xt(e,b,r),wt(e,Rn,r),Gn.emit(Bn,ir({appName:e},r)),[3,5];case 4:b=Dt(e,r)||"",y.label=5;case 5:return m.renderStyleStr="".concat(b).concat(a),[3,8];case 6:return[4,Hn.fetchStyleStr(p)];case 7:_=y.sent(),m.renderStyleStr="".concat(_).concat(a),y.label=8;case 8:return[2,m]}}))}))}};function Kn(e,t){var r=(t||{}).custom||{},n="",a=r.host,i=r.enable;if(a&&(void 0===i||i))if(a.endsWith(".json")||a.endsWith(".html")){var o=a.split("/"),s=o.length;o.splice(s-1,s),n=o.join("/")}else n=a;else n=On(e,t);return n}var Un=Object.freeze({__proto__:null,fetchAppStyleData:function(e,t){return sr(this,void 0,Promise,(function(){return cr(this,(function(r){switch(r.label){case 0:return[4,Hn.fetchStyleData(e,t||{})];case 1:return[2,r.sent()]}}))}))},getAppStyleStr:function(e,t){var r=wn(e,t);return Dt(e,r)},getAppCssList:function(e,t){return Hn.getSelfCssList(e,t||{})},fetchStyleByUrlList:function(e){return sr(this,void 0,void 0,(function(){return cr(this,(function(t){switch(t.label){case 0:return[4,Hn.fetchStyleStr(e)];case 1:return[2,t.sent()]}}))}))},isStyleFetched:function(e,t){return Hn.isStyleStatusMatch(e,Rn,t||{})},disableStyleTags:function(e){var t=dt();t.document&&t.document.querySelectorAll('style[data-gname="'.concat(e,'"]')).forEach(it.disableNode)},getStyleTagText:function(e){return Ct.getStyleTagText(e)},getIgnoredCssUrlList:function(e,t){var r=Kn(e,t);return Ct.getIgnoreCssPrefixCssUrlList(r)||[]},getSuitableCssPrefix:Kn});function Yn(e,t,r){var n=r.platform;if(!_t(t,n)){var a=_t(e,n),i=At(e,r);if(a&&i){yt(ir(ir({},a),{name:t,__addedByTrust:!0}),n),Et(t,ir(ir({},i),{sub_app_name:t,__addedByTrust:!0}),{platform:n});var o=Vt(e,r);Mt(t,o,r)}}}function Wn(e,t){var r=t.versionId,n=void 0===r?"":r,a=t.isLib,i=Cr(t.platform),o=Er(i,"strictMatchVer",[t.strictMatchVer]),s=ir(ir({},t),{strictMatchVer:o}),c=e,u=t.custom;dn(u)&&(c=u.appGroupName||e);var l=_t(c,i);if(t.semverApi&&!n&&l&&!0!==l.__setByLatest)return null;if(a){var p=gt(c,s),f={appName:c,appGroupName:(null==l?void 0:l.app_group_name)||"",platform:i,appProperties:p,isLib:!0,versionId:n,Comp:null,lifecycle:void 0};return p?f:null}return ht(c,s)||null}function Xn(e,t,r){var n="[[ judgeAppReady ]]",a=t.versionId,i=void 0===a?"":a,o=t.projectId,s=t.appName,c=t.platform,u=t.next,l=t.error,p=t.isLib,f=t.strictMatchVer;ft("".concat(n," receive emit app and judge (emitAppInfo, judgeOptions):"),e,{inputVer:i,projectId:o,appName:s,platform:c,isLib:p,strictMatchVer:f});var d=Cr(c),v=e.appName,h=e.appGroupName,m=e.platform,g=void 0===m?d:m,b=e.versionId,_="".concat(c,"/").concat(s,"/").concat(i),y=_t(s,c),A=r.branchId,E=r.custom,S=r.trust,L=function(e){try{var t=p?function(e,t,r){var n=r.platform,a=r.emitPlatform,i=r.versionId,o=r.emitVer;if(!gt(e,r)){Yn(e,t,r);var s=gt(t,{platform:n,versionId:i});if(!s&&a&&(s=gt(t,{platform:a,versionId:o,strictMatchVer:!1})),!s)throw new Error("seems plat ".concat(a," emit null lib for ").concat(t));return Xt(t,s,{platform:n,appName:e,versionId:i}),!1}return!0}(s,h,e):function(e,t,r){var n=r.platform,a=r.emitPlatform,i=r.versionId,o=r.emitVer;if(!ht(e,r)){Yn(e,t,r);var s=ht(t,{platform:n,versionId:i});if(!s&&a&&(s=ht(t,{platform:a,versionId:o,strictMatchVer:!1})),!s)throw new Error("seems plat ".concat(a," emit null app for ").concat(t));return ar(ir(ir({},s),{platform:n,appGroupName:t,appName:e,versionId:i})),!1}return!0}(s,h,e);return t}catch(r){return l(r),!1}};if(E){var I=E.enable,N=void 0===I||I,C=E.host,T=E.appGroupName,P=E.trust;if(N&&C)return void 0!==P&&P?void(L({versionId:i,platform:d,emitPlatform:g,emitVer:b})&&u()):void(h&&(h===s||h===T)&&u())}if(!1===f&&h&&(null==y?void 0:y.app_group_name)===h&&d===g)return ft("".concat(n," treat emitApp as wanted when strictMatchVer is false (appInfo):"),e),u();var O=function(){return ft("".concat(n," still wait ").concat(_," to be emitted (emitAppInfo,toMatch):"),e,w)},w={branchId:A,platform:c,emitVer:b,inputVer:i,projectId:o,strictMatchVer:f};if(s!==v||!sn(s,w))return O();var D=Er(d,"trustAppNames",[null,[]],{emptyArrIsNull:!1});if(d!==g&&(S||D.includes(s))&&!L({versionId:i,platform:d,emitPlatform:g,emitVer:b}))return ft("".concat(n," transfer ").concat(g," app [").concat(s,"] to ").concat(d," plat due to being in trustAppNames")),O();u()}var qn=Object.freeze({__proto__:null,getLibOrApp:Wn,judgeAppReady:Xn});function Jn(e){var t=e.platform,r=or(e,["platform"]);Bt(r,t)}function zn(){return ot()}function Qn(e){if(e&&!e.default)try{e.default=e}catch(t){}return e}function Zn(e){var t=dt();Object.keys(e).forEach((function(r){var n=e[r];n&&(t[r]=n)}))}function $n(e){var t=Qn(e.React),r=Qn(e.ReactDOM),n=e.ReactIs||null,a=e.ReactReconciler||null;Zn({LEAH_React:t,LEAH_ReactDOM:r,LEAH_ReactIs:n,LEAH_ReactReconciler:a,React:t,ReactDOM:r,ReactIs:n,ReactReconciler:a})}function ea(e){var t=Qn(e.Vue);Zn({LEAH_Vue:t,Vue:t})}function ta(e){return"".concat(an.EXTRA_DATA_PREFIX,".").concat(e)}function ra(e,t){var r,n,a=null!=t&&t,i=null!==(n=null===(r=dt().localStorage)||void 0===r?void 0:r.getItem(ta(e)))&&void 0!==n?n:null;return i?a?JSON.parse(i):i:null}function na(e,t,r){var n,a=null!=r&&r?JSON.stringify(t):t;null===(n=dt().localStorage)||void 0===n||n.setItem(ta(e),a)}function aa(e){var t;return"string"==typeof e?null===(t=dt())||void 0===t?void 0:t.document.getElementById(e):e}function ia(e,t){return{name:e,platform:(null==t?void 0:t.platform)||jt(e),versionId:(null==t?void 0:t.versionId)||"",getShadowAppRoot:aa,getShadowBodyRoot:aa}}var oa=it.getObjsVal,sa=it.purify,ca=an.ENABLE_DISK_CACHE,ua=an.ENABLE_SYNC_META,la=an.STORAGE_TYPE;function pa(e,t){var r="string"==typeof t?{versionId:t}:ir({},t||{});return r.platform=Cr(r.platform),r.isLib=e,r}function fa(e,t,r){return sr(this,void 0,void 0,(function(){var n,a,i,o,s,c,u,l,p;return cr(this,(function(f){switch(f.label){case 0:return n=Ut(),a=t.platform,i=t.isLib,o=void 0!==i&&i,s=t.versionId,c=t.projectId,u=t.strictMatchVer,l=o?tt.SUB_LIB_LOADED:tt.SUB_APP_LOADED,p=null,[4,new Promise((function(i,f){if(p=function(r){Xn(r,{appName:e,platform:a,versionId:s,projectId:c,isLib:o,next:i,error:f,strictMatchVer:u},t)},n.on(l,p),r){var d=_t(e,a);d&&function(e,t,r){if(r.shadow){if(!t)return;var n=Kn(e,r);Ct.setIgnoreCssPrefix(n),Ct.setIgnoreStyleTagKey(e),Ct.setIgnoreStyleTagKey(t),Ct.setIgnoreCssPrefixKey(n,t)}}(e,d.app_group_name,t),r()}}))];case 1:return f.sent(),p&&n.off(l,p),[2,Wn(e,t)]}}))}))}function da(e,t){return sr(this,void 0,void 0,(function(){var r,n,a,i,o,s,c,u,l,p,f;return cr(this,(function(d){switch(d.label){case 0:r=null,n=t.versionId,a=t.platform,i=t.isLib,o=t.strictMatchVer,s=t.semverApi,c=ir({},t),u=i?"preFetchLib":"preFetchApp",d.label=1;case 1:return d.trys.push([1,7,,8]),c.strictMatchVer=Er(a,"strictMatchVer",[o]),c.storageType=t.storageType||"indexedDB",c.semverApi=Er(a,"semverApi",[s]),(r=Wn(e,c))&&(!n||n&&r.versionId===n)?(ft("[[ ".concat(u," ]] return cached app:"),e,c),[2,{emitApp:r,msg:""}]):(l=null,(p=Tt(e,c))!==rt.LOADED?[3,3]:[4,fa(e,c)]);case 2:return r=d.sent(),ft("[[ ".concat(u," ]] return emit app:"),e,c,r),[2,{emitApp:r,msg:""}];case 3:return p===rt.LOADING?[3,5]:(Pt(e,rt.LOADING,c),[4,Tn(e,ir(ir({},c),{controlLoadAssets:!0}))]);case 4:l=d.sent(),d.label=5;case 5:return[4,fa(e,t,l)];case 6:return r=d.sent(),ft("[[ ".concat(u," ]] return fetch&emit app:"),e,c,r),[2,{emitApp:r,msg:""}];case 7:return f=d.sent(),console.error(f),Pt(e,rt.NOT_LOAD,c),[2,{emitApp:r,msg:f.message}];case 8:return[2]}}))}))}function va(e,t){return sr(this,void 0,Promise,(function(){var r,n,a,i,o,s,c;return cr(this,(function(u){switch(u.label){case 0:return r=pa(!0,t),[4,da(e,r)];case 1:if(n=u.sent(),a=n.emitApp,i=n.msg,!(o=null==a?void 0:a.appProperties)&&r.onLibNull&&(s=r.onLibNull(e,{versionId:r.versionId}))&&(o=s),!o)throw c=i?" details : ".concat(i):"",new Error("preFetchLib ".concat(e," fail from ").concat(r.platform,", it may be an invalid module!").concat(c));return[2,o]}}))}))}function ha(e,t){return sr(this,void 0,void 0,(function(){var r,n;return cr(this,(function(a){switch(a.label){case 0:return r=pa(!1,t),[4,da(e,r)];case 1:return[2,(null==(n=a.sent())?void 0:n.emitApp)||null]}}))}))}function ma(e,t){return sr(this,void 0,Promise,(function(){var r,n,a,i,o,s,c,u,l,p,f,d,v,h,m,g,b,_,y,A,E,S,L;return cr(this,(function(I){switch(I.label){case 0:if(r=(null==t?void 0:t.preFetchConfigs)||{},n=ir({semverApi:!1},(null==t?void 0:t.common)||{}),a=Cr(n.platform),i=n.versionIdList,o=void 0===i?[]:i,s=n.projectIdList,c=void 0===s?[]:s,u=n.branchIdList,l=void 0===u?[]:u,p=[],f=[],d=[],e.length>8)throw new Error("only support 8 appName at most!");for(b in v=[],h=[],m={},g=[],e)g.push(b);_=0,I.label=1;case 1:return _<g.length?(y=g[_],A=e[y],E=r[A],S={platform:a,versionId:o[y]||"",projectId:c[y]||"",branchId:l[y]||""},"string"==typeof E&&E?S.versionId=E:"object"==typeof E&&E&&((S=ir(ir({},S),sa(E))).platform=a),m[A]=S,S.enableDiskCache=oa([S,n],"enableDiskCache",ca),S.enableSyncMeta=oa([S,n],"enableSyncMeta",ua),S.storageType=oa([S,n],"storageType",la),[4,Sn(A,S,{callRemote:!1})]):[3,4];case 2:I.sent()||(h.push(A),p[y]=S.versionId||"",f[y]=S.projectId||"",d[y]=S.branchId||""),I.label=3;case 3:return _++,[3,1];case 4:return n.versionIdList=p,n.projectIdList=f,n.branchIdList=d,n.semverApi?[4,Promise.all(h.map((function(e){return Yr(e,m[e])})))]:[3,6];case 5:return v=I.sent(),[3,8];case 6:return[4,Xr(h,n)];case 7:v=I.sent(),I.label=8;case 8:return v.forEach((function(e){var t=e.app,r=e.version,n=m[t.name]||{};Nn(t,{appVersion:r,platform:a,toDisk:n.enableDiskCache,loadOptions:n})})),L=e.map((function(e){return va(e,m[e])})),[4,Promise.all(L)];case 9:return[2,I.sent()]}}))}))}var ga=Object.freeze({__proto__:null,core:n,VER:nr,emitApp:ar,appMetaSrv:Pn,appParamSrv:xn,appStyleSrv:Un,logicSrv:qn,init:Jn,isSubApp:zn,bindExternals:Zn,bindReactRuntime:$n,bindVueRuntime:ea,getExtraData:ra,setExtraData:na,getFakeHelContext:ia,batchPreFetchLib:ma,preFetchApp:ha,preFetchLib:va}),ba=it.purify,_a=Yt(),ya=["eventBus","getExtraData","setExtraData","bindExternals","bindVueRuntime","bindReactRuntime","isSubApp"],Aa={ignoreFns:["tryGetAppName","log","commonUtil","getCommonData","setCommonData","setGlobalThis"],arg1PlatFns:["getPlatformConfig","getSharedCache"],arg2PlatFns:["initPlatformConfig","getAppMeta","setAppMeta","tryGetVersion","setAppPlatform"],arg2PlatObjFns:[]},Ea=["preFetchLib","preFetchApp"],Sa=["getSubAppMeta","getMetaDataUrl"],La=["emitApp","init"];function Ia(e,t,r){var n=r.preFetchOptions,a=r.isCore,i={};return Object.keys(t).forEach((function(o){var s=t[o];if(ya.includes(o))i[o]=s;else{var c=typeof s;if("function"!==c)if(s&&"object"===c){var u=ir(ir({},r),{isCore:"core"===o});i[o]=Ia(e,s,u)}else i[o]=s;else{var l={fnName:o,fn:s,isCore:a,preFetchOptions:n};i[o]=function(e,t){var r=this,n=t.fnName,a=t.fn,i=t.isCore,o=t.preFetchOptions;return function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];var c=function(t){return ir({platform:e},ba(t||{}))},u=t[0],l=t[1],p=t[2];if(i){if("getPlatform"===n)return e;Aa.arg1PlatFns.includes(n)?t[0]=u||e:Aa.arg2PlatFns.includes(n)?t[1]=l||e:Aa.arg2PlatObjFns.includes(n)?t[1]=c(l):Aa.ignoreFns.includes(n)||(n.startsWith("set")?t[2]=c(p):t[1]=c(l))}else if("batchPreFetchLib"===n){var f=l||{},d=c(f.common);t[1]=ir(ir({},f),{common:d})}else if(Ea.includes(n)){var v=ba("string"==typeof l?{versionId:l}:l||{});o&&(v=ba(ir(ir({},o),v))),t[1]=ir({platform:e},v)}else if(Sa.includes(n)){var h=(o||{}).semverApi,m=void 0===h||h;t[1]=c(ir({semverApi:m},ba(l||{})))}else La.includes(n)?t[0]=c(u):t[1]=c(l);return a.apply(r,t)}}(e,l)}}})),i}function Na(e,t){var r=Ia(e,ga,{preFetchOptions:t});return r.createInstance=Na,r.createOriginInstance=Ca,r.resetGlobalThis=st,r.eventBus=_a,r.default=r,r}function Ca(e,t){var r=t||{};r.trustAppNames;var n=or(r,["trustAppNames"]);return Ht(e,t),Na(e,n)}var Ta=nr,Pa=va,Oa=ha,wa=ma,Da=Un,xa=xn,Va=Pn,Ma=qn,Ra=ar,Fa=Jn,ka=zn,ja=ia,Ga=ra,Ba=na,Ha=Zn,Ka=ea,Ua=$n,Ya=n,Wa=st,Xa=Na,qa=Ca,Ja=Yt();Ya.log("hel-micro ver ".concat(Ta));var za={VER:Ta,preFetchLib:Pa,preFetchApp:Oa,batchPreFetchLib:wa,appStyleSrv:Da,appParamSrv:xa,appMetaSrv:Va,logicSrv:Ma,emitApp:Ra,eventBus:Ja,init:Fa,isSubApp:ka,getFakeHelContext:ja,getExtraData:Ga,setExtraData:Ba,bindExternals:Ha,bindVueRuntime:Ka,bindReactRuntime:Ua,resetGlobalThis:Wa,core:n,createInstance:Xa,createOriginInstance:qa}}}]);