/*! For license information please see 5644.6fe2906b.js.LICENSE.txt */
"use strict";(self.webpackChunkhel_doc=self.webpackChunkhel_doc||[]).push([[5644],{5644:(e,t,r)=>{r.r(t),r.d(t,{VER:()=>In,appMetaSrv:()=>Cn,appParamSrv:()=>Vn,appStyleSrv:()=>On,batchPreFetchLib:()=>wn,bindExternals:()=>kn,bindReactRuntime:()=>Un,bindVueRuntime:()=>Gn,core:()=>Bn,createInstance:()=>Kn,createOriginInstance:()=>Wn,default:()=>qn,emitApp:()=>Mn,eventBus:()=>Yn,getExtraData:()=>xn,getFakeHelContext:()=>Fn,init:()=>Tn,isSubApp:()=>Rn,logicSrv:()=>Dn,preFetchApp:()=>Pn,preFetchLib:()=>Nn,resetGlobalThis:()=>Hn,setExtraData:()=>jn});var n={};function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,s=[],c=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(l){u=!0,a=l}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return s}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.r(n),r.d(n,{allowLog:()=>we,appReady:()=>ut,commonUtil:()=>Ee,getAppMeta:()=>xe,getAppPlatform:()=>rt,getAppStyleStr:()=>Je,getCommonData:()=>He,getCustomData:()=>Ue,getGlobalThis:()=>Ce,getHelDebug:()=>Ve,getHelEventBus:()=>it,getPlatform:()=>Ne,getPlatformConfig:()=>tt,getSharedCache:()=>Pe,getUserEventBus:()=>st,getVerApp:()=>Me,getVerExtraCssList:()=>$e,getVerLib:()=>Re,getVerLoadStatus:()=>We,getVerStyleStrStatus:()=>qe,getVersion:()=>ke,helConsts:()=>Ae,helEvents:()=>ye,helLoadStatus:()=>_e,inectPlatToMod:()=>Se,initPlatformConfig:()=>at,isSubApp:()=>Le,libReady:()=>ct,log:()=>Oe,originInit:()=>ot,resetGlobalThis:()=>Ie,setAppMeta:()=>je,setAppPlatform:()=>nt,setAppStyleStr:()=>ze,setCommonData:()=>Ke,setCustomData:()=>Be,setEmitApp:()=>Te,setEmitLib:()=>Fe,setGlobalThis:()=>De,setVerExtraCssList:()=>Qe,setVerLoadStatus:()=>Ye,setVerStyleStrStatus:()=>Xe,setVersion:()=>Ge,tryGetAppName:()=>et,tryGetVersion:()=>Ze});var f=null;function d(){return f||function(){if("undefined"==typeof window)throw void 0!==r.g&&(f=r.g),new Error("unable to locate global object");f=window}()}function v(){return d()}function m(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.nullValues,n=void 0===r?[null,void 0,""]:r,a=t.emptyObjIsNull,o=void 0===a||a,s=t.emptyArrIsNull,c=void 0===s||s;if(n.includes(e))return!0;if(Array.isArray(e))return!!c&&0===e.length;if("object"===i(e)){var u=g(e).length;return!!o&&0===u}return!1}function b(e,t){e.includes(t)||e.push(t)}function g(e){return Object.keys(e)}function y(e,t){var r=t||function(e){return!h(e)},n={};return g(e).forEach((function(t){r(e[t])&&(n[t]=e[t])})),n}function _(e){return e.split("\n").filter((function(e){return!!e})).map((function(e){var t;return(null===(t=e.trimStart)||void 0===t?void 0:t.call(e))||e})).map((function(e){return e.endsWith(" ")?e:"".concat(e," ")})).join("")}function A(e,t,r){e.dataset?e.dataset[t]=r:e.setAttribute("data-".concat(t),r)}var S=Object.freeze({__proto__:null,noop:m,safeParse:function(e,t,r){if(e&&"string"!=typeof e)return e;try{return JSON.parse(e)||t}catch(n){if(void 0!==t)return t;if(r)throw new Error(r);throw n}},isNull:h,noDupPush:b,merge2List:function(e,t){var r=[];return e.forEach((function(e){return b(r,e)})),t.forEach((function(e){return b(r,e)})),r},okeys:g,purify:y,getObjsVal:function(e,t,r){var n,a=r,o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=l(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}(e);try{for(o.s();!(n=o.n()).done;){var i=n.value[t];if(![null,void 0,""].includes(i)){a=i;break}}}catch(s){o.e(s)}finally{o.f()}return a},nbstr:_,nbalert:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=d(),n=_(e),a=r.alert||m;t?r.location.port&&a(n):a(n)},setDataset:A});var E={};try{E=v().__HEL_MICRO_DEBUG__}catch(Xn){}function L(){return E}!function(){if(h(E)){E={logMode:0,logFilter:"",isInit:!1};try{v().__HEL_MICRO_DEBUG__=E}catch(Xn){}}else void 0===E.logMode&&(E.logMode=0,E.logFilter="")}();var I="unpkg",N="__default_online_ver__",P=I,w={CORE_VER:"4.2.3",DEFAULT_API_PREFIX:"https://unpkg.com",DEFAULT_API_URL:"/openapi/v1/app/info",DEFAULT_ONLINE_VER:N,DEFAULT_USER_LS_KEY:"HelUserRtxName",DEFAULT_PLAT:P,PLAT_HEL:"hel",PLAT_UNPKG:I,KEY_CSS_STR:"CSS_STR",KEY_ASSET_CTX:"ASSET_CTX"},O={SUB_APP_LOADED:"subAppLoaded",SUB_LIB_LOADED:"SubLibLoaded",STYLE_STR_FETCHED:"StyleStrFetched"},V={NOT_LOAD:0,LOADING:1,LOADED:2};try{!function(){if(L().isInit)return;L().isInit=!0;var e=function(){var e=function(){try{var e,t;return(null===(e=d().top)||void 0===e||null===(t=e.location)||void 0===t?void 0:t.search)||""}catch(Xn){var r,n;return(null===(r=d())||void 0===r||null===(n=r.location)||void 0===n?void 0:n.search)||""}}(),t={};if(null!=e&&e.startsWith("?")){e.substring(1).split("&").forEach((function(e){var r=c(e.split("="),2),n=r[0],a=r[1];t[n]=a}))}return t}(),t=e.hellog,r=e.hellogf,n=d().localStorage;D(t||(null==n?void 0:n.getItem("HelConfig.logMode"))||0),T(r||(null==n?void 0:n.getItem("HelConfig.logFilter"))||"")}()}catch(Xn){}function C(){return 0!==M()}function D(e){var t=parseInt(e,10);[1,2].includes(t)&&(L().logMode=t)}function M(){return L().logMode}function T(e){L().logFilter=e}var R="  %c--\x3e HEL LOG:",F="color:#ad4e00;font-weight:600";function x(){if(C()){for(var e=1===M()?console.log:console.trace||console.log,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],o=r.slice(1);if("string"!=typeof a)return e.apply(void 0,[R,F].concat(r));var i=L().logFilter,s=["".concat(R," ").concat(a),F].concat(u(o));i?function(e,t){return t.includes(",")?t.split(",").some((function(t){return e.includes(t)})):e.includes(t)}(a,i)&&e.apply(void 0,u(s)):e.apply(void 0,u(s))}}function j(){var e="";try{throw new Error("getJsRunLocation")}catch(Xn){var t=Xn.stack.split("\n");e=t[t.length-1]||""}return e}function k(e,t,r,n){G(e,t)[r]=n}function G(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=e[t];return n||(n=r,e[t]=n),n}function U(e,t){Object.keys(t).forEach((function(r){var n=t[r];[null,void 0,""].includes(n)||(e[r]=n)}))}var B=w.DEFAULT_API_URL,H=w.DEFAULT_USER_LS_KEY,K=w.PLAT_HEL,W=w.PLAT_UNPKG,Y=w.DEFAULT_API_PREFIX,q=w.CORE_VER;function X(e){return{apiMode:"get",apiPrefix:(e||{}).apiPrefix,apiSuffix:"",apiPathOfApp:B,apiPathOfAppVersion:"",getSubAppAndItsVersionFn:null,onFetchMetaFailed:null,strictMatchVer:!0,getUserName:null,userLsKey:H,shouldUseGray:null,trustAppNames:null,semverApi:null,hook:{}}}function J(e){return o(o({isConfigOverwrite:!1,platform:e,appName2Comp:{},appName2Lib:{},appName2isLibAssigned:{},appName2EmitApp:{},appName2verLoadStatus:{},appName2verEmitLib:{},appName2verEmitApp:{},appName2verStyleStr:{},appName2verStyleFetched:{},appName2verExtraCssList:{},appName2verAppVersion:{},appName2verCustomData:{},appName2app:{},appName2appVersion:{},appName2styleStr:{},appGroupName2firstVer:{},isOriginInitCalled:!1},X()),{},{origin:X({apiPrefix:Y})})}function z(){var e={};return{on:function(t,r){var n=e[t];if(!n){var a=[];e[t]=a,n=a}n.push(r)},emit:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];var o=e[t];o&&o.slice().forEach((function(e){return e.apply(void 0,n)}))},off:function(t,r){var n=e[t];if(n)for(var a=0,o=n.length;a<o;a++){if(n[a]===r){n.splice(a,1);break}}}}}function $(){var e=Q();if(e){var t=e.cacheRoot;G(t,"appGroupName2platform"),G(t,"common");var r=t.caches;return Object.keys(r).forEach((function(e){var t=r[e];G(t,"appGroupName2firstVer"),G(t,"appName2verExtraCssList"),G(t,"appName2verCustomData"),G(t,"hook"),G(t,"origin",X()),G(t.origin,"hook")})),void(e.userEventBus||(e.userEventBus=z()))}e=function(){var e,t=J(W),r=J(K),n={platform:W,appName2platform:{},appGroupName2platform:{},caches:(e={},s(e,W,t),s(e,K,r),e),common:{}},a=z(),o=z();return{ver:q,nativeHeadAppend:null,nativeBodyAppend:null,createFeature:j(),eventBus:a,userEventBus:o,cacheRoot:n,unpkgCache:t,helCache:r,dev:{setLogMode:D,setLogFilter:T}}}(),v().__HEL_MICRO_SHARED__=e}function Q(){return v().__HEL_MICRO_SHARED__}function Z(){return Q().cacheRoot.platform||P}function ee(e){var t=e||Z(),r=te(),n=r.caches[t];if(!n){var a=J(e);r.caches[t]=a,n=a}return n}function te(){return Q().cacheRoot}var re={getCustomData:function(e,t,r){var n=r.versionId,a=G(ee(r.platform).appName2verCustomData,e);return G(a,t)[n||N]},getAppMeta:function(e,t){return ee(t).appName2app[e]},setVerLoadStatus:function(e,t,r,n){var a=n||{},o=a.versionId;k(ee(a.platform)[r],e,o||N,t)},getVerLoadStatus:function(e,t,r){var n,a=r||{},o=a.versionId,i=ee(a.platform)[t],s=o||N;return(null===(n=i[e])||void 0===n?void 0:n[s])||V.NOT_LOAD},ensureOnlineModule:function(e,t,r){if(!e[N]){var n=re.getAppMeta(t,r),a=e[null==n?void 0:n.online_version];a&&(e[N]=a)}}};function ne(e,t){x("[[ core:setEmitApp ]] appName,emitApp:",e,t);var r=t.versionId,n=ee(t.platform),a=n.appName2verEmitApp,o=n.appName2Comp,i=n.appName2EmitApp;G(a,e)[N]||(o[e]=t.Comp,i[e]=t,k(a,e,N,t)),r&&k(a,e,r,t)}function ae(e){return G(te().common,e)}function oe(e,t){var r=ae(e)[t];return void 0!==r?r:null}function ie(e,t){var r=e.apiMode,n=e.apiPrefix,a=e.apiSuffix,o=e.apiPathOfApp,i=e.apiPathOfAppVersion,s=e.getSubAppAndItsVersionFn,c=e.onFetchMetaFailed,u=e.strictMatchVer,l=e.getUserName,p=e.userLsKey,f=e.shouldUseGray,d=e.getApiPrefix,v=e.trustAppNames,m=e.platform,h=e.origin,b={apiMode:r,apiPrefix:n,apiSuffix:a,apiPathOfApp:o,apiPathOfAppVersion:i,getSubAppAndItsVersionFn:s,onFetchMetaFailed:c,strictMatchVer:u,getUserName:l,userLsKey:p,shouldUseGray:f,getApiPrefix:d,trustAppNames:v,hook:e.hook,platform:m};return t&&(b.origin=h),b}function se(e){return te().appGroupName2platform[e]||Z()}function ce(e,t){var r=t.customKey,n=G(ee(t.platform).appName2verCustomData,e);return G(n,r)}function ue(){return Q().eventBus}function le(e,t,r){var n=(r||{}).appGroupName,a=t.versionId,o=t.appProperties,s=t.platform||r.platform,c=ee(s),u=c.appName2verEmitLib,l=c.appName2Lib,p=c.appName2isLibAssigned,f=re.getAppMeta(e,s),d=function(e){var t=l[e];t?"object"===i(t)&&0===Object.keys(t).length&&Object.assign(t,o):l[e]=o,p[e]=!0};d(e),n?d(n):f&&d(f.app_group_name),x("[[ core:setEmitLib ]] appMeta:",f),G(u,e)[N]||k(u,e,N,o),a&&k(u,e,a,o)}function pe(e,t){return ee(t).appName2app[e]}function fe(e,t,r){re.setVerLoadStatus(e,t,"appName2verLoadStatus",r)}function de(e,t){var r=j();x("[[ core:tryGetVersion ]] may include source > ".concat(r));var n=ee(t).appGroupName2firstVer[e]||"";if(r.includes("https://")||r.includes("http://")){var a=c(r.split("//"),2)[1].split("/");if(n){if(t===P&&a.some((function(e){return e.includes(n)})))return n;if(a.includes(n))return n;if("static"===a[1]&&"js"===a[2]||"js"===a[1])return n}return t===P?a[1].split("@")[1]||n:a[2]||n}return n}function ve(e,t){return e===N?t||"":e.includes("_")?e.substring(0,e.length-15):t||""}var me=!1,he=!1;var be=w.KEY_ASSET_CTX;function ge(e,t){if(!t||!["LINK","SCRIPT"].includes(t.tagName))return e(t);var r=t.href,n=t.tagName,a=t.src,o="LINK"===n,i=oe(be,r||a)||{},s=i.platform,c=i.groupName,u=i.name,l=i.ver,p=i.beforeAppend;if(!1===i.append&&o)return t;var f=t;if(p){var d=o?"href":"src",v=t.getAttribute(d);f=p({el:t,nativeAppend:e,setAssetUrl:function(e){return t.setAttribute(d,e)},url:v,tagName:n})||t}return s&&function(e,t){var r=t.platform,n=t.groupName,a=t.name,o=t.ver,i=t.id;e.id=i,A(e,"plat",r),A(e,"gname",n),A(e,"name",a),A(e,"ver",o)}(f,{platform:s,groupName:c,name:u,ver:l,id:o?"HelLink":"HelScript"}),e(f)}x("hel-micro-core ver ".concat(w.CORE_VER));var ye=O,_e=V,Ae=w,Se=function e(t,r,n){var a=n||{},s=a.ignoreKeys,c=void 0===s?[]:s,u=a.arg1PlatObjFnKeys,l=void 0===u?[]:u,p={};return Object.keys(r).forEach((function(a){var s=r[a];if(c.includes(a))p[a]=s;else{var u=i(s);p[a]=u&&"object"===u?e(t,s,n):"function"!==u?s:function(e,t){var r=this,n=t.fn,a=t.fnName,i=t.arg1PlatObjFnKeys.includes(a);return function(){for(var t=function(t){return o({platform:e},y(t||{}))},a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];var u=s[0],l=s[1];return i?s[0]=t(u):s[1]=t(l),n.apply(r,s)}}(t,{arg1PlatObjFnKeys:l,fn:s,fnName:a})}})),p},Ee=S,Le=function(){return"more details see: https://tnfe.github.io/hel/docs/tutorial/attention-is-subapp",console.log("%c".concat("WARNING: calling isSubApp is unsafe, use hel-iso.isSubApp instead,\nmore details see: https://tnfe.github.io/hel/docs/tutorial/attention-is-subapp"),"color:red;"),!me};function Ie(e){e&&De(e),function(e){if(e&&(me=!1,he=!1),!he){he=!0;var t=d();void 0===t.__MASTER_APP_LOADED__&&(t.__MASTER_APP_LOADED__=!0,me=!0)}}(!!e),$(),function(){var e=Q(),t=d().document,r=e.nativeHeadAppend,n=e.nativeBodyAppend;if(!r&&t){var a=t.head,o=t.body;r=a.appendChild.bind(a),n=o.appendChild.bind(o),e.nativeHeadAppend=r,e.nativeBodyAppend=n,t.head.appendChild=function(e){return ge(r,e)},t.body.appendChild=function(e){return ge(n,e)}}}()}Ie();var Ne=Z,Pe=ee,we=C,Oe=x,Ve=L,Ce=d,De=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null;null!==(t=f)&&void 0!==t&&t.__HEL_MICRO_SHARED__&&(n=f.__HEL_MICRO_SHARED__),f=r?o(o({},f),e):e,n&&(f.__HEL_MICRO_SHARED__=n)},Me=function(e,t){var r,n=t||{},a=n.versionId,o=n.platform,i=ee(o),s=i.appName2verEmitApp,c=i.appName2Comp,u=i.strictMatchVer,l=i.appName2EmitApp,p=null!==(r=n.strictMatchVer)&&void 0!==r?r:u,f=G(s,e);re.ensureOnlineModule(f,e,o);var d=f[a||N],v=c[e],m=v?{Comp:v}:null,h=p?null:l[e]||m,b=d||h||null;return x("[[ core:getVerApp ]] appName,options,result:",e,n,b),b},Te=ne,Re=function(e,t){var r,n=t||{},a=n.versionId,o=ee(n.platform),i=o.appName2verEmitLib,s=o.appName2Lib,c=o.strictMatchVer,u=o.appName2isLibAssigned,l=null!==(r=n.strictMatchVer)&&void 0!==r?r:c,p=G(i,e);re.ensureOnlineModule(p,e);var f=p[a||N],d=u[e]?s[e]:null,v=f||(l?null:d)||null;return x("[[ core:getVerLib ]] appName,options,result:",e,n,v),v},Fe=le,xe=pe,je=function(e,t){ee(t).appName2app[e.name]=e},ke=function(e,t){var r,n=t||{},a=n.platform,o=n.versionId,i=ee(a),s=i.appName2verAppVersion,c=i.appName2appVersion[e]||null;return o&&(null===(r=s[e])||void 0===r?void 0:r[o])||c},Ge=function(e,t,r){var n=(r||{}).platform,a=ee(n),o=a.appName2verAppVersion,i=a.appGroupName2firstVer,s=a.appName2appVersion,c=t.sub_app_version;if(c){var u=re.getAppMeta(e,n);G(o,e)[N]||(k(o,e,N,t),s[e]=t),k(o,e,c,t),i[u.app_group_name]=c}},Ue=function(e,t){var r=ce(e,t)[t.versionId||N];return void 0!==r?r:null},Be=function(e,t){var r=t.customValue,n=t.versionId;ce(e,t)[n||N]=r},He=oe,Ke=function(e,t,r){ae(e)[t]=r},We=function(e,t){return re.getVerLoadStatus(e,"appName2verLoadStatus",t)},Ye=fe,qe=function(e,t){return re.getVerLoadStatus(e,"appName2verStyleFetched",t)},Xe=function(e,t,r){re.setVerLoadStatus(e,t,"appName2verStyleFetched",r)},Je=function(e,t){var r,n=t||{},a=n.platform,o=n.versionId,i=ee(a),s=i.appName2verStyleStr,c=i.appName2styleStr[e]||"";return o?(null===(r=s[e])||void 0===r?void 0:r[o])||c||"":c},ze=function(e,t,r){var n=r||{},a=n.platform,o=n.versionId,i=ee(a),s=i.appName2verStyleStr,c=i.appName2verStyleFetched,u=i.appName2styleStr;o?(k(s,e,o,t),k(c,e,o,V.LOADED)):u[e]=t},$e=function(e,t){var r=t||{},n=r.versionId,a=G(ee(r.platform).appName2verExtraCssList,e),o=a[n]||a[N]||[];return x("[[ core:getVerExtraCssList ]] options,cssList:",r,o),o},Qe=function(e,t,r){var n=r||{},a=n.versionId,o=ee(n.platform).appName2verExtraCssList;x("[[ core:setVerExtraCssList ]] cssList:",t),G(o,e)[N]||k(o,e,N,t),a&&k(o,e,a,t)},Ze=de,et=ve,tt=function(e){return ie(ee(e),!0)},rt=se,nt=function(e,t){return te().appGroupName2platform[e]=t,se(e)},at=function(e,t){var r=ee(t),n=ie(e);r.isConfigOverwrite||(r.isConfigOverwrite=!0,U(r,n))},ot=function(e,t){var r=ee(e),n="[[ core:originInit ]] invalid call, it can only been called";if(r.isConfigOverwrite)x("".concat(n," before init"));else if(r.isOriginInitCalled)x("".concat(n," one time"));else{var a=ie(t);r.isOriginInitCalled=!0,U(r.origin,a)}},it=ue,st=function(){return Q().userEventBus},ct=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.platform||se(e),a=r.versionId||de(e,n),o=r.appName||ve(a,e),i=pe(o,n);null!=i&&i.__fromCust&&(a=i.online_version,o=i.name);var s={platform:n,appName:o,appGroupName:e,versionId:a,appProperties:t,Comp:function(){},lifecycle:{}};le(o,s,{appGroupName:e,platform:n}),fe(o,V.LOADED,{versionId:a,platform:n}),ue().emit(O.SUB_LIB_LOADED,s)},ut=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.lifecycle,a=r.platform||se(e),o=r.versionId||de(e,a),i=r.appName||ve(o,e),s={Comp:t,appName:i,appGroupName:e,lifecycle:n,platform:a,versionId:o,isLib:!1};ne(i,s),fe(i,V.LOADED,{versionId:o,platform:a}),ue().emit(O.SUB_APP_LOADED,s)},lt="4.2.0";function pt(e){var t=e.appGroupName,r=e.Comp,n=e.platform,a=e.lifecycle,o=e.appName,i=e.versionId;ut(t,r,{lifecycle:a,platform:n,appName:o,versionId:i})}var ft=function(){return ft=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},ft.apply(this,arguments)};function dt(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}function vt(e,t,r,n){return new(r||(r=Promise))((function(a,o){function i(e){try{c(n.next(e))}catch(t){o(t)}}function s(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((n=n.apply(e,t||[])).next())}))}function mt(e,t){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(s){o=[6,s],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var ht={GET_APP_AND_VER:"getSubAppAndItsVersion",GET_APP_AND_FULL_VER:"getSubAppAndItsFullVersion",BATCH_GET_APP_AND_VER:"batchGetSubAppAndItsVersion",BATCH_GET_APP_AND_FULL_VER:"batchGetSubAppAndItsFullVersion",GET_APP_VER:"getSubAppVersion",GET_APP_FULL_VER:"getSubAppFullVersion"},bt="get",gt="Jsonp",yt={LS_CACHE_APP_PREFIX:"HelAppCache",DATABASE_NAME:"HelIndexedDB",STORE_NAME:"HelMetaData"},_t={};function At(){return"indexedDB"in Ce()?Ce().indexedDB:(console.warn("The current browser is not support indexedDB!"),null)}var St=function(){function e(e){this.dbInfo={db:null,name:"",storeName:"",version:1},this.ready=null,this.initStorage(e)}return e.prototype.initStorage=function(e){var t=At();if(t){var r=null,n=null;this.ready=new Promise((function(e,t){r=e,n=t}));var a=this.dbInfo;if(e){var o=e.name,i=e.storeName,s=e.version;Object.assign(a,Ee.purify({name:o,storeName:i,version:s}))}var c=_t[a.name];c||(c={db:null,name:"",storeName:"",version:1},_t[a.name]=c),a.db=c.db;var u=this.isUpgradeNeeded(a);if(a.db){if(!u)return void r(a);a.db.close()}var l=[a.name,void 0];u&&(l[1]=a.version);var p=t.open.apply(t,l);u&&(p.onupgradeneeded=function(e){c.db=p.result,a.db=p.result;try{a.db.createObjectStore(a.storeName)}catch(Xn){if("ConstraintError"!==Xn.name)throw Xn;var t=Ee.nbstr('\n              The database "'.concat(a.name,'"\n              has been upgraded from version ').concat(e.oldVersion," to version ").concat(e.newVersion,',\n              but the storage "').concat(a.storeName,'" already exists.'));console.warn(t)}}),p.onerror=function(){n(p.error)},p.onsuccess=function(){a.db=p.result,c.db=p.result,a.db.onversionchange=function(e){e.target.close()},r(a)}}},e.prototype.isUpgradeNeeded=function(e){if(!e.db)return!0;var t=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,n=e.version>e.db.version;if(r&&(console.warn('The database "'.concat(e.name,"\" can't be downgraded from version ").concat(e.db.version," to version ").concat(e.version)),e.version=e.db.version),n||t){if(t){var a=e.db.version+1;a>e.version&&(e.version=a)}return!0}return!1},e.prototype.getObjectStore=function(e){return vt(this,void 0,Promise,(function(){var t,r,n,a;return mt(this,(function(o){switch(o.label){case 0:return[4,this.getDbInfo()];case 1:if(t=o.sent(),r=t.name,n=t.db,a=t.storeName,!n)throw new Error("get ".concat(a," objectStore failed in ").concat(r," database"));return[2,n.transaction(a,e||"readonly").objectStore(a)]}}))}))},e.prototype.attachHandler=function(e,t,r){e.onsuccess=function(){t(e.result||null)},e.onerror=function(){r(e.error)}},e.prototype.getItem=function(e){var t=this;return new Promise((function(r,n){t.getObjectStore().then((function(a){var o=a.get(e);t.attachHandler(o,r,n)})).catch(n)}))},e.prototype.setItem=function(e,t){var r=this;return new Promise((function(n,a){r.getObjectStore("readwrite").then((function(o){var i=o.put(t,e);r.attachHandler(i,n,a)})).catch(a)}))},e.prototype.removeItem=function(e){var t=this;return new Promise((function(r,n){t.getObjectStore("readwrite").then((function(a){var o=a.delete(e);t.attachHandler(o,r,n)})).catch(n)}))},e.prototype.getDbInfo=function(){return this.ready?this.ready:Promise.reject("forget init")},e}();function Et(){if(!At())return null;var e=new St({name:yt.DATABASE_NAME,storeName:yt.STORE_NAME});return{getItem:function(t){return e.getItem(t)},setItem:function(t,r){return e.setItem(t,r)},removeItem:function(t){return e.removeItem(t)}}}function Lt(){var e,t={getItem:function(){},setItem:function(){},removeItem:function(){}};try{return(null===(e=Ce())||void 0===e?void 0:e.localStorage)||t}catch(Xn){return t}}var It=Object.freeze({__proto__:null,getUserName:function(e){var t=e.userLsKey,r=Lt().getItem(t)||"";if(r)return r;try{var n={};Ce().document.cookie.split(";").forEach((function(e){var t=e.split("="),r=t[0],a=t[1];n[r]=a})),r=n[t]||"",Oe("[[ getUserName ]] result:",r)}catch(Xn){Oe("[[ getUserName ]] err:",Xn)}return r}}),Nt=Ee.isNull;function Pt(e,t,r){var n=tt(e),a=n.origin,o=n[t],i=a[t];return r||o||i}function wt(e,t,r,n){var a=r||[],o=a[0],i=a[1];if(!Nt(o,n))return o;var s=tt(e),c=s.origin,u=s[t];if(!Nt(u,n))return u;var l=c[t];return Nt(l,n)?i:l}function Ot(e,t){var r,n=tt(e.platform),a=e.hook||{},o=n.origin,i=n.hook;return a[t]||i[t]||(null===(r=o.hook)||void 0===r?void 0:r[t])}function Vt(e,t){var r,n,a,o="";if(t&&(o=(null===(r=t.getApiPrefix)||void 0===r?void 0:r.call(t))||t.apiPrefix),o)return o;var i=tt(e);if(o=(null===(n=i.getApiPrefix)||void 0===n?void 0:n.call(i))||i.apiPrefix)return o;var s=i.origin;return o=(null===(a=s.getApiPrefix)||void 0===a?void 0:a.call(s))||s.apiPrefix}var Ct={now:function(){return(new Date).getTime()},rand:function(){return Math.random().toString().substring(6)},removeElem:function(e){var t=e.parentNode;t&&11!==t.nodeType&&t.removeChild(e)},parseData:function(e){var t="";if("string"==typeof e)t=e;else if("object"==typeof e)for(var r in e)t+="".concat(t,"&").concat(r,"=").concat(encodeURIComponent(e[r]));return t=(t+="&_t=".concat(Ct.now())).substring(1)},getJSON:function(e,t){return new Promise((function(r,n){var a="",o=e;o=o+(-1===o.indexOf("?")?"?":"&")+Ct.parseData(t);var i=/callback=(\w+)/.exec(o);a=(null==i?void 0:i[1])?i[1]:"helJsonp_".concat(Ct.now(),"_").concat(Ct.rand()),o=o.includes("?")?"".concat(o,"&callback=").concat(a):"".concat(o,"?callback=").concat(a);var s=Ce(),c=s.document,u=c.createElement("script");u.type="text/javascript",u.src=o,u.id=a,u.onerror=n,u.addEventListener("error",n),s[a]=function(e){delete s[a];var t=c.getElementById(a);return t&&Ct.removeElem(t),r(e)};var l=c.getElementsByTagName("head");(null==l?void 0:l[0])&&l[0].appendChild(u)}))}},Dt=Ct.getJSON;function Mt(e){return e||Ne()}function Tt(e,t){return vt(this,void 0,Promise,(function(){var r,n,a;return mt(this,(function(o){switch(o.label){case 0:return n=(r=t||{}).method,a=dt(r,["method"]),[4,new Rt(a).request(e,n)];case 1:return[2,o.sent()]}}))}))}var Rt=function(){function e(e){this.req=null,this.resultPromise=Promise.resolve(null),this.init(e||{})}return e.prototype.init=function(e){var t="XMLHttpRequest"in Ce()?new XMLHttpRequest:null;if(!t)throw new Error("current browser is not support XMLHttpRequest!");this.req=t;var r=e.responseType,n=e.timeout,a=void 0===n?1e4:n,o=e.withCredentials,i=e.headers;t.responseType=r||"json",t.timeout=a,t.withCredentials=!!o,i&&Object.keys(i).forEach((function(e){t.setRequestHeader(e,i[e])}));var s=null,c=null;this.resultPromise=new Promise((function(e,t){s=e,c=t}));var u=function(e){var r=t.status,n=t.statusText,a=t.responseURL;c({msg:e,status:r,statusText:n,url:a})};t.onload=function(){return e=t.response,r=t.status,n=t.statusText,a=t.responseURL,void s({data:e,status:r,statusText:n,url:a});var e,r,n,a},t.onerror=function(e){return u(e)},t.onabort=function(e){return u(e)},t.ontimeout=function(e){return u(e)},t.onprogress=function(){}},e.prototype.request=function(e,t){return vt(this,void 0,Promise,(function(){return mt(this,(function(r){switch(r.label){case 0:if(!this.req)throw new Error("forget init");return this.req.open(t?t.toUpperCase():"GET",e),this.req.send(),[4,this.resultPromise];case 1:return[2,r.sent()]}}))}))},e}();function Ft(e,t){return vt(this,void 0,void 0,(function(){var r,n,a;return mt(this,(function(o){switch(o.label){case 0:return"try_detect_latest_ver",[4,kt("".concat(t,"/").concat(e,"@latest/").concat("try_detect_latest_ver","_").concat(Date.now()))];case 1:return r=o.sent().url,n=r.split("@"),a=n[1],[2,a.split("/")[0]]}}))}))}function xt(e,t){return vt(this,void 0,void 0,(function(){var r,n,a,o,i;return mt(this,(function(s){switch(s.label){case 0:return[4,Ce().fetch(e)];case 1:return r=s.sent(),n=r.status,a=r.url,[200,304].includes(n)?t?[4,r.json()]:[3,3]:[2,{url:a,reply:null}];case 2:return o=s.sent(),[2,{url:a,reply:o}];case 3:return[4,r.text()];case 4:return i=s.sent(),[2,{url:a,reply:i}]}}))}))}function jt(e,t){return vt(this,void 0,void 0,(function(){var r,n,a,o,i;return mt(this,(function(s){switch(s.label){case 0:return[4,Tt(e,{method:"GET",responseType:t?"json":"text"})];case 1:return r=s.sent(),n=r.status,a=r.data,o=r.url,i=void 0===o?"":o,400===n?[2,{url:i,reply:null}]:[2,{url:i,reply:a}]}}))}))}function kt(e,t){return void 0===t&&(t=!0),vt(this,void 0,void 0,(function(){var r;return mt(this,(function(n){switch(n.label){case 0:return r=jt,Ce().fetch&&(r=xt),[4,r(e,t)];case 1:return[2,n.sent()]}}))}))}function Gt(e){var t=e.extraCssList,r=void 0===t?[]:t,n=e.custom;if(n){var a=n.extraCssList,o=void 0===a?[]:a,i=n.enable;if(void 0===i||i)return Ee.merge2List(r,o)}return r}var Ut=Ee.safeParse,Bt={handleSemverRet:function(e,t){var r=(e||{}).version,n=e;return t.onlyVersion&&(n=r),!t.isFullVersion&&r&&Reflect.deleteProperty(r,"html_content"),r?{data:n,code:"0",msg:""}:{data:null,code:"404",msg:"no version found"}},appendSearchKV:function(e,t,r){var n=e;return r&&(n+="&".concat(t,"=").concat(r)),n},appendSuffix:function(e,t){var r=e;return t&&(r+=t),r}};function Ht(e,t){return vt(this,void 0,Promise,(function(){var r,n,a,o,i,s;return mt(this,(function(c){switch(c.label){case 0:r=null,n=t.semverApi,o=(a=void 0===n||n)?bt:t.apiMode,i="request ".concat(e),u=i,we()&&console.time(u),c.label=1;case 1:return c.trys.push([1,6,,7]),o!==bt?[3,3]:[4,kt(e)];case 2:return s=c.sent(),r=s.reply,[3,5];case 3:return[4,Dt(e)];case 4:r=c.sent(),c.label=5;case 5:return function(e){we()&&console.timeEnd(e)}(i),a?[2,Bt.handleSemverRet(r,t)]:[2,r];case 6:return[2,{data:null,code:"404",msg:c.sent().message}];case 7:return[2]}var u}))}))}function Kt(e){var t=ft({},e);return t.additional_scripts=Ut(t.additional_scripts,[]),t.additional_body_scripts=Ut(t.additional_body_scripts,[]),t}function Wt(e){var t=ft({},e);return t.src_map=Ut(t.src_map,{htmlIndexSrc:"",webDirPath:"",headAssetList:[],bodyAssetList:[],chunkJsSrcList:[],chunkCssSrcList:[],staticJsSrcList:[],staticCssSrcList:[],relativeJsSrcList:[],relativeCssSrcList:[],privCssSrcList:[]}),t}function Yt(e,t,r,n){return void 0===n&&(n=!1),vt(this,void 0,void 0,(function(){var a;return mt(this,(function(o){switch(o.label){case 0:return(a=r)?[3,3]:n?(a="latest",[3,3]):[3,1];case 1:return[4,Ft(t,e)];case 2:a=o.sent(),o.label=3;case 3:return[2,"".concat(e,"/").concat(t,"@").concat(a,"/hel_dist/hel-meta.json?_t=").concat(Date.now())]}}))}))}function qt(e,t){var r=t.versionId,n=t.projectId,a=t.apiMode,o=t.isFullVersion,i=void 0!==o&&o,s=t.versionIdList,c=void 0===s?[]:s,u=t.projectIdList,l=void 0===u?[]:u,p=t.loadOptions,f=void 0===p?{}:p,d=Mt(t.platform),v=e,m=v,h=r,b=n,g=!1;Array.isArray(e)&&(v=e[0],m=e.join(","),h=c.join(","),b=l.join(","),g=!0);var y=function(e,t){return wt(d,e,[f[e],t])},_=function(e,t){return function(e,t,r,n){var a=Pt(e,t,n);return a?a(r):(It[t]||function(){return null})(r)}(d,e,t,f[e])},A=y("userLsKey",Ae.DEFAULT_USER_LS_KEY),S=_("getUserName",{platform:d,appName:v,userLsKey:A}),E=_("shouldUseGray",{appName:v}),L=y("apiSuffix"),I=y("apiPathOfApp",Ae.DEFAULT_API_URL),N=Vt(d,f),P="";"boolean"==typeof E&&(P=E?"1":"0");var w=a===bt?"":gt,O="";O=g?i?ht.BATCH_GET_APP_AND_FULL_VER:ht.BATCH_GET_APP_AND_VER:i?ht.GET_APP_AND_FULL_VER:ht.GET_APP_AND_VER;var V="".concat(O).concat(w),C="";return C="".concat(N).concat(I,"/").concat(V,"?name=").concat(m),C=Bt.appendSearchKV(C,"userName",S),C=Bt.appendSearchKV(C,"version",h),C=Bt.appendSearchKV(C,"projId",b),C=Bt.appendSearchKV(C,"gray",P),{url:C=Bt.appendSuffix(C,L),userName:S}}function Xt(e,t){return vt(this,void 0,void 0,(function(){var r,n,a;return mt(this,(function(o){switch(o.label){case 0:return r=t.versionId,n=t.platform,a=t.loadOptions,[4,Yt(Vt(n,a),e,r||"",null==a?void 0:a.skip404Sniff)];case 1:return[2,o.sent()]}}))}))}function Jt(e,t){var r;return vt(this,void 0,void 0,(function(){var n,a,o,i;return mt(this,(function(s){switch(s.label){case 0:return n=t.loadOptions,a="",o="",null===(r=null==n?void 0:n.semverApi)||void 0===r||r?[4,Xt(e,t)]:[3,2];case 1:return o=s.sent(),[3,3];case 2:i=qt(e,t),o=i.url,a=i.userName,s.label=3;case 3:return[2,{url:o,userName:a}]}}))}))}function zt(e,t){return vt(this,void 0,void 0,(function(){var r,n,a,o,i,s,c,u,l,p,f,d,v,m,h,b;return mt(this,(function(g){switch(g.label){case 0:return r=t.apiMode,n=t.appName,a=t.isFullVersion,o=void 0!==a&&a,i=t.semverApi,s=void 0===i||i,c=Mt(t.platform),u=wt(c,"apiPrefix"),l=wt(c,"apiSuffix"),p=wt(c,"apiPathOfApp"),f=wt(c,"apiPathOfAppVersion"),d="",s?[4,Yt(u,n,e)]:[3,2];case 1:return d=g.sent(),[3,3];case 2:v=r===bt?"":gt,m=o?ht.GET_APP_FULL_VER:ht.GET_APP_VER,h="".concat(m).concat(v),b=f||p||Ae.DEFAULT_API_URL,d="".concat(u).concat(b,"/").concat(h,"?ver=").concat(e),d=Bt.appendSearchKV(d,"name",n),d=Bt.appendSuffix(d,l),g.label=3;case 3:return[2,d]}}))}))}function $t(e,t){return vt(this,void 0,void 0,(function(){var r,n,a,o,i,s,c,u,l,p,f,d=this;return mt(this,(function(v){switch(v.label){case 0:return r=t.versionId,n=t.platform,a=t.apiMode,o=t.loadOptions,i=Pt(n,"getSubAppAndItsVersionFn",null==o?void 0:o.getSubAppAndItsVersionFn),[4,Jt(e,t)];case 1:return s=v.sent(),c=s.url,u=s.userName,l=function(e,t){return vt(d,void 0,void 0,(function(){var r,n;return mt(this,(function(i){switch(i.label){case 0:return[4,Ht(r=e||c,{apiMode:t||a,semverApi:null==o?void 0:o.semverApi})];case 1:if(n=i.sent(),0!==parseInt(n.code,10)||!n)throw new Error((null==n?void 0:n.msg)||"getSubAppAndItsVersion err");return[2,{app:Kt(n.data.app),version:Wt(n.data.version),metaUrl:r}]}}))}))},i?(p={platform:n,appName:e,userName:u,versionId:r,url:c,innerRequest:l},[4,Promise.resolve(i(p))]):[3,3];case 2:return[2,{app:Kt((f=v.sent()).app),version:Wt(f.version)}];case 3:return[4,l()];case 4:return[2,v.sent()]}}))}))}function Qt(e,t){return vt(this,void 0,void 0,(function(){var r,n,a,o,i,s,c,u;return mt(this,(function(l){switch(l.label){case 0:return r=t.apiMode,n=t.isFullVersion,a=void 0!==n&&n,o=t.semverApi,[4,zt(e,t)];case 1:return[4,Ht(l.sent(),{apiMode:r,isFullVersion:a,semverApi:o,onlyVersion:!0})];case 2:if(i=l.sent(),s=i.data,c=i.code,u=i.msg,0!==parseInt(c,10)||!s)throw new Error(u||"ver not found");return[2,Wt(s)]}}))}))}function Zt(e,t){return vt(this,void 0,void 0,(function(){var r,n,a,o,i,s,c,u,l=this;return mt(this,(function(p){switch(p.label){case 0:return e.length?(r=t.apiMode,n=t.batchGetFn,a=t.semverApi,o=Mt(t.platform),[4,qt(e,t)]):[2,[]];case 1:return i=p.sent().url,s=function(){return vt(l,void 0,void 0,(function(){var e,t,n,o;return mt(this,(function(s){switch(s.label){case 0:return[4,Ht(i,{apiMode:r,semverApi:a})];case 1:if(e=s.sent(),t=e.data,n=e.code,o=e.msg,0!==parseInt(n,10)||!t)throw new Error(o||"batch get failed");return[2,t.map((function(e){return{app:Kt(e.app),version:Wt(e.version)}}))]}}))}))},c=[],n?(u={url:i,platform:o,innerRequest:s},[4,Promise.resolve(n(u))]):[3,3];case 2:return c=p.sent(),[3,5];case 3:return[4,s()];case 4:c=p.sent(),p.label=5;case 5:return[2,c]}}))}))}var er=Ee.noop,tr=Object.assign;function rr(e){var t;try{return!!(null===(t=Ce())||void 0===t?void 0:t.document).querySelector(e)}catch(Xn){return!1}}function nr(e){var t=e.attrs,r=e.appendToBody,n=void 0===r||r,a=e.onloadCb,o=e.ex,i=t.src;if(!i)return!1;var s=Ce().document;if(rr('script[src="'.concat(i,'"]')))return!1;if(o&&rr('script[data-helex="'.concat(o,'"]')))return!1;var c=s.createElement("script");return c.src=i,a&&(c.onload=a),n?s.body.appendChild(c):s.head.appendChild(c),!0}function ar(e){var t=e.appendToBody,r=void 0!==t&&t,n=e.attrs,a=e.ex,o=n.href,i=n.rel,s=n.as,c=Ce().document;if(o&&(!a||!rr('link[data-helex="'.concat(a,'"]')))){var u=c.createElement("link");u.rel=i||"stylesheet",u.href=o,s&&(u.as=s),r?c.body.appendChild(u):c.head.appendChild(u)}}var or=function(e,t){return t.startsWith(e)?"build":!(r=t).startsWith("//")&&(r.startsWith("/")||r.startsWith("./")||r.startsWith("../"))?"relative":"static";var r};function ir(e,t){var r=t.appendToBody,n=t.appendCss,a=t.webDirPath,o=t.cssAppendTypes,i=t.excludeCssList;e.forEach((function(e){var t=e.tag,s=e.attrs,c=e.ex,u=function(e){var t=e.tag,r=e.append;return!!["link","script"].includes(t)||!0===r}(e);if(u){if(function(e,t){return er(t),["link","staticLink","relativeLink"].includes(e)}(t,s)){var l={appendToBody:r,attrs:s,ex:c},p=s.href;if(p.endsWith(".ico"))return;return p.endsWith(".css")?void(n&&o.includes(or(a,p))&&!i.includes(p)&&ar(l)):void ar(l)}(function(e,t){return er(t),["script","staticScript","relativeScript"].includes(e)})(t,s)&&nr({appendToBody:r,attrs:s,ex:c})}}))}var sr={SHADOW:!0,SET_STYLE_AS_STRING:!0,ENABLE_DISK_CACHE:!1,ENABLE_SYNC_META:!0,STORAGE_TYPE:"localStorage",ENABLE_APPEND_CSS:!0,API_MODE:"get",EXTRA_DATA_PREFIX:"HelExtraData"};function cr(e,t){var r,n="[[ isEmitVerMatchInputVer ]]",a=t.platform,o=t.emitVer,i=t.inputVer,s=t.projectId,c=wt(a,"strictMatchVer",[t.strictMatchVer]),u=xe(e,a);if(!1===c)return Oe("".concat(n," set strictMatchVer false for app (").concat(e,"), trust emitVer (").concat(o,") is the target version")),!0;if(!o)return Oe("".concat(n," emitVer should not be null")),!0;if(!i&&u){var l=u.online_version,p=u.build_version;if(s){var f=((null===(r=u.proj_ver)||void 0===r?void 0:r.map)||{})[s];if(f)return o===f.b||o===p||o===f.o}return o===l||o===p}return o===i}var ur=Ae.DEFAULT_ONLINE_VER,lr={js:{endMark:".js",reg:'(?<=(src="))[^"]*?(?=")',tag:"script"},css:{endMark:".css",reg:'(?<=(href="))[^"]*?(?=")',tag:"link"}},pr="http://localhost",fr="http://127.0.0.1",dr={isSrcMatchHost:function(e,t){return t.startsWith(pr)||t.startsWith(fr)?e.startsWith(pr)||e.startsWith(fr):e.startsWith(t)},extractAssetList:function(e,t){var r=t.host,n=t.type,a=lr[n],o=a.endMark,i=a.tag,s=a.reg,c=new RegExp(s,"ig"),u=e.match(c)||[],l=[],p=[];return u.forEach((function(e){if(p.push(e),dr.isSrcMatchHost(e,r)&&e.endsWith(o))return"script"===i?l.push({tag:i,attrs:{src:e}}):void l.push({tag:i,attrs:{href:e,rel:"stylesheet"}})})),{itemList:l,stringList:p}},extractCssList:function(e,t){return dr.extractAssetList(e,{host:t,type:"css"})},extractScriptList:function(e,t){return dr.extractAssetList(e,{host:t,type:"js"})}};function vr(e){if(e){var t=e.enable,r=void 0===t||t;return!(!e.host||!r)}return!1}function mr(e,t){return vt(this,void 0,Promise,(function(){var r,n,a,o,i,s,c,u,l,p,f,d,v;return mt(this,(function(m){switch(m.label){case 0:if(r=t.host,n=t.appGroupName,a=t.skipFetchHelMeta,o=void 0!==a&&a,i=Date.now(),o)return[3,4];s=r.endsWith("hel-meta.json")?r:"".concat(r,"/hel-meta.json?_t=").concat(i),m.label=1;case 1:return m.trys.push([1,3,,4]),[4,kt(s)];case 2:return(c=m.sent().reply)?(c.app.__fromCust=!0,[2,c]):(Oe("[[ getCustomMeta ]] 404 is a expected behavior for custom mode, user can ignore it"),[3,4]);case 3:return m.sent(),Ee.noop("json parse fail or other error"),[3,4];case 4:u="",m.label=5;case 5:return m.trys.push([5,7,,8]),[4,kt("".concat(r,"/index.html?_t=").concat(i),!1)];case 6:return l=m.sent(),u=l.reply,[3,8];case 7:throw p=m.sent(),new Error("".concat(p.message," from ").concat(r));case 8:return f=dr.extractCssList(u,r),d=dr.extractScriptList(u,r),v=f.itemList.concat(d.itemList),[2,{app:{__fromCust:!0,name:e,app_group_name:n||e,online_version:ur,build_version:ur},version:{sub_app_name:e,sub_app_version:ur,src_map:{webDirPath:r,headAssetList:[],bodyAssetList:v,chunkCssSrcList:f.stringList,chunkJsSrcList:d.stringList}}}]}}))}))}var hr=Ee,br=Ae.KEY_ASSET_CTX,gr={recordAssetCtx:function(e,t,r){var n=e.name,a=e.app_group_name,o=t.src_map,i=t.sub_app_version,s=o.chunkCssSrcList,c=void 0===s?[]:s,u=o.chunkJsSrcList,l=void 0===u?[]:u,p=Ot(r,"beforeAppendAssetNode"),f=c.concat(l),d=r.appendCss,v=r.platform;f.forEach((function(e){var t=He(br,e)||{};t.marked||(Object.assign(t,{marked:!0,platform:v,groupName:a,name:n,ver:i,beforeAppend:p,append:d}),Ke(br,e,t))}))},tryTriggerOnFetchMetaSuccess:function(e,t,r){var n=r.loadOptions,a=r.fromFallback,o=Ot(n,"onFetchMetaSuccess");null==o||o({app:e,version:t,fromFallback:a})}};function yr(e){var t=Pt(e.platform,"onFetchMetaFailed",e.onFetchMetaFailed);return Ot(e,"onFetchMetaFailed")||t}function _r(e,t){var r=Mt(e),n=function(e,t){var r=tt(e).apiMode;return t||r}(r,t);return{platform:r,apiMode:n}}function Ar(e){return"".concat(yt.LS_CACHE_APP_PREFIX,".").concat(e)}function Sr(e,t){return vt(this,void 0,Promise,(function(){var r,n;return mt(this,(function(a){switch(a.label){case 0:return"indexedDB"!==t.storageType?[3,2]:(r=Et())?[4,r.getItem(Ar(e))]:[3,2];case 1:return[2,a.sent()];case 2:return n=Lt().getItem(Ar(e)),[2,hr.safeParse(n||"",null)]}}))}))}function Er(e){return vt(this,void 0,void 0,(function(){var t;return mt(this,(function(r){switch(r.label){case 0:return(t=Et())?[4,t.removeItem(Ar(e))]:[3,2];case 1:r.sent(),r.label=2;case 2:return Lt().removeItem(Ar(e)),[2]}}))}))}function Lr(e,t,r){return vt(this,void 0,void 0,(function(){var n,a,o,i,s,c,u,l,p,f,d,v,m,h,b,g,y,_,A,S,E,L,I,N,P,w,O=this;return mt(this,(function(V){switch(V.label){case 0:return n=t.enableDiskCache,a=void 0===n?sr.ENABLE_DISK_CACHE:n,o=t.enableSyncMeta,i=void 0===o?sr.ENABLE_SYNC_META:o,s=t.versionId,c=void 0===s?"":s,u=t.projectId,l=void 0===u?"":u,p=t.custom,f=t.strictMatchVer,d=t.semverApi,v=(r||{}).callRemote,m=void 0===v||v,h=_r(t.platform,t.apiMode),b=h.platform,g=h.apiMode,vr(p)?[4,mr(e,p)]:[3,2];case 1:return y=V.sent(),_=y.app,A=y.version,Pr(_,{appVersion:A,platform:b,toDisk:!1,loadOptions:t}),[2,{appInfo:_,appVersion:A}];case 2:return S=xe(e,b),E=ke(e,{platform:b,versionId:c}),!d&&S&&E&&cr(e,{platform:b,projectId:l,emitVer:E.sub_app_version,inputVer:c,strictMatchVer:f})?[2,{appInfo:S,appVersion:E}]:(L={platform:b,apiMode:g,versionId:c,projectId:l,loadOptions:t},I=null,N=function(t){return vt(O,void 0,void 0,(function(){return mt(this,(function(r){switch(r.label){case 0:return t?[4,wr(e,L)]:[3,2];case 1:return[2,r.sent()];case 2:return[2,null]}}))}))},a?[4,Sr(e,t)]:[3,9]);case 3:return(I=V.sent())?[3,5]:[4,N(m)];case 4:return I=V.sent(),[3,8];case 5:return P=I.appInfo,w=I.appVersion,c&&w.sub_app_version!==c?[4,N(m)]:[3,7];case 6:return I=V.sent(),[3,8];case 7:Pr(P,{appVersion:w,platform:b,toDisk:!1,loadOptions:t}),N(i).catch((function(e){return hr.noop(e)})),V.label=8;case 8:return[3,11];case 9:return[4,N(m)];case 10:I=V.sent(),V.label=11;case 11:return I&&nt(e,b),[2,I]}}))}))}function Ir(e,t){return vt(this,void 0,Promise,(function(){var r,n,a,o;return mt(this,(function(i){switch(i.label){case 0:r=t.isFirstCall,n=void 0===r||r,i.label=1;case 1:return i.trys.push([1,3,,5]),[4,Lr(e,t)];case 2:return[2,o=i.sent()];case 3:if(a=i.sent(),n)throw a;return yr(t)?[2,null]:[4,Sr(e,t)];case 4:if(!(o=i.sent()))throw a;return hr.nbalert("\n      ".concat(a.message,", hel-micro will use cached data to keep your app works well,\n      please check your network if this behavior is not as you expected!\n    ")),[2,o];case 5:return[2]}}))}))}function Nr(e,t){return vt(this,void 0,void 0,(function(){var r,n,a,o,i,s,c;return mt(this,(function(u){switch(u.label){case 0:return r=_r(t.platform,t.apiMode),n=r.platform,a=r.apiMode,o=ft(ft({},t),{platform:n,apiMode:a}),[4,$t(e,o)];case 1:if(i=u.sent(),s=i.app,!(c=i.version))throw new Error("no version found or builded");return[2,{appInfo:s,appVersion:c}]}}))}))}function Pr(e,t){var r=t.appVersion,n=t.platform,a=t.toDisk,o=void 0===a||a,i=t.loadOptions;if(e&&r){var s=e,c=s.name;if(o){var u=function(){try{Lt().setItem(Ar(c),JSON.stringify({appInfo:e,appVersion:r}))}catch(Xn){Oe("save localStorage failed")}};if("indexedDB"===i.storageType){var l=Et();l?l.setItem(Ar(c),{appInfo:e,appVersion:r}).catch((function(e){Oe("save indexeddb failed, use localStorage instead, err: ".concat(e.message)),u()})):u()}else u()}if(i.semverApi){var p=xe(c,n);!0!==(null==p?void 0:p.__setByLatest)&&(s=i.versionId?s:ft(ft({},s),{__setByLatest:!0}),je(s,n))}else je(e,n);Ge(c,r,{platform:n});var f=Gt(i);Qe(c,f,{platform:n,versionId:r.sub_app_version})}}function wr(e,t){return vt(this,void 0,void 0,(function(){var r,n,a,o,i;return mt(this,(function(s){switch(s.label){case 0:return r=t.platform,n=t.loadOptions,[4,Nr(e,t)];case 1:return a=s.sent(),o=a.appInfo,i=a.appVersion,Pr(o,{appVersion:i,platform:r,loadOptions:n}),[2,a]}}))}))}function Or(e,t){return void 0===t&&(t={}),vt(this,void 0,Promise,(function(){var r,n,a,o,i,s,c,u,l,p,f,d,v,m,h,b;return mt(this,(function(g){switch(g.label){case 0:r=t.isFirstCall,n=void 0===r||r,a=t.controlLoadAssets,o=void 0!==a&&a,i=t.platform,s=t.versionId,c=void 0===s?"":s,g.label=1;case 1:return g.trys.push([1,5,,8]),[4,Ir(e,t)];case 2:return u=g.sent(),p=(l=u||{}).appInfo,f=l.appVersion,d=!1,!(!p||!f)||n?[3,4]:(v=yr(t))?[4,Promise.resolve(v({platform:i,appName:e,versionId:c}))]:[3,4];case 3:(m=g.sent())&&(p=m.app,f=m.version,d=!0,Pr(p,{appVersion:f,platform:Mt(i),toDisk:!1,loadOptions:t})),g.label=4;case 4:if(!p)throw new Error("app[".concat(e,"] not exist"));if(!f)throw new Error("app[".concat(e,"]'s version[").concat(c,"] not exist"));return gr.tryTriggerOnFetchMetaSuccess(p,f,{loadOptions:t,fromFallback:d}),gr.recordAssetCtx(p,f,t),h=function(){!function(e,t,r){e.name;var n=e.additional_scripts,a=void 0===n?[]:n,o=e.additional_body_scripts,i=void 0===o?[]:o,s=t.src_map,c=s.headAssetList,u=void 0===c?[]:c,l=s.bodyAssetList,p=void 0===l?[]:l,f=s.webDirPath,d=s.chunkCssSrcList,v=void 0===d?[]:d,m=r.useAdditionalScript,h=void 0!==m&&m,b=r.appendCss,g=void 0===b||b,y=r.cssAppendTypes,_=void 0===y?["build","static","relative"]:y,A=r.getExcludeCssList,S=Gt(r),E=Ee.merge2List(S,v),L=(null==A?void 0:A(E,{version:t}))||[],I=function(e,t){if(e)for(var r=0,n=e;r<n.length;r++){var a=n[r];a.endsWith(".css")?g&&!L.includes(a)&&ar({appendToBody:t,attrs:{href:a,rel:"stylesheet"}}):nr({appendToBody:t,attrs:{src:a}})}};h&&(I(a,!1),I(i,!0)),I(S,!1);var N={excludeCssList:L,webDirPath:f,appendCss:g,cssAppendTypes:_};ir(u,tr(N,{appendToBody:!1})),ir(p,tr(N,{appendToBody:!0}))}(p,f,t)},o?[2,h]:(h(),[2,null]);case 5:return b=g.sent(),n?(console.error("loadApp err and try one more time: ",b),[4,Or(e,ft(ft({},t),{isFirstCall:!1}))]):[3,7];case 6:return[2,g.sent()];case 7:throw new Error("loadApp [".concat(e,"] err (").concat(b.message,"), recommend config onFetchMetaFailed hook"));case 8:return[2]}}))}))}var Vr=Object.freeze({__proto__:null,getSubAppVersion:function(e,t){return vt(this,void 0,Promise,(function(){return mt(this,(function(r){switch(r.label){case 0:return[4,Qt(e,t)];case 1:return[2,r.sent()]}}))}))},getSubAppMeta:function(e,t){return vt(this,void 0,Promise,(function(){return mt(this,(function(r){switch(r.label){case 0:return[4,$t(e,t||{})];case 1:return[2,r.sent()]}}))}))},getMetaDataUrl:function(e,t){var r=t||{},n=r.versionId,a=r.platform,o=r.apiMode,i=void 0===o?bt:o,s=r.protocol,c=void 0===s?"http":s,u=r.projectId,l=r.semverApi,p=qt(e,{platform:a,versionId:n,apiMode:i,projectId:u,semverApi:void 0===l||l}).url;return"http"===c&&(p=p.replace("https:","http:")),p},clearDiskCachedApp:function(e){return vt(this,void 0,void 0,(function(){var t;return mt(this,(function(r){switch(r.label){case 0:return Array.isArray(e)?(t=[],e.forEach((function(e){return t.push(Er(e))})),[4,Promise.all(t)]):[3,2];case 1:return r.sent(),[3,4];case 2:return[4,Er(e)];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))}});function Cr(e,t){var r=t||{},n=Mt(r.platform),a=r.versionId||"";if(!a){var o=ke(e,{platform:n});if(o)a=o.sub_app_version;else{var i=xe(e,n);a=(null==i?void 0:i.online_version)||(null==i?void 0:i.build_version)||""}}return{platform:n,versionId:a}}var Dr=Object.freeze({__proto__:null,getPlatAndVer:Cr,getGroupedStyleList:function(e,t){var r={static:[],build:[]},n=ke(e,t);if(n){var a=n.src_map,o=a.webDirPath;a.chunkCssSrcList.forEach((function(e){e.startsWith(o)?r.build.push(e):r.static.push(e)}))}return r}}),Mr=Ae.KEY_CSS_STR,Tr=_e,Rr=Tr.LOADED,Fr=Tr.LOADING,xr=Tr.NOT_LOAD,jr=it(),kr=ye.STYLE_STR_FETCHED,Gr={isStyleStatusMatch:function(e,t,r){var n=Cr(e,r),a=n.platform,o=n.versionId;return qe(e,{platform:a,versionId:o})===t},getStyleUrlList:function(e,t){var r,n=Cr(e,t),a=ke(e,n),o=$e(e,n),i=[];return a&&(i=(null===(r=a.src_map)||void 0===r?void 0:r.chunkCssSrcList)||[]),Ee.merge2List(o,i)},fetchStyleStr:function(e){return vt(this,void 0,void 0,(function(){var t,r,n,a,o,i,s;return mt(this,(function(c){switch(c.label){case 0:t="",r=0,n=e.length,c.label=1;case 1:if(!(r<n))return[3,7];if(a=e[r],o=He(Mr,a))return[3,5];c.label=2;case 2:return c.trys.push([2,4,,5]),[4,kt(a,!1)];case 3:return i=c.sent(),o=i.reply,Ke(Mr,a,o),[3,5];case 4:return s=c.sent(),console.error(s),[3,5];case 5:t+=o,c.label=6;case 6:return r++,[3,1];case 7:return[2,t]}}))}))},waitStyleReady:function(e,t){return vt(this,void 0,void 0,(function(){var r;return mt(this,(function(n){switch(n.label){case 0:return r=null,[4,new Promise((function(n){r=function(r){var a=r.appName,o=r.platform,i=r.versionId,s=t.versionId,c=t.platform,u=t.strictMatchVer;a===e&&o===c&&cr(e,{platform:c,emitVer:i,inputVer:s,strictMatchVer:u})&&n(!0)},jr.on(kr,r)}))];case 1:return n.sent(),r&&jr.off(kr,r),[2]}}))}))},fetchAndCacheAppStyleStr:function(e,t){return vt(this,void 0,void 0,(function(){var r,n,a,o,i,s,c,u,l,p;return mt(this,(function(f){switch(f.label){case 0:return r=Cr(e,t),n=t.extraCssList,a=void 0===n?[]:n,o=t.getExcludeCssList,i=Gr.getStyleUrlList(e,t),s=qe(e,r),c="",s!==Fr?[3,2]:[4,Gr.waitStyleReady(e,ft(ft({},r),{strictMatchVer:t.strictMatchVer}))];case 1:return f.sent(),c=Je(e,r)||"",[3,5];case 2:return s!==xr?[3,4]:(Xe(e,Fr,r),[4,Gr.fetchStyleStr(i)]);case 3:return c=f.sent(),ze(e,c,r),Xe(e,Rr,r),jr.emit(kr,ft({appName:e},r)),[3,5];case 4:c=Je(e,r)||"",f.label=5;case 5:return u=Ee.merge2List(i,a),(l=(null==o?void 0:o(u,{version:ke(e,r)}))||[]).length||a.length?(p=u.filter((function(e){return!l.includes(e)})),[4,Gr.fetchStyleStr(p)]):[2,c];case 6:return[2,f.sent()]}}))}))}};var Ur=Object.freeze({__proto__:null,fetchStyleStr:function(e,t){return vt(this,void 0,Promise,(function(){return mt(this,(function(r){switch(r.label){case 0:return[4,Gr.fetchAndCacheAppStyleStr(e,t||{})];case 1:return[2,r.sent()]}}))}))},fetchStyleByUrlList:function(e){return vt(this,void 0,void 0,(function(){return mt(this,(function(t){switch(t.label){case 0:return[4,Gr.fetchStyleStr(e)];case 1:return[2,t.sent()]}}))}))},getStyleStr:function(e,t){var r=Cr(e,t);return Je(e,r)},getStyleUrlList:function(e,t){return Gr.getStyleUrlList(e,t||{})},isStyleFetched:function(e,t){return Gr.isStyleStatusMatch(e,Rr,t||{})}});function Br(e,t,r){var n=r.platform;if(!xe(t,n)){var a=xe(e,n),o=ke(e,r);if(a&&o){je(ft(ft({},a),{name:t,__addedByTrust:!0}),n),Ge(t,ft(ft({},o),{sub_app_name:t,__addedByTrust:!0}),{platform:n});var i=$e(e,r);Qe(t,i,r)}}}function Hr(e,t){var r=t.platform,n=void 0===r?Ne():r,a=t.versionId,o=void 0===a?"":a,i=t.isLib,s=wt(n,"strictMatchVer",[t.strictMatchVer]),c=ft(ft({},t),{strictMatchVer:s}),u=e,l=t.custom;vr(l)&&(u=l.appGroupName||e);var p=xe(u,n);if(t.semverApi&&!o&&p&&!0!==p.__setByLatest)return null;if(i){var f=Re(u,c),d={appName:u,appGroupName:(null==p?void 0:p.app_group_name)||"",platform:n,appProperties:f,isLib:!0,versionId:o,Comp:null,lifecycle:void 0};return f?d:null}return Me(u,c)||null}function Kr(e,t,r){var n="[[ judgeAppReady ]]";Oe("".concat(n," receive emitApp(appInfo):"),e);var a=t.versionId,o=void 0===a?"":a,i=t.projectId,s=t.appName,c=t.platform,u=t.next,l=t.error,p=t.isLib,f=t.strictMatchVer,d=e.appName,v=e.appGroupName,m=e.platform,h=void 0===m?Ne():m,b=e.versionId,g="".concat(c,"/").concat(s,"/").concat(o),y=xe(s,c),_=c||Ne(),A=r.custom,S=function(e){try{var t=p?function(e,t,r){var n=r.platform,a=r.emitPlatform,o=r.versionId;if(!Re(e,r)){Br(e,t,r);var i=Re(t,{platform:n,versionId:o});if(!i&&a&&(i=Re(t,{platform:a,versionId:o,strictMatchVer:!1})),!i)throw new Error("seems ".concat(t," emit null lib"));return ct(e,i,{platform:n}),!1}return!0}(s,v,e):function(e,t,r){var n=r.platform,a=r.emitPlatform,o=r.versionId;if(!Me(e,r)){Br(e,t,r);var i=Me(t,{platform:n,versionId:o});if(!i&&a&&(i=Me(t,{platform:a,versionId:o,strictMatchVer:!1})),!i)throw new Error("seems ".concat(t," emit null app"));return pt(ft(ft({},i),{appName:e,versionId:o})),!1}return!0}(s,v,e);return t}catch(Xn){return l(Xn),!1}};if(A){var E=A.enable,L=void 0===E||E,I=A.host,N=A.appGroupName,P=A.trust;if(L&&I)return void 0!==P&&P?void(S({versionId:o,platform:_})&&u()):void(v&&(v===s||v===N)&&u())}if(!1===f&&v&&(null==y?void 0:y.app_group_name)===v&&_===h)return Oe("".concat(n," treat emitApp as wanted when strictMatchVer is false (appInfo):"),e),u();var w=function(){return Oe("".concat(n," still wait ").concat(g," emitted (appInfo,toMatch):"),e,O)},O={platform:c,emitVer:b,inputVer:o,projectId:i,strictMatchVer:f};if(s!==d||!cr(s,O))return w();var V=wt(_,"trustAppNames",[null,[]],{emptyArrIsNull:!1});if(_!==h&&V.includes(s)&&!S({versionId:o,platform:_,emitPlatform:h}))return Oe("".concat(n," transfer ").concat(h," app [").concat(s,"] to ").concat(_," plat due to being in trustAppNames")),w();u()}var Wr=Object.freeze({__proto__:null,getLibOrApp:Hr,judgeAppReady:Kr});function Yr(e){var t=e.platform,r=dt(e,["platform"]);at(r,t)}function qr(){return Le()}function Xr(e){if(e&&!e.default)try{e.default=e}catch(Xn){}return e}function Jr(e){var t=Ce();Object.keys(e).forEach((function(r){var n=e[r];n&&(t[r]=n)}))}function zr(e){var t=Xr(e.React),r=Xr(e.ReactDOM),n=e.ReactIs||null,a=e.ReactReconciler||null;Jr({LEAH_React:t,LEAH_ReactDOM:r,LEAH_ReactIs:n,LEAH_ReactReconciler:a,React:t,ReactDOM:r,ReactIs:n,ReactReconciler:a})}function $r(e){var t=Xr(e.Vue);Jr({LEAH_Vue:t,Vue:t})}function Qr(e){return"".concat(sr.EXTRA_DATA_PREFIX,".").concat(e)}function Zr(e,t){var r,n,a=null!=t&&t,o=null!==(n=null===(r=Ce().localStorage)||void 0===r?void 0:r.getItem(Qr(e)))&&void 0!==n?n:null;return o?a?JSON.parse(o):o:null}function en(e,t,r){var n,a=null!=r&&r?JSON.stringify(t):t;null===(n=Ce().localStorage)||void 0===n||n.setItem(Qr(e),a)}function tn(e){var t;return"string"==typeof e?null===(t=Ce())||void 0===t?void 0:t.document.getElementById(e):e}function rn(e,t){return{name:e,platform:(null==t?void 0:t.platform)||rt(e),versionId:(null==t?void 0:t.versionId)||"",getShadowAppRoot:tn,getShadowBodyRoot:tn}}var nn=Ee.getObjsVal,an=sr.ENABLE_DISK_CACHE,on=sr.ENABLE_SYNC_META,sn=sr.STORAGE_TYPE;function cn(e,t){var r="string"==typeof t?{versionId:t}:ft({},t||{});return r.platform=Mt(r.platform),r.isLib=e,r}function un(e,t,r){return vt(this,void 0,void 0,(function(){var n,a,o,i,s,c,u,l,p;return mt(this,(function(f){switch(f.label){case 0:return n=it(),a=t.platform,o=t.isLib,i=void 0!==o&&o,s=t.versionId,c=t.projectId,u=t.strictMatchVer,l=i?ye.SUB_LIB_LOADED:ye.SUB_APP_LOADED,p=null,[4,new Promise((function(o,f){p=function(r){Kr(r,{appName:e,platform:a,versionId:s,projectId:c,isLib:i,next:o,error:f,strictMatchVer:u},t)},n.on(l,p),r&&r()}))];case 1:return f.sent(),p&&n.off(l,p),[2,Hr(e,t)]}}))}))}function ln(e,t){return vt(this,void 0,void 0,(function(){var r,n,a,o,i,s,c,u,l,p,f;return mt(this,(function(d){switch(d.label){case 0:r=null,n=t.versionId,a=t.platform,o=t.isLib,i=t.strictMatchVer,s=t.semverApi,c=ft({},t),u=o?"preFetchLib":"preFetchApp",d.label=1;case 1:return d.trys.push([1,7,,8]),c.strictMatchVer=wt(a,"strictMatchVer",[i]),c.storageType=t.storageType||"indexedDB",c.semverApi=wt(a,"semverApi",[s]),(r=Hr(e,c))&&(!n||n&&r.versionId===n)?(Oe("[[ ".concat(u," ]] return cached app:"),e,c),[2,{emitApp:r,msg:""}]):(l=null,(p=We(e,c))!==_e.LOADED?[3,3]:[4,un(e,c)]);case 2:return r=d.sent(),Oe("[[ ".concat(u," ]] return emit app:"),e,c,r),[2,{emitApp:r,msg:""}];case 3:return p===_e.LOADING?[3,5]:(Ye(e,_e.LOADING,c),[4,Or(e,ft(ft({},c),{controlLoadAssets:!0}))]);case 4:l=d.sent(),d.label=5;case 5:return[4,un(e,t,l)];case 6:return r=d.sent(),Oe("[[ ".concat(u," ]] return fetch&emit app:"),e,c,r),[2,{emitApp:r,msg:""}];case 7:return f=d.sent(),console.error(f),[2,{emitApp:r,msg:f.message}];case 8:return[2]}}))}))}function pn(e,t){return vt(this,void 0,Promise,(function(){var r,n,a,o,i,s,c;return mt(this,(function(u){switch(u.label){case 0:return r=cn(!0,t),[4,ln(e,r)];case 1:if(n=u.sent(),a=n.emitApp,o=n.msg,!(i=null==a?void 0:a.appProperties)&&r.onLibNull&&(s=r.onLibNull(e,{versionId:r.versionId}))&&(i=s),!i)throw c=o?" details : ".concat(o):"",new Error("preFetchLib ".concat(e," fail from ").concat(r.platform,", it may be an invalid module!").concat(c));return[2,i]}}))}))}function fn(e,t){return vt(this,void 0,void 0,(function(){var r,n;return mt(this,(function(a){switch(a.label){case 0:return r=cn(!1,t),[4,ln(e,r)];case 1:return[2,(null==(n=a.sent())?void 0:n.emitApp)||null]}}))}))}function dn(e,t){return vt(this,void 0,Promise,(function(){var r,n,a,o,i,s,c,u,l,p,f,d,v,m;return mt(this,(function(h){switch(h.label){case 0:if(r=[],n=[],a=(null==t?void 0:t.preFetchConfigs)||{},o=ft({},(null==t?void 0:t.common)||{}),i=Mt(o.platform),e.length>8)throw new Error("only support 8 appName at most!");s=[],c=[],u={},l=0,p=e,h.label=1;case 1:return l<p.length?(f=p[l],d=a[f],v={platform:i},d&&"string"!=typeof d?d&&(v=ft(ft({},d),v)):v.versionId=d||"",u[f]=v,v.enableDiskCache=nn([v,o],"enableDiskCache",an),v.enableSyncMeta=nn([v,o],"enableSyncMeta",on),v.storageType=nn([v,o],"storageType",sn),[4,Lr(f,v,{callRemote:!1})]):[3,4];case 2:h.sent()||(r.push(v.versionId||""),n.push(v.projectId||""),c.push(f)),h.label=3;case 3:return l++,[3,1];case 4:return o.versionIdList=r,o.projectIdList=n,o.semverApi?[4,Promise.all(c.map((function(e){return $t(e,u[e])})))]:[3,6];case 5:return s=h.sent(),[3,8];case 6:return[4,Zt(c,o)];case 7:s=h.sent(),h.label=8;case 8:return s.forEach((function(e){var t=e.app,r=e.version,n=u[t.name]||{};Pr(t,{appVersion:r,platform:i,toDisk:n.enableDiskCache,loadOptions:n})})),m=e.map((function(e){return pn(e,u[e])})),[4,Promise.all(m)];case 9:return[2,h.sent()]}}))}))}var vn=Object.freeze({__proto__:null,core:n,VER:lt,emitApp:pt,appMetaSrv:Vr,appParamSrv:Dr,appStyleSrv:Ur,logicSrv:Wr,init:Yr,isSubApp:qr,bindExternals:Jr,bindReactRuntime:zr,bindVueRuntime:$r,getExtraData:Zr,setExtraData:en,getFakeHelContext:rn,batchPreFetchLib:dn,preFetchApp:fn,preFetchLib:pn}),mn=Ee.purify,hn=st(),bn=["eventBus","getExtraData","setExtraData","bindExternals","bindVueRuntime","bindReactRuntime","isSubApp"],gn={ignoreFns:["tryGetAppName","log","commonUtil","getCommonData","setCommonData","setGlobalThis"],arg1PlatFns:["getPlatformConfig","getSharedCache"],arg2PlatFns:["initPlatformConfig","getAppMeta","setAppMeta","tryGetVersion","setAppPlatform"]},yn=["preFetchLib","preFetchApp"],_n=["getSubAppMeta","getMetaDataUrl"],An=["emitApp","init"];function Sn(e,t,r){var n=r.preFetchOptions,a=r.isCore,o={};return Object.keys(t).forEach((function(i){var s=t[i];if(bn.includes(i))o[i]=s;else{var c=typeof s;if("function"!==c)if(s&&"object"===c){var u=ft(ft({},r),{isCore:"core"===i});o[i]=Sn(e,s,u)}else o[i]=s;else{var l={fnName:i,fn:s,isCore:a,preFetchOptions:n};o[i]=function(e,t){var r=this,n=t.fnName,a=t.fn,o=t.isCore,i=t.preFetchOptions;return function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];var c=function(t){return ft({platform:e},mn(t||{}))},u=t[0],l=t[1],p=t[2];if(o){if("getPlatform"===n)return e;gn.arg1PlatFns.includes(n)?t[0]=u||e:gn.arg2PlatFns.includes(n)?t[1]=l||e:gn.ignoreFns.includes(n)||(n.startsWith("set")?t[2]=c(p):t[1]=c(l))}else if("batchPreFetchLib"===n){var f=l||{},d=c(f.common);t[1]=ft(ft({},f),{common:d})}else if(yn.includes(n)){var v=mn("string"==typeof l?{versionId:l}:l||{});i&&(v=mn(ft(ft({},i),v))),t[1]=ft({platform:e},v)}else if(_n.includes(n)){var m=(i||{}).semverApi,h=void 0===m||m;t[1]=c(ft({semverApi:h},mn(l||{})))}else An.includes(n)?t[0]=c(u):t[1]=c(l);return a.apply(r,t)}}(e,l)}}})),o}function En(e,t){var r=Sn(e,vn,{preFetchOptions:t});return r.createInstance=En,r.createOriginInstance=Ln,r.resetGlobalThis=Ie,r.eventBus=hn,r.default=r,r}function Ln(e,t){var r=t||{};r.trustAppNames;var n=dt(r,["trustAppNames"]);return ot(e,t),En(e,n)}var In=lt,Nn=pn,Pn=fn,wn=dn,On=Ur,Vn=Dr,Cn=Vr,Dn=Wr,Mn=pt,Tn=Yr,Rn=qr,Fn=rn,xn=Zr,jn=en,kn=Jr,Gn=$r,Un=zr,Bn=n,Hn=Ie,Kn=En,Wn=Ln,Yn=st();Bn.log("hel-micro ver ".concat(In));var qn={VER:In,preFetchLib:Nn,preFetchApp:Pn,batchPreFetchLib:wn,appStyleSrv:On,appParamSrv:Vn,appMetaSrv:Cn,logicSrv:Dn,emitApp:Mn,eventBus:Yn,init:Tn,isSubApp:Rn,getFakeHelContext:Fn,getExtraData:xn,setExtraData:jn,bindExternals:kn,bindVueRuntime:Gn,bindReactRuntime:Un,resetGlobalThis:Hn,core:n,createInstance:Kn,createOriginInstance:Wn}}}]);